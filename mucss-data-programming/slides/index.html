<!DOCTYPE html>
<html lang="es"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Master in Computational Social Sciences • Javier Álvarez Liébana">
  <title>Data programming and intro to R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/background-mucss.webp" data-background-opacity="0.2" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title">Data programming and intro to R</h1>
  <p class="subtitle">Prepare, clean, transform and enrich data in R</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Master in Computational Social Sciences • Javier Álvarez Liébana 
</div>
</div>
</div>

</section>
<section class="slide level2">

<div class="r-fit-text">
<p><span class="flow">Welcome to R!</span></p>
</div>
<p><span style="color:#444442;"><strong>Put your spreadsheets, SAS and SPSS aside</strong></span></p>
</section>
<section id="hi" class="slide level2">
<h2>Hi!</h2>
<p><span class="hl-green"><strong>Mail</strong></span>: <strong><a href="mailto:javalv09@ucm.es" class="email">javalv09@ucm.es</a></strong>.</p>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="img/me.jpeg"></p>
</div><div class="column" style="width:70%;">
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Javier Álvarez Liébana</strong></span> from Carabanchel (Madrid).</p></li>
<li class="fragment"><p>Degree in Mathematics (UCM). <span class="hl-yellow"><strong>PhD in Statistics</strong></span> (UGR).</p></li>
<li class="fragment"><p>In charge of <span class="hl-yellow"><strong>data visualization and analysis</strong></span> for the Principality of Asturias (2021-2022) during the COVID pandemic</p></li>
<li class="fragment"><p>Member of the <span class="hl-yellow"><strong>Spanish Society of Statistics and OR</strong></span> and the <span class="hl-yellow"><strong>Spanish Royal Mathematical Society</strong></span>.</p></li>
</ul>
</div>
</div>
</div>
<p>Currently, <span class="hl-yellow"><strong>Assistant Professor at the Faculty of Statistics of the UCM</strong></span>. Disseminating via <a href="https://twitter.com/dadosdelaplace"><strong>Twitter</strong></a> e <a href="https://instagram.com/javieralvarezliebana"><strong>Instagram</strong></a></p>
</section>
<section id="goals" class="slide level2">
<h2>Goals</h2>
<div class="columns">
<div class="column" style="width:37%;">
<p><img data-src="https://assets-global.website-files.com/6092cb6b4ac959f39728dd26/6188a97fa499b5fbfe410417_target%20(1).png"></p>
</div><div class="column" style="width:63%;">
<div>
<ul>
<li class="fragment"><p>Take away the <span class="hl-yellow"><strong>fear of programming</strong></span> → learn to program by programming</p></li>
<li class="fragment"><p>Understanding <span class="hl-yellow"><strong>basic R concepts</strong></span> from scratch → learning to <strong>abstract</strong> ideas and algorithms</p></li>
<li class="fragment"><p>Utility of programming → <span class="hl-yellow"><strong>reproducible, transparent and maintainable workflows</strong></span>.</p></li>
<li class="fragment"><p>Introduction to <span class="hl-yellow"><strong>analysis and preprocessing of data</strong></span> → <code>{tidyverse}</code>.</p></li>
<li class="fragment"><p>Handling <span class="hl-yellow"><strong>advanced data types</strong></span> → <code>{forcats}</code>, <code>{lubridate}</code> and <code>{purrr}</code> packages</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="evaluation-intro-to-r" class="slide level2">
<h2>Evaluation: intro to R</h2>
<ul>
<li><span class="hl-yellow"><strong>Attendance and individual participation</strong></span> (30%)</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Final exam</strong></span> on 10/09/2024, 15:00-16:10 (70%).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Max grade</strong></span>: to get a grade greater than 9/10 you should get at least 9/10 in the final exam.</li>
</ul>
</div>
</section>
<section id="evaluation-data-programming" class="slide level2">
<h2>Evaluation: data programming</h2>
<ul>
<li><span class="hl-yellow"><strong>Attendance and individual participation</strong></span> (10%)</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>2 individual tasks</strong></span> done during the course (20%-25%)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>1 group task</strong></span> between 4 and 6 people (20%). <strong>Deadline</strong>: 23/12/2024.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Final exam</strong></span> with all materials and internet (25%). <span class="hl-purple"><strong>You are exempt if you get more than 7/10</strong></span> in the previous tasks.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Max grade</strong></span>: to get a grade greater than 9/10 you should get at least 9/10 in the individual tasks.</li>
</ul>
</div>
</section>
<section id="planning" class="slide level2">
<h2>Planning</h2>
<ul>
<li><span class="hl-yellow"><strong>Final exam (intro R 70%)</strong></span>: 10/09/2024 (15:00 - 16:10).</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p><span class="hl-yellow"><strong>Individual task I (20%)</strong></span>: deadline 03/11/2024</p></li>
<li><p><span class="hl-yellow"><strong>Individual task II (25%)</strong></span>: deadline 30/11/2024</p></li>
<li><p><span class="hl-yellow"><strong>Group task (20%)</strong></span>: deadline 23/12/2024.</p></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><span class="hl-yellow"><strong>Final exam (25% if required)</strong></span>: TBA</li>
</ul>
</section>
<section id="planificacion" class="slide level2">
<h2>Planning: intro R</h2>
<div class="column-screen-inset-right">
<div style="font-size:20px">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">LESSON</th>
<th style="text-align: center;">WEEK</th>
<th style="text-align: center;">DATES</th>
<th style="text-align: center;">TOPIC</th>
<th style="text-align: center;">EX.</th>
<th style="text-align: center;">WORKBOOK</th>
<th style="text-align: center;">TASK</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-0-1">0-1</a></td>
<td style="text-align: center;">S1</td>
<td style="text-align: center;">2 sep</td>
<td style="text-align: center;">First steps: R base programming</td>
<td style="text-align: center;"><a href="#/tu-turno-0-1-1">💻</a> <a href="#/tu-turno-0-1-2">💻</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-0-2">0-2</a></td>
<td style="text-align: center;">S1</td>
<td style="text-align: center;">4 sep</td>
<td style="text-align: center;">First data: concatenate values and databases</td>
<td style="text-align: center;"><a href="#/tu-turno-0-2-1">💻</a> <a href="#/tu-turno-0-2-2">💻</a> <a href="#/tu-turno-0-2-3">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-0-2-1">🐣</a> <a href="#/caso-practico-0-2-2">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-0-3">0-3</a></td>
<td style="text-align: center;">S1</td>
<td style="text-align: center;">6 sep</td>
<td style="text-align: center;">Quarto and if-else</td>
<td style="text-align: center;"><a href="#/tu-turno-0-3-1">💻</a> <a href="#/tu-turno-0-3-2">💻</a> <a href="#/tu-turno-0-3-3">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-0-3-1">🐣</a> <a href="#/caso-practico-0-3-2">🐣</a> <a href="#/caso-practico-0-3-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-0-4">0-4</a></td>
<td style="text-align: center;">S2</td>
<td style="text-align: center;">10 sep</td>
<td style="text-align: center;">Final task</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><a href="#/clase-0-4">🎯 (70%)</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="planificacion-curso" class="slide level2">
<h2>Planning: data programming</h2>
<div class="column-screen-inset-right">
<div style="font-size:20px">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">LESSON</th>
<th style="text-align: center;">WEEK</th>
<th style="text-align: center;">DATES</th>
<th style="text-align: center;">TOPIC</th>
<th style="text-align: center;">EX.</th>
<th style="text-align: center;">WORKBOOK</th>
<th style="text-align: center;">TASK</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-1">1</a></td>
<td style="text-align: center;">S2</td>
<td style="text-align: center;">12 sep</td>
<td style="text-align: center;">Intro to tidy data</td>
<td style="text-align: center;"><a href="#/tu-turno-1-1">💻</a> <a href="#/tu-turno-1-2">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-1">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-2">2</a></td>
<td style="text-align: center;">S3</td>
<td style="text-align: center;">19 sep</td>
<td style="text-align: center;">Tidyverse: by rows</td>
<td style="text-align: center;"><a href="#/tu-turno-2-1">💻</a> <a href="#/tu-turno-2-2">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-2">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-3">3</a></td>
<td style="text-align: center;">S4</td>
<td style="text-align: center;">26 sep</td>
<td style="text-align: center;">Tidyverse: by columns</td>
<td style="text-align: center;"><a href="#/tu-turno-3-1">💻</a> <a href="#/tu-turno-3-2">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-3-1">🐣</a> <a href="#/caso-practico-3-2">🐣</a> <a href="#/caso-practico-3-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-4">4</a></td>
<td style="text-align: center;">S5</td>
<td style="text-align: center;">3 oct</td>
<td style="text-align: center;">Tidyverse: summary</td>
<td style="text-align: center;"><a href="#/tu-turno-4-1">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-4-1">🐣</a> <a href="#/caso-practico-4-2">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-5">5</a></td>
<td style="text-align: center;">S6</td>
<td style="text-align: center;">10 oct</td>
<td style="text-align: center;">Loops</td>
<td style="text-align: center;"><a href="#/tu-turno-5-1">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-5-1">🐣</a> <a href="#/caso-practico-5-2">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-6">6</a></td>
<td style="text-align: center;">S7</td>
<td style="text-align: center;">17 oct</td>
<td style="text-align: center;">Functions and joins</td>
<td style="text-align: center;"><a href="#/tu-turno-6-1">💻</a> <a href="#/tu-turno-6-2">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-6-1">🐣</a> <a href="#/caso-practico-6-2">🐣</a> <a href="#/caso-practico-6-3">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-7">7</a></td>
<td style="text-align: center;">S8</td>
<td style="text-align: center;">24 oct</td>
<td style="text-align: center;">Import/export</td>
<td style="text-align: center;"><a href="#/tu-turno-7-1">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-7-1">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="#/clase-8">8</a></td>
<td style="text-align: center;">S10</td>
<td style="text-align: center;">6 nov</td>
<td style="text-align: center;">Purrr and forcats packages</td>
<td style="text-align: center;"><a href="#/tu-turno-8-1">💻</a> <a href="#/tu-turno-8-2">💻</a></td>
<td style="text-align: center;"><a href="#/caso-practico-8-1">🐣</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="#/clase-9">9</a></td>
<td style="text-align: center;">S11</td>
<td style="text-align: center;">13 nov</td>
<td style="text-align: center;">Github and SQL connection</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="materials" class="slide level2">
<h2>Materials</h2>
<ul>
<li><span class="hl-yellow"><strong>Slides</strong></span>: slides made with <code>Quarto</code> available and updated on <strong><a href="https://javieralvarezliebana.es/docencia/mucss-data-programming" class="uri">https://javieralvarezliebana.es/docencia/mucss-data-programming</a></strong>. In the slide menu (bottom left) you have an option to <span class="hl-yellow"><strong>download them in pdf</strong></span> in <code>Tools</code></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p><span class="hl-yellow"><strong>Material</strong></span>: <a href="https://javieralvarezliebana.es/docencia/mucss-data-programming/material/"><strong>workbooks</strong></a> and extra materials.</p></li>
<li><p><span class="hl-yellow">🗃 <strong>Data</strong></span>: datasets that will be used, available on <strong><a href="https://javieralvarezliebana.es/docencia/mucss-data-programming/material" class="uri">https://javieralvarezliebana.es/docencia/mucss-data-programming/material</a></strong> or <strong>Google Drive</strong> <a href="https://drive.google.com/drive/folders/18Ok6Epqcimszqguj_JTTLuSbs5Ot5Srd?usp=sharing" class="uri">https://drive.google.com/drive/folders/18Ok6Epqcimszqguj_JTTLuSbs5Ot5Srd?usp=sharing</a></p></li>
<li><p><span class="hl-yellow">📚 <strong>Extra resources</strong></span>: <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a>, <a href="https://cdr-book.github.io/" class="uri">https://cdr-book.github.io/</a> and <a href="https://ivelasq.quarto.pub/intro-to-quarto/" class="uri">https://ivelasq.quarto.pub/intro-to-quarto/</a>.</p></li>
</ul>
</section>
<section>
<section id="clase-0-1" class="title-slide slide level1 center">
<h1>L1: <span class="flow">first steps</span></h1>
<p><span style="color:#444442;"><strong>Introduction to R and RStudio. Working with projects. First uses of functions and packages. Basic data types</strong></span></p>
<ul>
<li><a href="#/tu-turno-0-1-1">💻 Solved exercises: first steps</a></li>
<li><a href="#/tu-turno-0-1-2">💻 Solved exercises: first variables</a></li>
<li><a href="#/planificacion">📆 Planning</a></li>
</ul>
</section>
<section id="requirements" class="slide level2">
<h2>Requirements</h2>
<p>For the course, the only requirements will be:</p>
<ol type="1">
<li><span class="hl-yellow"><strong>Internet connection</strong></span> (to download some data and packages).</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li><span class="hl-yellow"><strong>Install R</strong></span>: it will be our language. We will download it (for free) from <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a></li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><span class="hl-yellow"><strong>Install RStudio</strong></span> from <a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a></li>
</ol>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/cranR.jpg" width="420"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rstudio.jpg" width="420"></p>
</div>
</div>
</div>
</section>
<section id="r-vs-rstudio" class="slide level2">
<h2>R vs RStudio</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/gramatica.webp" width="360"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/word.jpg" width="430"></p>
</div>
</div>
<div class="fragment fade-in-then-out">
<p>We will program as we write</p>
</div>
<div class="fragment fade-up">
<ul>
<li>We will need a <span class="hl-yellow"><strong>grammar, a language</strong></span> (<code>R</code>)</li>
</ul>
<div class="fragment fade-in">
<ul>
<li>And an environment, such as <span class="hl-yellow"><strong>Word</strong></span> (<code>RStudio</code>) to write it</li>
</ul>
</div>
</div>
</section>
<section id="installing-r" class="slide level2">
<h2>Installing R</h2>
<p>The <code>R</code> language will be our <span class="hl-yellow"><strong>grammar and spelling</strong></span> (our rules of the game)</p>
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 1</strong></span>: go to <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a> and select your operating system.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 2</strong></span>: for Mac, simply click on the <strong>.pkg file</strong>, and open it once downloaded. For Windows systems, we need to click on <strong>install R for the first time</strong> and then on <strong>Download R for Windows</strong>. Once downloaded, open it like any installation file.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 3</strong></span>: open the installation executable.</p></li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Cuidado</strong></p>
</div>
<div class="callout-content">
<p>Whenever you need to download something from CRAN (either <code>R</code> itself or a package), <span class="hl-orange"><strong>make sure you have an internet connection</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="first-operation" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">First operation</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>To check the installation, after opening <code>R</code>, you should see the <code>R GUI</code> (Graphical User Interface) with a <strong>white screen</strong> similar to this (<span class="hl-yellow"><strong>console</strong></span>).</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/consola.jpg" width="200"></p>
</div>
</div>
<div class="fragment">
<p><span class="hl-yellow"><strong>First code</strong></span>: we will <strong>assign</strong> the value <code>1</code> to a variable called <code>a</code> (we will write the code in the console and press “enter”). Then we will do the sum <code>a + b</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="1"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb1-1" class="hljs-ln-code"><a href="#cb1-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="first-operation-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">First operation</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>To check the installation, after opening <code>R</code>, you should see the <code>R GUI</code> (Graphical User Interface) with a <strong>white screen</strong> similar to this (<span class="hl-yellow"><strong>console</strong></span>).</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/consola.jpg" width="200"></p>
</div>
</div>
<p><span class="hl-yellow"><strong>First code</strong></span>: we will <strong>assign</strong> the value <code>1</code> to a variable called <code>a</code> (we will write the code in the console and press “enter”). Then we will do the sum <code>a + b</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="2"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb2-1" class="hljs-ln-code"><a href="#cb2-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-2" class="hljs-ln-code"><a href="#cb2-2"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="first-operation-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">First operation</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>To check the installation, after opening <code>R</code>, you should see the <code>R GUI</code> (Graphical User Interface) with a <strong>white screen</strong> similar to this (<span class="hl-yellow"><strong>console</strong></span>).</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/consola.jpg" width="200"></p>
</div>
</div>
<p><span class="hl-yellow"><strong>First code</strong></span>: we will <strong>assign</strong> the value <code>1</code> to a variable called <code>a</code> (we will write the code in the console and press “enter”). Then we will do the sum <code>a + b</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb3-1" class="hljs-ln-code"><a href="#cb3-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-2" class="hljs-ln-code"><a href="#cb3-2"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb3-3" class="hljs-ln-code"><a href="#cb3-3"></a>a <span class="sc">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>In the console, a number <code>[1]</code> appears: it’s simply an element counter (like counting rows in Word)</p>
</div>
</div>
</div>
</div>
</section>
<section id="installing-r-studio" class="slide level2">
<h2>Installing R Studio</h2>
<p><code>RStudio</code> will be the <span class="hl-yellow"><strong>Word</strong></span> we will use to write (what is known as an <span class="hl-yellow"><strong>IDE: Integrated Development Environment</strong></span>).</p>
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 1</strong></span>: go to the <a href="https://posit.co/download/rstudio-desktop/">official RStudio website</a> (now called Posit) and select the free download.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 2</strong></span>: select the executable that appears according to your operating system.</p></li>
<li class="fragment"><p><span class="hl-yellow"><strong>Step 3</strong></span>: after downloading the executable, open it like any other and let the installation finish.</p></li>
</ul>
</div>
</section>
<section id="rstudio-organization" class="slide level2">
<h2>RStudio Organization</h2>
<p>When you open <code>RStudio</code> you will likely have three windows:</p>
<ul>
<li><span class="hl-yellow"><strong>Console</strong></span>: is the name for the large window that takes up most of your screen. Try writing the same code as before (the sum of the variables) in it. The console is where <strong>we will execute commands and display results</strong>.</li>
</ul>

<img data-src="img/consola_rstudio.jpg" width="420" class="r-stretch"></section>
<section id="rstudio-organization-1" class="slide level2">
<h2>RStudio Organization</h2>
<p>When you open <code>RStudio</code> you will likely have three windows:</p>
<ul>
<li><span class="hl-yellow"><strong>Environment</strong></span>: the small screen (you can adjust the margins with the mouse to your liking) that we have in the top right corner. It will show us the <strong>variables we have defined</strong>.</li>
</ul>

<img data-src="img/environment.jpg" width="420" class="r-stretch"></section>
<section id="rstudio-organization-2" class="slide level2">
<h2>RStudio Organization</h2>
<p>When you open <code>RStudio</code> you will likely have three windows:</p>
<ul>
<li><span class="hl-yellow"><strong>Multi-purpose panel</strong></span>: the window at the bottom right will be used to <strong>look for function help</strong>, as well as to <strong>visualize plots</strong>.</li>
</ul>

<img data-src="img/multiusos.jpg" width="420" class="r-stretch"></section>
<section id="what-is-r-why-r" class="slide level2">
<h2>What is R? Why R?</h2>

<img data-src="img/meme_barco.jpg" class="r-stretch"></section>
<section id="what-is-r-why-r-1" class="slide level2">
<h2>What is R? Why R?</h2>

<img data-src="img/incel_excel.png" class="r-stretch"><p><code>R</code> is the evolution of the work of Bell Laboratories with the <code>S</code> language, which was brought into the open-source world by Ross Ihaka and Robert Gentleman in the 1990s. The version <code>R 1.0.0</code> was released on February 29, 2000.</p>
</section>
<section id="what-is-r-why-r-2" class="slide level2">
<h2>What is R? Why R?</h2>
<p><code>R</code> is the <span class="hl-yellow"><strong>statistical language par excellence</strong></span>, created by and for statisticians, with 6 fundamental advantages <span class="hl-red"><strong>over Excel, SAS, Stata, or SPSS</strong></span>:</p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Programming language</strong></span>: the obvious → <span class="hl-purple"><strong>replicable</strong></span> analysis</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Free</strong></span>: the philosophy of the <code>R</code> community is to share code under <strong>copyleft</strong> → <strong>ethical use of spending and algorithms</strong></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Open-source software</strong></span>: not only is it free, but it also allows free access to others’ code, even to the <strong>source code itself</strong> → <span class="hl-purple"><strong>flexibility and transparency</strong></span> (Free and Open Source Software FOSS)</li>
</ul>
</div>
</section>
<section id="what-is-r-why-r-3" class="slide level2">
<h2>What is R? Why R?</h2>
<p><code>R</code> is the <span class="hl-yellow"><strong>statistical language par excellence</strong></span>, created by and for statisticians, with 6 fundamental advantages <span class="hl-red"><strong>over Excel, SAS, Stata, or SPSS</strong></span>:</p>
<ul>
<li><span class="hl-yellow"><strong>Modular language</strong></span>: we have installed the minimum, but there are codes from other people that we can reuse (almost 20,000 <span class="hl-yellow"><strong>packages</strong></span>) → <span class="hl-purple"><strong>time saving</strong></span> and <span class="hl-purple"><strong>immediate innovation</strong></span></li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>High-level language</strong></span>: facilitates programming (like Python) → <span class="hl-purple"><strong>lower learning curve</strong></span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Community and employability</strong></span>: along with Python, it is the most used language in the field of statistics and data science in research, teaching, companies (Línea Directa, Mapfre, Telefónica, Orange, Apple, Spotify, Netflix, El País, Civio, HP, etc.) and public organizations (ISCIII, CNIC, CNIO, INE, IGN, CIS, CEO, DGT, AEMET, RTVE, etc.)</li>
</ul>
</div>
</section>
<section id="why-programming" class="slide level2">
<h2>Why programming?</h2>
<ul>
<li><p><span class="hl-yellow"><strong>Automate</strong></span> → it will allow you to automate recurring tasks.</p></li>
<li><p><span class="hl-yellow"><strong>Replicability</strong></span> → you will be able to replicate your analysis in the same way every time.</p></li>
<li><p><span class="hl-yellow"><strong>Flexibility</strong></span> → you will be able to adapt the software to your needs.</p></li>
<li><p><span class="hl-yellow"><strong>Transparency</strong></span> → to be audited by the community.</p></li>
</ul>

<img data-src="img/the_general_problem.png" class="r-stretch"></section>
<section id="fundamental-idea-packages" class="slide level2">
<h2>Fundamental Idea: Packages</h2>
<p>One of the key ideas of <code>R</code> is the <span class="hl-yellow"><strong>use of packages</strong></span>: codes that other people have implemented to <strong>solve a problem</strong></p>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/paquetes.png"></p>
</div><div class="column" style="width:65%;">
<div class="fragment" data-fragment-index="1">
<ul>
<li><span class="hl-yellow"><strong>Installation</strong></span>: we download the codes from the web (we need internet) → <span class="hl-purple"><strong>buy a book</strong></span>, only once (per computer)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment" data-fragment-index="2">
<ul>
<li><span class="hl-yellow"><strong>Loading</strong></span>: with the package downloaded, we indicate which packages we want to use each time we open <code>RStudio</code> → <span class="hl-purple"><strong>take the book off the shelf</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="fundamental-idea-packages-1" class="slide level2">
<h2>Fundamental Idea: Packages</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/paquetes.png"></p>
</div><div class="column" style="width:65%;">
<p>Once installed, there are <strong>two ways to use a package</strong> (take it off the shelf)</p>
<div class="fragment" data-fragment-index="1">
<ul>
<li><span class="hl-yellow"><strong>Whole package</strong></span>: with <code>library()</code>, using the package name without quotes, we load <span class="hl-purple"><strong>the whole book</strong></span> into the session</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment" data-fragment-index="2">
<ul>
<li><span class="hl-yellow"><strong>Specific functions</strong></span> using `package::function+ we indicate that we only want <span class="hl-purple"><strong>a specific page of that book</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="you-will-be-wrong" class="slide level2">
<h2>You will be wrong</h2>
<p>During your learning, it will be very common for things not to work out on the first try → <span class="hl-yellow"><strong>you will be wrong</strong></span>. It will not only be important to accept it but also <span class="hl-yellow"><strong>to read the error messages</strong></span> to learn from them.</p>
<div class="fragment">
<ul>
<li><span class="hl-red"><strong>Error messages</strong></span>: preceded by <strong>“Error in…”</strong> and will be those failures that <span class="hl-red"><strong>prevent execution</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="st">"a"</span> <span class="sc">+</span> <span class="dv">1</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in "a" + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-orange"><strong>Warning messages</strong></span>: preceded by <strong>«Warning in…»</strong> they are the (possible) more delicate errors as they are inconsistencies that <span class="hl-orange"><strong>do not prevent execution</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Ejecuta la orden pero el resultado es NaN, **Not A Number**, un valor que no existe</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(-1): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NaN</code></pre>
</div>
</div>
</div>
</section>
<section id="scripts-.r-files" class="slide level2">
<h2>Scripts (.R files)</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/abrir_script.jpg" width="350"></p>
</div><div class="column" style="width:65%;">
<p>A <span class="hl-yellow"><strong>script</strong></span> will be the document in which we program, our <code>.doc</code> file (here with a <code>.R</code> extension) where we will write the commands. To <strong>open our first script</strong>, click on the menu in <code>File &lt; New File &lt; R Script</code>.</p>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful</strong></p>
</div>
<div class="callout-content">
<p>It’s important <strong>not to overuse the console</strong>: everything you don’t write in a script, when you close, <span class="hl-orange"><strong>will be lost</strong></span>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful</strong></p>
</div>
<div class="callout-content">
<p><code>R</code> is <span class="hl-orange"><strong>case-sensitive</strong></span>: it is sensitive to uppercase and lowercase, so <code>x</code> and <code>X</code> represent different variables.</p>
</div>
</div>
</div>
</section>
<section id="running-the-first-script" class="slide level2">
<h2>Running the first script</h2>
<p>Now we have a <strong>fourth window</strong>: the window where we will <span class="hl-yellow"><strong>write our codes</strong></span>. How do we run it?</p>
<div class="fragment">
<ol type="1">
<li><strong>Write the code</strong> to be executed.</li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><strong>Save the .R file</strong> by clicking on <code>Save current document</code>.</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>The code does not execute unless we indicate it. We have <strong>three options to run a script</strong>:</li>
</ol>
<ul>
<li><span class="hl-yellow"><strong>Copy and paste</strong></span> into the console.</li>
<li><span class="hl-yellow"><strong>Select lines</strong></span> and press <code>Ctrl+Enter</code></li>
<li><span class="hl-yellow"><strong>Enable Source on Save</strong></span> next to save: not only saves but also executes the <strong>entire code</strong>.</li>
</ul>
</div>
</section>
<section id="organizing-projects" class="slide level2">
<h2>Organizing: projects</h2>
<p>Just as we usually work <span class="hl-yellow"><strong>organized by folders</strong></span> on the computer, in <code>RStudio</code> we can do the same to work <span class="hl-yellow"><strong>efficiently by creating projects</strong></span>.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:60%;">
<p>A <span class="hl-yellow"><strong>project will be a “folder”</strong></span> within <code>RStudio</code>, so our root directory will automatically be the project folder itself (allowing us to switch from one project to another using the top right menu).</p>
<p>We can create one in a new folder or in an existing folder.”</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/rstudio_proyectos.png" width="370"></p>
</div>
</div>
</div>
</section>
<section id="tu-turno-0-1-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-1-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-1-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-1-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-1-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-1-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-1-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li><li><a href="#tabset-1-8"><span class="hl-yellow"><strong>Exercise 8</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<p>📝 Create in your computer a folder of the subject and create inside it the <code>RStudio</code> project: it is there where you are going to save everything that we will do along this course, after creating the project you will have an <code>R Project</code> file. Then create in this folder two subfolders: <code>data</code> (this is where you will save the different datasets that we will use) and <code>scripts</code> (this is where you will save the <code>.R</code> files of each class).</p>
</div>
<div id="tabset-1-2">
<p>📝 Inside the project create a script <code>Exercises-class1.R</code> (inside the <code>scripts</code> folder). Once created, define in it a variable named <code>a</code> and whose value is -1. Execute the code in the (three) ways explained before.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3">
<p>📝 Add below another line to define a variable <code>b</code> with the value 5. Then save the multiplication of both variables. Execute the code as you want.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>a <span class="sc">*</span> b <span class="co"># without saving it</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>mult <span class="ot">&lt;-</span> a <span class="sc">*</span> b <span class="co"># save it</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-4">
<p>📝 Modify the code below to define two variables c and d, with values 3 and -1. Then divide the variables and save the result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>c <span class="ot">&lt;-</span> <span class="co"># you should assign 3</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>d <span class="ot">&lt;-</span> <span class="co"># you should assign -1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>c <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>d <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>c <span class="sc">/</span> d</span>
<span id="cb17-4"><a href="#cb17-4"></a>div <span class="ot">&lt;-</span> c <span class="sc">/</span> d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-5">
<p>📝 Assign to <code>x</code> a positive value and then compute its square root; assign to <code>y</code> a negative number and compute its absolute value using <code>abs()</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">sqrt</span>(x)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a>y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="fu">abs</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>Commands like <code>sqrt()</code>, <code>abs()</code> or <code>max()</code> are what we call <span class="hl-purple"><strong>functions</strong></span>: lines of code that we have “encapsulated” under a name, and given some input arguments, execute the commands (a sort of shortcut). In the functions the <span class="hl-yellow"><strong>arguments will ALWAYS be enclosed in parentheses</strong></span></p>
</div>
</div>
</div>
</div>
<div id="tabset-1-6">
<p>📝 Using the variable <code>x</code> already defined, complete/modify the code below to store in a new variable <code>z</code> the result stored in <code>x</code> minus 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>z <span class="ot">&lt;-</span> ? <span class="sc">-</span> ? <span class="co"># complete the code</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>z <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="dv">5</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-7">
<p>📝 Define an <code>x</code> variable and assign it the value <code>-1</code>. Define another <code>y</code> and assign it the value <code>0</code>. Then perform the operations a) <code>x</code> by <code>y</code>; b) square root of <code>x</code>. What do you get?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a>x <span class="sc">/</span> y</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="fu">sqrt</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-8">
<p>📝 Write the code below in your script. Why do you think it doesn’t work?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a>X <span class="sc">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'X' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="from-cell-to-table" class="slide level2">
<h2>From CELL to TABLE</h2>
<p>What <span class="hl-yellow"><strong>data type</strong></span> can we have in each <strong>cell of a table</strong>?</p>

<img data-src="img/celdas.jpg" class="r-stretch"><div>
<ul>
<li class="fragment"><span class="hl-yellow"><strong>Cell</strong></span>: an individual piece of data of a specific type.</li>
<li class="fragment"><span class="hl-yellow"><strong>Variable</strong></span>: <strong>concatenation</strong> of values of the same type (<span class="hl-purple"><strong>vectors in R</strong></span>).</li>
<li class="fragment"><span class="hl-yellow"><strong>Matrix</strong></span>: concatenation of variables of the <strong>same type and length</strong>.</li>
<li class="fragment"><span class="hl-yellow"><strong>Table</strong></span>: concatenation of variables of <span class="hl-purple"><strong>different types but the same length</strong></span></li>
<li class="fragment"><span class="hl-yellow"><strong>List</strong></span>: concatenation of variables of <span class="hl-purple"><strong>different types and different lengths</strong></span></li>
</ul>
</div>
</section>
<section id="but-firstbest-practices" class="slide level2">
<h2>But first…best practices</h2>
<p>Before we continue, it’s important to know something as soon as possible: <span class="hl-yellow"><strong>starting with programming can be frustrating</strong></span></p>
<div class="fragment">
<p>Just like when learning a new language, the first obstacle is not so much what to say but how to say it correctly. The same goes for <code>R</code>, so let’s <span class="hl-yellow"><strong>standardize our programming style</strong></span> as much as possible to avoid future errors.</p>
</div>
<div class="fragment">
<ul>
<li><span class="hl-green"><strong>Tip 1</strong></span>: <span class="hl-yellow"><strong>assignment, evaluation, and comparison are not the same</strong></span>. If you’ve noticed in <code>R</code>, we use <code>&lt;-</code> to assign values to variables. We use <code>=</code> to evaluate function arguments and <code>==</code> to check if two elements are equal.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># asign</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>x <span class="ot">=</span> <span class="dv">1</span> <span class="co"># evaluation</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>x <span class="sc">==</span> <span class="dv">1</span> <span class="co"># comparison</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="but-firstbest-practices-1" class="slide level2">
<h2>But first…best practices</h2>
<ul>
<li><span class="hl-green"><strong>Tip 2</strong></span>: program like you write. Just like when writing in Spanish, get used to incorporating <span class="hl-yellow"><strong>spaces and line breaks</strong></span> to avoid making your code hard to read (it’s a good practice, not a requirement, because <code>R</code> does not process spaces).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># optimal</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>x<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co"># meh</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>x<span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># worst (make up your mind)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-green"><strong>Tip 3</strong></span>: don’t be chaotic, <span class="hl-yellow"><strong>standardize names</strong></span>. Always get used to naming variables consistently. The only requirement is that <strong>they must always start with a letter</strong> (and without accents). The most recommended form is <code>snake_case</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>variable_in_snake_case</span>
<span id="cb26-2"><a href="#cb26-2"></a>anotherHarderToReadFormat</span>
<span id="cb26-3"><a href="#cb26-3"></a>there.are.people.who.use.this</span>
<span id="cb26-4"><a href="#cb26-4"></a>Even_People_Here.Confusing_That_Do_Not_Deserve_Our_ATTENTION</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="but-firstbest-practices-2" class="slide level2">
<h2>But first…best practices</h2>
<ul>
<li><span class="hl-green"><strong>Tip 4</strong></span>: make reading and writing easier, <span class="hl-yellow"><strong>set limits</strong></span>. In <code>Tools &lt; Global Options</code>, you can customize some options in <code>RStudio</code>. In <code>Code &lt; Display</code>, you can set <code>Show margin</code> to display an “imaginary” margin (not interacting with the code) to “force” you to make line breaks.</li>
</ul>

<img data-src="img/show_margin.jpg" class="r-stretch"></section>
<section id="but-firstbest-practices-3" class="slide level2">
<h2>But first…best practices</h2>
<ul>
<li><span class="hl-green"><strong>Tip 5</strong></span>: the <span class="hl-yellow"><strong>tab key is your best friend</strong></span>. In <code>RStudio</code>, there’s a wonderful tool: if you type part of a variable or function name and press tab, <code>RStudio</code> will autocomplete it for you.</li>
</ul>

<img data-src="img/tab-autocompletar.png" class="r-stretch"></section>
<section id="but-firstbest-practices-4" class="slide level2">
<h2>But first…best practices</h2>
<ul>
<li><span class="hl-green"><strong>Tip 6</strong></span>: no single parentheses. Whenever you open a parenthesis, you must close it. To make this task easier, go to <code>Tools &lt; Global Options &lt; Code &lt; Display</code> and enable the <code>Rainbow parentheses option</code>.</li>
</ul>

<img data-src="img/rainbow-parentheses.jpg" class="r-stretch"></section>
<section id="but-firstbest-practices-5" class="slide level2">
<h2>But first…best practices</h2>
<ul>
<li><span class="hl-green"><strong>Tip 7</strong></span>: pay attention to the left side. You will not only see the line of code you are on but also, in case of a <span class="hl-red"><strong>syntax error</strong></span>, <code>RStudio</code> will notify you.</li>
</ul>

<img data-src="img/rstudio-error-sintaxis.png" class="r-stretch"><ul>
<li><span class="hl-green"><strong>Tip 8</strong></span>: try to <span class="hl-yellow"><strong>always work by projects</strong></span> (for this class, create a script <code>class1.R</code> in the project we created before)</li>
</ul>
<p>&nbsp;</p>
<p>See more tips at <a href="https://r4ds.had.co.nz/workflow-basics.html#whats-in-a-name" class="uri">https://r4ds.had.co.nz/workflow-basics.html#whats-in-a-name</a></p>
</section>
<section id="cells-data-types" class="slide level2">
<h2>Cells: data types</h2>
<p>Are there <span class="hl-yellow"><strong>variables beyond numbers in data science</strong></span>? For example, think about the data you might store about a person:</p>
<div class="fragment fade-up">
<ul>
<li>Age or weight will be a <span class="hl-yellow"><strong>number</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>age <span class="ot">&lt;-</span> <span class="dv">33</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>Their name will be a string of <span class="hl-yellow"><strong>text (known as string or char)</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>name <span class="ot">&lt;-</span> <span class="st">"javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>The answer to the question “Are you enrolled in the Faculty?” will be what we call a <span class="hl-yellow"><strong>logical variable</strong></span> (<code>TRUE</code> if enrolled or <code>FALSE</code> otherwise).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>enrolled <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment fade-up">
<ul>
<li>Their date of birth will be precisely that, a <span class="hl-yellow"><strong>date</strong></span>.</li>
</ul>
</div>
</section>
<section id="numerical-variables" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Numerical variables</h2>
<p>The simplest data (which we’ve already used) will be <span class="hl-yellow"><strong>numeric variables</strong></span>. To find out the <span class="hl-yellow"><strong>data class in R</strong></span> of a variable, we use the <code>class()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" data-code-line-numbers="1"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb30-1" class="hljs-ln-code"><a href="#cb30-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="numerical-variables-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Numerical variables</h2>
<p>The simplest data type (we have already used it) will be the <span class="hl-yellow"><strong>numeric variables</strong></span>. To know the <span class="hl-yellow"><strong>data class in R</strong></span> of a variable we have the function <code>class()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" data-code-line-numbers="2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="fu">class</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>To know its <span class="hl-yellow"><strong>typology (format)</strong></span> variable we have <code>typeof()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">typeof</span>(<span class="dv">1</span>) <span class="co"># 1 value but stored as a real number (double precision)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">typeof</span>(<span class="fu">as.integer</span>(<span class="dv">1</span>)) <span class="co"># 1 value but stored as a floor number</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>In <code>R</code> we have a collection of functions starting with <code>as.x()</code> that serve as <span class="hl-yellow"><strong>conversion functions</strong></span>: a data that was of one type, we convert it to type <code>x</code>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="numerical-variables-2" class="slide level2">
<h2>Numerical variables</h2>
<p>In addition to the “common” numbers we will have the <span class="hl-yellow"><strong>plus/minus infinity</strong></span> coded as <code>Inf</code> or <code>-Inf</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Inf</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -Inf</code></pre>
</div>
</div>
<div class="fragment">
<p>And values that <span class="hl-yellow"><strong>are not real numbers</strong></span> <em>not a number</em> (indeterminacies, complexes numbers, etc) encoded as <code>NaN</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="dv">0</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NaN</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NaN</code></pre>
</div>
</div>
</div>
</section>
<section id="numerical-variables-3" class="slide level2">
<h2>Numerical variables</h2>
<p>With numeric variables we can perform the <span class="hl-yellow"><strong>arithmetic operations</strong></span> of a calculator: adding (<code>+</code>)…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>a <span class="sc">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
<div class="fragment">
<p>…square root (<code>sqrt()</code>)…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">sqrt</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.236068</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>… power (<code>^2</code>, <code>^3</code>)…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>a<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>…absolute value (<code>abs()</code>), etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">abs</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
</div>
</section>
<section id="string-variables" class="slide level2">
<h2>String variables</h2>
<p>Let us imagine that, in addition to the age of a person we want to store his/her name: now the variable will be of type <code>character</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>name <span class="ot">&lt;-</span> <span class="st">"Javi"</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="fu">class</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<div class="fragment">
<p>The <span class="hl-yellow"><strong>text strings</strong></span> are a type with which we obviously <span class="hl-red"><strong>cannot perform arithmetic operations</strong></span> (other operations such as pasting or locating patterns can be performed).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>name <span class="sc">+</span> <span class="dv">1</span> <span class="co"># error when we try to sum 1 to a text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in name + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Reminder</strong></p>
</div>
<div class="callout-content">
<p>Text variables (character or string) are <span class="hl-orange">** ALWAYS in quotes**</span>: <code>TRUE</code> (logical, binary value) is not the same as <code>"TRUE"</code> (text).</p>
</div>
</div>
</div>
</div>
</section>
<section id="first-function-paste" class="slide level2">
<h2>First function: paste</h2>
<p>As we have commented <code>R</code> we will call <span class="hl-yellow"><strong>function</strong></span> a piece of <span class="hl-yellow"><strong>encapsulated code</strong></span> under a name, and which depends on some input <span class="hl-yellow"><strong>arguments</strong></span>. Our first function will be <code>paste()</code>: given two strings, it allows us to paste them together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">paste</span>(<span class="st">"Javi"</span>, <span class="st">"Álvarez"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javi Álvarez"</code></pre>
</div>
</div>
<div class="fragment">
<p>Note that <span class="hl-yellow"><strong>default</strong></span> pastes strings with a space, but we can add an <span class="hl-yellow"><strong>optional argument</strong></span> to tell it the separator (in <code>sep = ...</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">paste</span>(<span class="st">"Javi"</span>, <span class="st">"Álvarez"</span>, <span class="at">sep =</span> <span class="st">"*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javi*Álvarez"</code></pre>
</div>
</div>
</div>
</section>
<section id="first-function-paste-1" class="slide level2">
<h2>First function: paste</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/paste_help.jpg"></p>
</div><div class="column" style="width:50%;">
<p>How do I know <span class="hl-yellow"><strong>what arguments does a function need</strong></span>?</p>
<p>By typing <code>? paste</code> in the console, you will get a <span class="hl-yellow"><strong>help</strong></span> in the multipurpose panel, where you can see in its header what arguments the function already has <span class="hl-yellow"><strong>default arguments</strong></span> assigned to it.</p>
</div>
</div>
<div class="fragment">
<p>There is a similar function called <code>paste0()</code> that pastes by default with <code>sep = “”</code> (without anything).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">paste0</span>(<span class="st">"Javi"</span>, <span class="st">"Álvarez"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "JaviÁlvarez"</code></pre>
</div>
</div>
</div>
</section>
<section id="first-function-paste-2" class="slide level2">
<h2>First function: paste</h2>
<p>The arguments (and their detail) can also be consulted by <strong>tabulating (after a comma)</strong>.</p>

<img data-src="img/tab-functions.png" class="r-stretch"></section>
<section id="functions-default-arguments" class="slide level2">
<h2>Functions: default arguments</h2>
<p>It is very important to understand the concept of <span class="hl-yellow"><strong>default argument of a function</strong></span> in <code>R</code>: it is a value that the function uses but sometimes we may not see because <span class="hl-yellow"><strong>already has a value assigned</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># Same</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="fu">paste</span>(<span class="st">"Javi"</span>, <span class="st">"Álvarez"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javi Álvarez"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">paste</span>(<span class="st">"Javi"</span>, <span class="st">"Álvarez"</span>, <span class="at">sep =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javi Álvarez"</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Fíjate que...</strong></p>
</div>
<div class="callout-content">
<p>The <code>=</code> operator is <span class="hl-yellow"><strong>reserved for assigning arguments</strong></span> within functions. For all other assignments, we will use <code>&lt;-</code>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="first-package-glue" class="slide level2">
<h2>First package: glue</h2>
<p>A more intuitive way to work with text is to use the <code>{glue}</code> package: the first thing to do is to “buy the book” (if we have never done it before). After that <span class="hl-yellow"><strong>load the package</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">install.packages</span>(<span class="st">"glue"</span>) <span class="co"># just the first time</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="fu">library</span>(glue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>With the <code>glue()</code> function of that package we can use <span class="hl-yellow"><strong>variables inside strings</strong></span>. For example, “age is … years old”, where the age is stored in a variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>age <span class="ot">&lt;-</span> <span class="dv">34</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="fu">glue</span>(<span class="st">"I am {age} old"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>I am 34 old</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Within the keys we can also <span class="hl-yellow"><strong>execute operations</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>units <span class="ot">&lt;-</span> <span class="st">"days"</span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="fu">glue</span>(<span class="st">"I am {age * 365} {units} old"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>I am 12410 days old</code></pre>
</div>
</div>
</div>
</section>
<section id="logical-variables" class="slide level2">
<h2>Logical variables</h2>
<p>Another fundamental type will be the <span class="hl-yellow"><strong>logical or binary variables</strong></span> (<strong>two values</strong>):</p>
<ul>
<li><p><code>TRUE</code>: <span class="hl-yellow"><strong>true</strong></span> stored internally as a 1.</p></li>
<li><p><code>FALSE</code>: <span class="hl-yellow"><strong>false</strong></span> stored internally as a 0.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>single <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># Single? --&gt; NO</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="fu">class</span>(single)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
<div class="fragment">
<p>Since they are stored internally as binary variables, we can <span class="hl-yellow"><strong>perform arithmetic operations</strong></span> on them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="cn">FALSE</span> <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</div>
</section>
<section id="logical-variables-1" class="slide level2">
<h2>Logical variables</h2>
<p>As we will see shortly, logical variables can actually take a third value: <code>NA</code> or <span class="hl-yellow"><strong>missing data</strong></span>, representing <em>not available</em>, and it will be very common to find it within a database.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>missing <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>missing <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Logical variables <span class="hl-red"><strong>NOT text variables</strong></span>: <code>"TRUE"</code> is a text, <code>TRUE</code> is a logical value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="st">"TRUE"</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in "TRUE" + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="logical-conditions" class="slide level2">
<h2>Logical conditions</h2>
<p>Logical values are usually the result of <span class="hl-yellow"><strong>evaluate logical conditions</strong></span>. For example, imagine that we want to <span class="hl-yellow"><strong>check</strong></span> whether a person is named Javi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>name <span class="ot">&lt;-</span> <span class="st">"María"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>With the <span class="hl-yellow"><strong>logical operator</strong></span> <code>==</code> we ask if what we have stored on the left is <span class="hl-purple"><strong>same as</strong></span> what we have on the right: <span class="hl-yellow"><strong>we ASK</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>name <span class="sc">==</span> <span class="st">"Javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>With its opposite <code>!=</code> we ask <span class="hl-purple"><strong>if different</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>name <span class="sc">!=</span> <span class="st">"Javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note that…</strong></p>
</div>
<div class="callout-content">
<p>It is not the same <code>&lt;-</code> (<span class="hl-yellow"><strong>assignment</strong></span>) as <code>==</code> (we are <span class="hl-yellow"><strong>asking</strong></span>, it is a logical comparison).</p>
</div>
</div>
</div>
</div>
</section>
<section id="logical-conditions-1" class="slide level2">
<h2>Logical conditions</h2>
<p>In addition to “equal to” versus “different” comparisons, also order comparisons such as <span class="hl-purple"><strong>less than</strong></span> <code>&lt;</code>, <span class="hl-purple"><strong>greater than</strong></span> <code>&gt;</code>, <code>&lt;=</code> or <code>&gt;=</code>. <strong>Is the person less than 32 years old?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>age <span class="ot">&lt;-</span> <span class="dv">34</span></span>
<span id="cb88-2"><a href="#cb88-2"></a>age <span class="sc">&lt;</span> <span class="dv">32</span> <span class="co"># less than 32 years old?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<div class="fragment">
<p><strong>Age is greater than or equal to 38 years?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>age <span class="sc">&gt;=</span> <span class="dv">38</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Is the saved name equal to Javi?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>name <span class="ot">&lt;-</span> <span class="st">"Javi"</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>name <span class="sc">==</span> <span class="st">"Javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
</section>
<section id="date-variables" class="slide level2">
<h2>Date variables</h2>
<p>A very special data type: the <span class="hl-yellow"><strong>date type data</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>date_char <span class="ot">&lt;-</span> <span class="st">"2021-04-21"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It looks like a simple text string but <span class="hl-yellow"><strong>should represent an instant in time</strong></span>. What should happen if <span class="hl-purple"><strong>we add a 1 to a date</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>date_char <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in date_char + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
<p>Dates <span class="hl-red"><strong>cannot be string/text</strong></span>: we must convert the text string to date.</p>
</div>
<div class="fragment">
<p>&nbsp;</p>
<p>To work with dates we will use the <code>{lubridate}</code> package, which we must install before we can use it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="fu">install.packages</span>(<span class="st">"lubridate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="date-variables-1" class="slide level2">
<h2>Date variables</h2>
<p>Once installed, of all the packages (books) that we have, we will indicate it to load this one concretely.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="fu">library</span>(lubridate) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>To <span class="hl-yellow"><strong>convert to date type</strong></span> we will use the <code>as_date()</code> function of the <code>{lubridate}</code> package (default in <code>yyyy-mm-dd</code> format).</p>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="co"># it's not a date, it's a text!</span></span>
<span id="cb99-2"><a href="#cb99-2"></a>date_char <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in date_char + 1: non-numeric argument to binary operator</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="fu">class</span>(date_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>date <span class="ot">&lt;-</span> <span class="fu">as_date</span>(<span class="st">"2023-03-28"</span>)</span>
<span id="cb103-2"><a href="#cb103-2"></a>date <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-03-29"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">class</span>(date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="date-variables-2" class="slide level2">
<h2>Date variables</h2>
<p>In <code>as_date()</code> the default date format is <code>yyyy-mm-dd</code> so if the string is not entered correctly…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="fu">as_date</span>(<span class="st">"28-08-2024"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="fragment">
<p>For <span class="hl-yellow"><strong>any other format we must specify it</strong></span> in the optional argument <code>format = ...</code> such that <code>%d</code> represents days, <code>%m</code> months, <code>%Y</code> in 4-year format and <code>%y</code> in 2-year format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">as_date</span>(<span class="st">"28-03-2023"</span>, <span class="at">format =</span> <span class="st">"%d-%m-%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-03-28"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="fu">as_date</span>(<span class="st">"28-03-23"</span>, <span class="at">format =</span> <span class="st">"%d-%m-%y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-03-28"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="fu">as_date</span>(<span class="st">"03-28-2023"</span>, <span class="at">format =</span> <span class="st">"%m-%d-%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-03-28"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="fu">as_date</span>(<span class="st">"28/03/2023"</span>, <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-03-28"</code></pre>
</div>
</div>
</div>
</section>
<section id="date-variables-3" class="slide level2">
<h2>Date variables</h2>
<p>In this package we have very useful functions for <span class="hl-yellow"><strong>date management</strong></span>:</p>
<ul>
<li>With <code>today()</code> we can directly obtain the <span class="hl-purple"><strong>current date</strong></span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="fu">today</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-11-02"</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>With <code>now()</code> we can obtain <span class="hl-purple"><strong>current date and time</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="fu">now</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-11-02 21:26:28 CET"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>With <code>year()</code>, <code>month()</code> or <code>day()</code> we can <span class="hl-purple"><strong>extract year, month and day</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>date_today <span class="ot">&lt;-</span> <span class="fu">today</span>()</span>
<span id="cb121-2"><a href="#cb121-2"></a><span class="fu">year</span>(date_today)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2024</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="fu">month</span>(date_today)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
</div>
</div>
</section>
<section id="cheatsheets" class="slide level2">
<h2>Cheatsheets</h2>

<img data-src="img/lubridate.png" class="r-stretch"><div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>More information</strong></p>
</div>
<div class="callout-content">
<p>You have a pdf summary of the most important packages in the <span class="hl-green"><strong>corresponding folder on campus</strong></span></p>
</div>
</div>
</div>
</section>
<section id="tu-turno-0-1-2" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-2-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-2-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-2-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-2-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-2-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-2-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<p>📝 Define a variable that stores your age (called <code>age</code>) and another with your name (called <code>name</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>age <span class="ot">&lt;-</span> <span class="dv">34</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>name <span class="ot">&lt;-</span> <span class="st">"Javi"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2">
<p>📝 Check with this variable <code>age</code> if it is NOT 60 years old or if it is called <code>"Ornitorrinco"</code> (you must obtain logical variables as a result).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a>age <span class="sc">!=</span> <span class="dv">60</span> <span class="co"># different to</span></span>
<span id="cb126-2"><a href="#cb126-2"></a>name <span class="sc">==</span> <span class="st">"Ornitorrinco"</span> <span class="co"># equal to</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-3">
<p>📝 Why does the lower code give an error?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>age <span class="sc">+</span> name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in age + name: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4">
<p>📝 Define another variable called <code>siblings</code> that answers the question “do you have siblings?” and another variable that stores your date of birth (called <code>birth_date</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a>siblings <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb129-2"><a href="#cb129-2"></a></span>
<span id="cb129-3"><a href="#cb129-3"></a><span class="fu">library</span>(lubridate) <span class="co"># if not before</span></span>
<span id="cb129-4"><a href="#cb129-4"></a>birth_date <span class="ot">&lt;-</span> <span class="fu">as_date</span>(<span class="st">"1989-09-10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-5">
<p>📝 Define another variable with your last name (called <code>surname</code>) and use <code>glue()</code> to have, in a single variable called <code>full_name</code>, your first and last name separated by a comma.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a>surname <span class="ot">&lt;-</span> <span class="st">"Álvarez Liébana"</span></span>
<span id="cb130-2"><a href="#cb130-2"></a>full_name <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{name}, {surname}"</span>)</span>
<span id="cb130-3"><a href="#cb130-3"></a>full_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-6">
<p>📝 From <code>birth_date</code> extract the month.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="fu">month</span>(birth_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-7">
<p>📝 Calculate the days that have passed since your birth date until today (with the birth date defined in Exercise 4).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="fu">today</span>() <span class="sc">-</span> birth_date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="clase-0-2" class="title-slide slide level1 center">
<h1>L2 : <span class="flow">databases</span></h1>
<p><span style="color:#444442;"><strong>Concatenating cells: vectors. First databases</strong></span></p>
<ul>
<li><p><a href="#/tu-turno-0-2-1">💻 Solved exercises: vectors</a></p></li>
<li><p><a href="#/tu-turno-0-2-2">💻 Solved exercises: matrix</a></p></li>
<li><p><a href="#/tu-turno-0-2-3">💻 Solved exercises: data.frame and tibble</a></p></li>
<li><p><a href="#/caso-practico-0-2-1">🐣 Workbook/case study I-II</a></p></li>
<li><p><a href="#/planificacion">📆 Planning</a></p></li>
</ul>
</section>
<section id="vectors-concatenation" class="slide level2">
<h2>Vectors: concatenation</h2>
<p>When working with data, we often have <span class="hl-yellow"><strong>columns that represent variables</strong></span>: we will refer to these as <span class="hl-yellow"><strong>vectors</strong></span>, which are a <span class="hl-purple"><strong>concatenation</strong></span> of cells (values) of the <span class="hl-purple"><strong>same type</strong></span> (similar to a column in a table).</p>
<div class="fragment">
<p>The simplest way to create a vector is with the <code>c()</code> function (c stands for <strong>concatenate</strong>), and you just need to input the <strong>elements within parentheses, separated by commas</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">27</span>, <span class="dv">60</span>, <span class="dv">61</span>)</span>
<span id="cb133-2"><a href="#cb133-2"></a>ages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32 27 60 61</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Consejo</strong></p>
</div>
<div class="callout-content">
<p>An individual number <code>x &lt;- 1</code> (or <code>x &lt;- c(1)</code>) is actually a <strong>vector of length one</strong> –&gt; everything we know how to <span class="hl-green"><strong>do with a number, we can do with a vector of numbers</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="vectors-concatenation-1" class="slide level2">
<h2>Vectors: concatenation</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/edades_environment.jpg"></p>
</div><div class="column" style="width:60%;">
<p>As you can see now in the <code>environment</code>, we have a <strong>collection of elements</strong> stored.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a>ages <span class="co"># ages = edades in spanish</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32 27 60 61</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>The <span class="hl-yellow"><strong>length of a vector</strong></span> can be calculated with <code>length()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="fu">length</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>We can also <span class="hl-yellow"><strong>concatenate vectors</strong></span> together (it repeats them one after another).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="fu">c</span>(ages, ages, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32 27 60 61 32 27 60 61  8</code></pre>
</div>
</div>
</div>
</section>
<section id="numeric-sequences" class="slide level2">
<h2>Numeric sequences</h2>
<p>The most common type of vector is numeric, specifically, the well-known <span class="hl-yellow"><strong>numeric sequences</strong></span> (e.g., the days of the month), used among other things, to index loops.</p>
<div class="fragment">
<p>The <code>seq(start, end)</code> function allows us to create a [**numeric sequence]**{.hl-yellow} from a starting element to an ending one, <span class="hl-purple"><strong>advancing one by one</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">31</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Note that if we try this with <span class="hl-red"><strong>characters, it won’t work</strong></span> since there is no predefined order among text strings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a><span class="st">"a"</span><span class="sc">:</span><span class="st">"z"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in "a":"z": NA/NaN argument</code></pre>
</div>
</div>
</div>
</section>
<section id="numeric-sequences-1" class="slide level2">
<h2>Numeric sequences</h2>
<p>A shortcut is the <code>1:n</code> command, which returns the same as <code>seq(1, n)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5 6 7</code></pre>
</div>
</div>
<p>If the starting element is greater than the ending one, it understands that the sequence is in <span class="hl-purple"><strong>descending order</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="dv">7</span><span class="sc">:-</span><span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  7  6  5  4  3  2  1  0 -1 -2 -3</code></pre>
</div>
</div>
<div class="fragment">
<p>We can also define <span class="hl-yellow"><strong>a different step</strong></span> between consecutive elements with the <code>by = ...</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="at">by =</span> <span class="fl">0.5</span>) <span class="co"># seq from 1 to 7, with a step of 0.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0</code></pre>
</div>
</div>
</div>
</section>
<section id="numeric-sequences-2" class="slide level2">
<h2>Numeric sequences</h2>
<p>Sometimes we may want to define a <span class="hl-yellow"><strong>sequence with a specific length</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="at">l =</span> <span class="dv">7</span>) <span class="co"># seq from 1 to 50 with length equal to 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.000000  9.166667 17.333333 25.500000 33.666667 41.833333 50.000000</code></pre>
</div>
</div>
<div class="fragment">
<p>We might also want to generate a vector of <span class="hl-yellow"><strong>n repeated elements</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">7</span>) <span class="co"># vector of 7 0's</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 0 0 0 0 0</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Since they are internally stored as numbers, we can also do this with <span class="hl-yellow"><strong>dates</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="fu">seq</span>(<span class="fu">as_date</span>(<span class="st">"2023-09-01"</span>), <span class="fu">as_date</span>(<span class="st">"2023-09-10"</span>), <span class="at">by =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2023-09-01" "2023-09-02" "2023-09-03" "2023-09-04" "2023-09-05"
 [6] "2023-09-06" "2023-09-07" "2023-09-08" "2023-09-09" "2023-09-10"</code></pre>
</div>
</div>
</div>
</section>
<section id="string-vectors" class="slide level2">
<h2>String vectors</h2>
<p>A vector is a <strong>concatenation</strong> of elements of the <span class="hl-yellow"><strong>same type</strong></span>, but they don’t necessarily have to be numbers. Let’s create a sample sentence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a>sentence <span class="ot">&lt;-</span> <span class="st">"My name is Javi"</span></span>
<span id="cb157-2"><a href="#cb157-2"></a>sentence</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "My name is Javi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a><span class="fu">length</span>(sentence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<div class="fragment">
<p>In the previous case, it wasn’t a vector, it was a single text element. To create a vector, we need to use <code>c()</code> again and separate elements with commas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a>sentence <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"My"</span>, <span class="st">"name"</span>, <span class="st">"is"</span>, <span class="st">"Javi"</span>)</span>
<span id="cb161-2"><a href="#cb161-2"></a>sentence</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "My"   "name" "is"   "Javi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a><span class="fu">length</span>(sentence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</div>
</section>
<section id="string-vectors-1" class="slide level2">
<h2>String vectors</h2>
<p>What will happen if we <span class="hl-yellow"><strong>concatenate elements of different types</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"javi"</span>, <span class="st">"3"</span>, <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1"    "2"    "javi" "3"    "TRUE"</code></pre>
</div>
</div>
<p>Note that since all elements must be of the same type, what <code>R</code> does is <span class="hl-yellow"><strong>convert</strong></span> everything to text, violating the <span class="hl-red"><strong>data integrity</strong></span>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4 1 0</code></pre>
</div>
</div>
<p>It’s important to understand that logical values are actually <span class="hl-yellow"><strong>internally stored as 0/1</strong></span>.</p>
</div>
</section>
<section id="operations-with-vectors" class="slide level2">
<h2>Operations with vectors</h2>
<p>With numeric vectors, we can perform the same <span class="hl-yellow"><strong>arithmetic operations</strong></span> as with numbers → a <span class="hl-purple"><strong>number is a vector</strong></span> (of length one).</p>
<div class="fragment">
<p>What will happen if we <span class="hl-yellow"><strong>add or subtract a value</strong></span> to a vector?</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb169-2"><a href="#cb169-2"></a>x <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 4 6 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>x <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  6 10 14</code></pre>
</div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Unless otherwise specified, in <code>R</code>, vector operations are always <span class="hl-orange"><strong>element by element</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="adding-vectors" class="slide level2">
<h2>Adding vectors</h2>
<p>Vectors can also interact with each other, so we can define, for example, <span class="hl-yellow"><strong>vector sums</strong></span> (element by element).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb173-2"><a href="#cb173-2"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb173-3"><a href="#cb173-3"></a>x <span class="sc">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  7 11</code></pre>
</div>
</div>
<div class="fragment">
<p>Since the operation (e.g., a sum) is performed element by element, what will happen if we <span class="hl-yellow"><strong>add two vectors of different lengths</strong></span>?</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb175-2"><a href="#cb175-2"></a>x <span class="sc">+</span> z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  7 11  9</code></pre>
</div>
</div>
<p>What it does is <span class="hl-yellow"><strong>recycle elements</strong></span>: if we have a vector of 4 elements and we add another with 3 elements, it will recycle the elements from the shorter vector.</p>
</div>
</section>
<section id="comparing-vectors" class="slide level2">
<h2>Comparing vectors</h2>
<p>A very common operation is to <span class="hl-yellow"><strong>ask questions of the data</strong></span> using <span class="hl-purple"><strong>logical conditions</strong></span>. For example, if we define a vector of temperatures…</p>
<p><span class="hl-yellow"><strong>Which days were below 22 degrees?</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">31</span>, <span class="dv">27</span>, <span class="dv">15</span>, <span class="dv">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a>x <span class="sc">&lt;</span> <span class="dv">22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE  TRUE FALSE</code></pre>
</div>
</div>
<p>This will return a <span class="hl-yellow"><strong>logical vector</strong></span>, depending on whether <strong>each element</strong> meets the given condition (of the <strong>same length</strong> as the vector being queried).</p>
</div>
<div class="fragment">
<p>If we had a <span class="hl-yellow"><strong>missing value</strong></span> (due to a sensor error that day), the evaluated condition would also be <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="cn">NA</span>, <span class="dv">31</span>, <span class="dv">27</span>, <span class="dv">7</span>, <span class="dv">29</span>, <span class="dv">10</span>)</span>
<span id="cb180-2"><a href="#cb180-2"></a>y <span class="sc">&lt;</span> <span class="dv">22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE    NA FALSE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
</div>
</section>
<section id="comparing-vectors-1" class="slide level2">
<h2>Comparing vectors</h2>
<p><span class="hl-yellow"><strong>Logical conditions can be combined</strong></span> in two ways:</p>
<ul>
<li><span class="hl-yellow"><strong>Intersection</strong></span>: <span class="hl-purple"><strong>all</strong></span> concatenated conditions must be met (<span class="hl-purple"><strong>AND conjunction</strong></span> with <code>&amp;</code>) to return <code>TRUE</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a>x <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> x <span class="sc">&gt;</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE FALSE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<ul>
<li><span class="hl-yellow"><strong>Union</strong></span>: it is enough for <span class="hl-purple"><strong>at least one</strong></span> condition to be met (<span class="hl-purple"><strong>OR conjunction</strong></span> with <code>|</code>).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a>x <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
</div>
</div>
<div class="fragment">
<p>With <code>any()</code> and <code>all()</code>, we can check if <span class="hl-yellow"><strong>all elements</strong></span> satisfy the condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a><span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a><span class="fu">all</span>(x <span class="sc">&lt;</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</div>
</section>
<section id="getting-elements" class="slide level2">
<h2>Getting elements</h2>
<p>Another common operation is <span class="hl-yellow"><strong>accessing or getting elements</strong></span>. The simplest way is to use the <code>[i]</code> operator (access the i-th element).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">33</span>, <span class="cn">NA</span>, <span class="dv">61</span>) </span>
<span id="cb190-2"><a href="#cb190-2"></a>ages[<span class="dv">3</span>] <span class="co"># get the age's third person</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33</code></pre>
</div>
</div>
<div class="fragment">
<p>Since a number is just a vector of length one, this operation can also be applied using a <span class="hl-yellow"><strong>vector of indices to select</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hi"</span>, <span class="st">"how"</span>, <span class="st">"are"</span>, <span class="st">"you"</span>, <span class="st">"?"</span>)</span>
<span id="cb192-2"><a href="#cb192-2"></a>y[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>)] <span class="co"># first, second and fourth element</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hi"  "how" "you"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Consejo</strong></p>
</div>
<div class="callout-content">
<p>To access the last element without worrying about its position, you can pass the vector’s length as the index <code>x[length(x)]</code>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="removing-elements" class="slide level2">
<h2>Removing elements</h2>
<p>Sometimes, instead of selecting, we may want to <span class="hl-yellow"><strong>remove elements</strong></span>. This is done with the same operation but using <span class="hl-purple"><strong>negative indexing</strong></span>: the opetator <code>[-i]</code> «un-select» the i-th element</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hi"  "how" "are" "you" "?"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a>y[<span class="sc">-</span><span class="dv">2</span>] <span class="co"># everything except the second element</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hi"  "are" "you" "?"  </code></pre>
</div>
</div>
<div class="fragment">
<p>In many cases, we want to <span class="hl-yellow"><strong>select or remove elements based on logical conditions</strong></span>, depending on the values, so we will pass the condition itself as the index (remember, <code>x &lt; 2</code> returns a logical vector).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">21</span>, <span class="dv">30</span>, <span class="dv">17</span>, <span class="dv">45</span>)</span>
<span id="cb198-2"><a href="#cb198-2"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"maría"</span>, <span class="st">"sandra"</span>, <span class="st">"carla"</span>, <span class="st">"luis"</span>)</span>
<span id="cb198-3"><a href="#cb198-3"></a>names[ages <span class="sc">&lt;</span> <span class="dv">18</span>] <span class="co"># names of people under 18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "carla"</code></pre>
</div>
</div>
</div>
</section>
<section id="stats-operations" class="slide level2">
<h2>Stats operations</h2>
<p>We can also make use of <span class="hl-yellow"><strong>statistical operations</strong></span>, such as <code>sum()</code>, which, given a vector, returns the sum of all its elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb200-2"><a href="#cb200-2"></a><span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p><span class="hl-yellow"><strong>What happens when a data point is missing?</strong></span></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb202-2"><a href="#cb202-2"></a><span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>By default, if we have a missing data point, the <span class="hl-yellow"><strong>operation will also result in a missing value</strong></span>. To <span class="hl-purple"><strong>ignore that missing data</strong></span>, we use the optional argument <code>na.rm = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1"></a><span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</div>
</section>
<section id="stats-operations-1" class="slide level2">
<h2>Stats operations</h2>
<p>As we’ve mentioned, logical values are internally stored as 0 and 1, so we can use them in arithmetic operations.</p>
<p>For example, if we want to <span class="hl-yellow"><strong>find out the number of elements that meet a condition</strong></span> (e.g., less than 3), those that do will be assigned a 1 (<code>TRUE</code>), and those that don’t will get a 0 (<code>FALSE</code>). Therefore, summing the logical vector will give us the number of elements that meet the condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb206-2"><a href="#cb206-2"></a><span class="fu">sum</span>(x <span class="sc">&lt;</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="stats-operations-2" class="slide level2">
<h2>Stats operations</h2>
<p>Another common operation that can be useful is the <span class="hl-yellow"><strong>cumulative sum</strong></span> with <code>cumsum()</code>, which, given a vector, returns a vector where each element is the sum of the first, the first plus the second, the first plus the second plus the third, and so on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb208-2"><a href="#cb208-2"></a><span class="fu">cumsum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  6  8  7 15</code></pre>
</div>
</div>
<p><span class="hl-yellow"><strong>What happens when a data point is missing?</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb210-2"><a href="#cb210-2"></a><span class="fu">cumsum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1 -1  2 NA NA</code></pre>
</div>
</div>
<p>In the case of the cumulative sum, what happens is that <span class="hl-yellow"><strong>from that point onward, all subsequent accumulated values will be missing</strong></span>.</p>
</section>
<section id="stats-operations-3" class="slide level2">
<h2>Stats operations</h2>
<p>Another common operation that can be useful is the <span class="hl-yellow"><strong>difference (with delay)</strong></span> with <code>diff()</code> which, given a vector, returns a vector with the second minus the first, the third minus the second, the fourth minus the third…and so on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb212-2"><a href="#cb212-2"></a><span class="fu">diff</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7 -3 -2  6 -9 -1  6</code></pre>
</div>
</div>
<div class="fragment">
<p>Using the argument <code>lag =</code> we can indicate the <span class="hl-yellow"><strong>delay</strong></span> of this difference (e.g.&nbsp;<code>lag = 3</code> implies that the fourth minus the first, the fifth minus the second, etc.).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb214-2"><a href="#cb214-2"></a><span class="fu">diff</span>(x, <span class="at">lag =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  1 -5 -4 -4</code></pre>
</div>
</div>
</div>
</section>
<section id="stats-operations-4" class="slide level2">
<h2>Stats operations</h2>
<p>Other common operations are <span class="hl-yellow"><strong>mean</strong></span>, <span class="hl-yellow"><strong>median</strong></span>, <span class="hl-yellow"><strong>percentiles</strong></span>, etc.</p>
<ul>
<li><span class="hl-yellow"><strong>mean</strong></span>: centrality measure that consists of adding all the elements and dividing by the number of elements added. The best known but the <span class="hl-red"><strong>least robust</strong></span>: given a set, if outliers (very large or very small values) are introduced, the mean is very easily perturbed.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">170</span>, <span class="dv">181</span>, <span class="dv">191</span>, <span class="dv">150</span>, <span class="dv">155</span>, <span class="dv">167</span>, <span class="cn">NA</span>, <span class="dv">173</span>, <span class="dv">177</span>)</span>
<span id="cb216-2"><a href="#cb216-2"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 169.8889</code></pre>
</div>
</div>
</section>
<section id="stats-operations-5" class="slide level2">
<h2>Stats operations</h2>
<p>Other common operations are <span class="hl-yellow"><strong>mean</strong></span>, <span class="hl-yellow"><strong>median</strong></span>, <span class="hl-yellow"><strong>percentiles</strong></span>, etc.</p>
<ul>
<li><span class="hl-yellow"><strong>Median</strong></span>: measure of centrality that consists of ordering the elements and keeping the one that occupies the middle.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">165</span>, <span class="dv">170</span>, <span class="dv">181</span>, <span class="dv">191</span>, <span class="dv">150</span>, <span class="dv">155</span>, <span class="dv">167</span>, <span class="dv">173</span>, <span class="dv">177</span>)</span>
<span id="cb218-2"><a href="#cb218-2"></a><span class="fu">median</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 170</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Quantiles</strong></span>: position measurements (they divide the data into equal parts).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1"></a><span class="fu">quantile</span>(x) <span class="co"># by default quantiles/percentiles 0-25-50-75-100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
 150  165  170  177  191 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1"></a><span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  10%   40%   90% 
154.0 167.6 183.0 </code></pre>
</div>
</div>
</div>
</section>
<section id="sorting-vectors" class="slide level2">
<h2>Sorting vectors</h2>
<p>Finally, a common action is to know <span class="hl-yellow"><strong>sort values</strong></span>:</p>
<ul>
<li><code>sort()</code>: returns the <span class="hl-yellow"><strong>sorted vector</strong></span>. By default from smallest to largest but with <code>decreasing = TRUE</code> we can change it.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">81</span>, <span class="dv">7</span>, <span class="dv">25</span>, <span class="dv">41</span>, <span class="dv">65</span>, <span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">23</span>, <span class="dv">77</span>)</span>
<span id="cb224-2"><a href="#cb224-2"></a><span class="fu">sort</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7 20 23 25 33 41 65 77 81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1"></a><span class="fu">sort</span>(ages, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81 77 65 41 33 25 23 20  7</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><code>order()</code>: returns the <span class="hl-yellow"><strong>index vector</strong></span> that we would have to use to have the vector ordered</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1"></a><span class="fu">order</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 6 8 3 7 4 5 9 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1"></a>ages[<span class="fu">order</span>(ages)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7 20 23 25 33 41 65 77 81</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-0-2-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-3-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-3-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-3-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-3-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-3-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-3-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li><li><a href="#tabset-3-8"><span class="hl-yellow"><strong>Exercise 8</strong></span></a></li><li><a href="#tabset-3-9"><span class="hl-yellow"><strong>Exercise 9</strong></span></a></li><li><a href="#tabset-3-10"><span class="hl-yellow"><strong>Exercise 10</strong></span></a></li><li><a href="#tabset-3-11"><span class="hl-yellow"><strong>Exercise 11</strong></span></a></li><li><a href="#tabset-3-12"><span class="hl-yellow"><strong>Exercise 12</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<p>📝 Define the vector <code>x</code> as the concatenation of the first 5 odd numbers. Calculate the length of the vector</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1"></a><span class="co"># Two ways</span></span>
<span id="cb232-2"><a href="#cb232-2"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb232-3"><a href="#cb232-3"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb232-4"><a href="#cb232-4"></a></span>
<span id="cb232-5"><a href="#cb232-5"></a><span class="fu">length</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2">
<p>📝 Access the third element of <code>x</code>. Access the last element (regardless of length, a code that can always be executed). Delete the first element.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1"></a>x[<span class="dv">3</span>]</span>
<span id="cb233-2"><a href="#cb233-2"></a>x[<span class="fu">length</span>(x)]</span>
<span id="cb233-3"><a href="#cb233-3"></a>x[<span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-3">
<p>📝 Get the elements of <code>x</code> greater than 4. Calculate the vector <code>1/x</code> and store it in a variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">4</span>]</span>
<span id="cb234-2"><a href="#cb234-2"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>x</span>
<span id="cb234-3"><a href="#cb234-3"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-4">
<p>📝 Create a vector representing the names of 5 people, one of whom is unknown.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Javi"</span>, <span class="st">"Sandra"</span>, <span class="cn">NA</span>, <span class="st">"Laura"</span>, <span class="st">"Carlos"</span>)</span>
<span id="cb235-2"><a href="#cb235-2"></a>names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-5">
<p>📝 Find from the vector <code>x</code> of exercises above the elements greater (strictly) than 1 and less (strictly) than 7. Find a way to find out if all the elements are positive or not.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">7</span>]</span>
<span id="cb236-2"><a href="#cb236-2"></a><span class="fu">all</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-6">
<p>📝 Given the vector <code>x &lt;- c(1, -5, 8, NA, 10, -3, 9)</code>, why does its mean return not a number but what is shown in the code below?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">8</span>, <span class="cn">NA</span>, <span class="dv">10</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">9</span>)</span>
<span id="cb237-2"><a href="#cb237-2"></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div>
<div id="tabset-3-7">
<p>📝 Given the vector <code>x &lt;- c(1, -5, 8, NA, 10, -3, 9)</code>, extract the elements occupying the locations 1, 2, 5, 6.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">8</span>, <span class="cn">NA</span>, <span class="dv">10</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">9</span>)</span>
<span id="cb239-2"><a href="#cb239-2"></a>x[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</span>
<span id="cb239-3"><a href="#cb239-3"></a>x[<span class="sc">-</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-8">
<p>📝 Given the <code>x</code> vector of the previous exercise, which ones have a missing data? Hint: the <code>is.something()</code> functions check if the element is of type <code>something</code> (press tab).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1"></a><span class="fu">is.na</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-9">
<p>📝 Define the vector <code>x</code> as the concatenation of the first 4 even numbers. Calculate the number of elements of <code>x</code> strictly less than 5.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a>x[x <span class="sc">&lt;</span> <span class="dv">5</span>] </span>
<span id="cb241-2"><a href="#cb241-2"></a><span class="fu">sum</span>(x <span class="sc">&lt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-10">
<p>📝 Calculate the vector <code>1/x</code> and obtain the ordered version (from smallest to largest) in the two possible ways</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>x</span>
<span id="cb242-2"><a href="#cb242-2"></a><span class="fu">sort</span>(z)</span>
<span id="cb242-3"><a href="#cb242-3"></a>z[<span class="fu">order</span>(z)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-11">
<p>📝 Calculate min and max of previous <code>x</code> vector</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a><span class="fu">min</span>(x)</span>
<span id="cb243-2"><a href="#cb243-2"></a><span class="fu">max</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-12">
<p>📝 Find of the vector <code>x</code> the elements greater (strictly) than 1 and less (strictly) than 6. Find a way to find out if all the elements are negative or not.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">7</span>]</span>
<span id="cb244-2"><a href="#cb244-2"></a><span class="fu">all</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="more-with-string-variables" class="slide level2">
<h2>More with string variables</h2>
<p>Although we cannot do arithmetic operations with them, some <span class="hl-yellow"><strong>operations we can do with the text strings</strong></span> will be important.</p>
<p>For that we will use in the future the <code>{stringr}</code> package (within the same <code>{lubridate}</code> “universe of packages”, which we will talk about later).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb245-2"><a href="#cb245-2"></a></span>
<span id="cb245-3"><a href="#cb245-3"></a><span class="co"># Find a correct phone format</span></span>
<span id="cb245-4"><a href="#cb245-4"></a>phone_number <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"611093"</span>, <span class="st">"292039"</span>, <span class="st">"628810585"</span>, <span class="st">"600917043"</span>)</span>
<span id="cb245-5"><a href="#cb245-5"></a><span class="fu">str_detect</span>(phone_number, <span class="at">pattern =</span> <span class="st">"[6]{1}[0-9]{8}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE  TRUE</code></pre>
</div>
</div>
</section>
<section id="first-databases" class="slide level2">
<h2>First databases</h2>
<p>When analyzing data we usually have <span class="hl-yellow"><strong>several variables</strong></span> for each individual: we need a “table” to collect them. The most immediate option is <span class="hl-yellow"><strong>matrices</strong></span>: concatenation of variables of <span class="hl-purple"><strong>same type and equal length</strong></span>.</p>
<p>Imagine we have heights and weights of 4 people. How to <span class="hl-yellow"><strong>create a dataset with the two variables</strong></span>?</p>
<div class="fragment">
<p>The most common option is to use <code>cbind()</code>: <span class="hl-yellow"><strong>concatenate (bind) vectors in the form of columns (c)</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb247" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a>h <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">170</span>, <span class="dv">180</span>)</span>
<span id="cb247-2"><a href="#cb247-2"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">63</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb247-3"><a href="#cb247-3"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(h, w)</span>
<span id="cb247-4"><a href="#cb247-4"></a>data_mat </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       h  w
[1,] 150 63
[2,] 160 70
[3,] 170 85
[4,] 180 95</code></pre>
</div>
</div>
</div>
</section>
<section id="first-databases-1" class="slide level2">
<h2>First databases</h2>
<p>We can also <span class="hl-yellow"><strong>build the matrix by rows</strong></span> with the <code>rbind()</code> function (concatenate - bind - by rows - r), although it is <span class="hl-green"><strong>recommended to have each variable in column</strong></span> and individual in row as we will see later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a><span class="fu">rbind</span>(h, w) <span class="co"># Matrix by rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [,1] [,2] [,3] [,4]
h  150  160  170  180
w   63   70   85   95</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>We can <span class="hl-yellow"><strong>“view” the matrix</strong></span> with <code>View(matrix)</code>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>We can <span class="hl-yellow"><strong>check dimensions</strong></span> with <code>dim()</code>, <code>nrow()</code> and <code>ncol()</code>: matrices are a type of <strong>tabular data</strong> (organized in rows and columns).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1"></a><span class="fu">dim</span>(data_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1"></a><span class="fu">nrow</span>(data_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1"></a><span class="fu">ncol</span>(data_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
</div>
</section>
<section id="first-databases-2" class="slide level2">
<h2>First databases</h2>
<p>We can also <span class="hl-yellow"><strong>“flip” (transposed matrix)</strong></span> with <code>t()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1"></a><span class="fu">t</span>(data_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [,1] [,2] [,3] [,4]
h  150  160  170  180
w   63   70   85   95</code></pre>
</div>
</div>
<div class="fragment">
<p>Since we now have two dimensions in our data, to <span class="hl-yellow"><strong>access elements with <code>[]</code></strong></span> we must provide <strong>two comma-separated indexes</strong>: row and column indexes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a>data_mat[<span class="dv">2</span>, <span class="dv">1</span>] <span class="co"># second row, first column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  h 
160 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1"></a>data_mat[<span class="dv">1</span>, <span class="dv">2</span>] <span class="co"># first row, second column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> w 
63 </code></pre>
</div>
</div>
</div>
</section>
<section id="first-databases-3" class="slide level2">
<h2>First databases</h2>
<p>In some cases we will want to get the <span class="hl-yellow"><strong>total data for an individual</strong></span> (a particular row but all columns) or the values of <span class="hl-yellow"><strong>a whole variable</strong></span> for all individuals (a particular column but all rows). To do so, we leave <span class="hl-yellow"><strong>one of the indexes</strong></span> unfilled.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1"></a>data_mat[<span class="dv">2</span>, ] <span class="co"># second individual</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  h   w 
160  70 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1"></a>data_mat[, <span class="dv">1</span>] <span class="co"># first variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150 160 170 180</code></pre>
</div>
</div>
<div class="fragment">
<p>Much of what we have learned with vectors we can do with matrices, so we can for example access multiple rows and/or columns using the <span class="hl-yellow"><strong>sequences of integers 1:n</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1"></a>data_mat[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dv">1</span>] <span class="co"># first variable for first and third individual</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150 170</code></pre>
</div>
</div>
</div>
</section>
<section id="first-databases-4" class="slide level2">
<h2>First databases</h2>
<p>We can also define a <span class="hl-yellow"><strong>matrix from a numeric vector</strong></span>, rearranging the values in the form of a matrix (knowing that the elements are <span class="hl-purple"><strong>placed by columns</strong></span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1"></a>z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">ncol =</span> <span class="dv">3</span>) </span>
<span id="cb269-2"><a href="#cb269-2"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9</code></pre>
</div>
</div>
<div class="fragment">
<p>We can even <span class="hl-yellow"><strong>define an array of constant values</strong></span>, e.g.&nbsp;of zeros (to be filled later)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1"></a><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    0    0    0
[2,]    0    0    0</code></pre>
</div>
</div>
</div>
</section>
<section id="matrix-operations" class="slide level2">
<h2>Matrix operations</h2>
<p>With matrices it is the same as with vectors: when we apply an <span class="hl-yellow"><strong>arithmetic operation we do it element by element</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1"></a>z<span class="sc">/</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  0.2  0.8  1.4
[2,]  0.4  1.0  1.6
[3,]  0.6  1.2  1.8</code></pre>
</div>
</div>
<div class="fragment">
<p>To perform <span class="hl-yellow"><strong>operations in a matrix sense</strong></span> we must add <code>%%%</code>, for example, to multiply matrices it will be <code>%*%</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1"></a>z <span class="sc">*</span> <span class="fu">t</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    8   21
[2,]    8   25   48
[3,]   21   48   81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1"></a>z <span class="sc">%*%</span> <span class="fu">t</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   66   78   90
[2,]   78   93  108
[3,]   90  108  126</code></pre>
</div>
</div>
</div>
</section>
<section id="matrix-operations-1" class="slide level2">
<h2>Matrix operations</h2>
<p>We can also <span class="hl-yellow"><strong>perform operations by columns/rows</strong></span> without loops with the <code>apply()</code> function, and we will indicate as <strong>arguments</strong></p>
<ul>
<li>the matrix</li>
<li>the sense of the operation (<code>MARGIN = 1</code> for rows, <code>MARGIN = 2</code> for columns)</li>
<li>the function to apply</li>
<li>extra arguments needed by the function</li>
</ul>
<div class="fragment">
<p>For example, to apply an average to each variable, it will be <code>mean</code> applied with <code>MARGIN = 2</code> (same function for each column).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1"></a><span class="co"># Mean for each column (MARGIN = 2)</span></span>
<span id="cb279-2"><a href="#cb279-2"></a><span class="fu">apply</span>(data_mat, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     h      w 
165.00  78.25 </code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-0-2-2" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-4-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-4-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-4-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-4-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-4-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<p>📝 Modify the code below to define an <code>x</code> matrix of ones, with 3 rows and 7 columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb281-2"><a href="#cb281-2"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">7</span>)</span>
<span id="cb282-2"><a href="#cb282-2"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2">
<p>📝 To the above matrix, add 1 to each number in the matrix and divide the result by 5. Then calculate its transpose</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1"></a>new_matrix <span class="ot">&lt;-</span> (x <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb283-2"><a href="#cb283-2"></a><span class="fu">t</span>(new_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-3">
<p>📝 Why does the code below return such a warning message?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1"></a><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in matrix(1:15, nrow = 4): data length [15] is not a sub-multiple or
multiple of the number of rows [4]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    5    9   13
[2,]    2    6   10   14
[3,]    3    7   11   15
[4,]    4    8   12    1</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4">
<p>📝 Define the matrix <code>x &lt;- matrix(1:12, nrow = 4)</code>. Then get the data of the first individual, the data of the third variable, and the element <code>(4, 1)</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb287-2"><a href="#cb287-2"></a>x[<span class="dv">1</span>, ] <span class="co"># first row</span></span>
<span id="cb287-3"><a href="#cb287-3"></a>x[, <span class="dv">3</span>] <span class="co"># third column</span></span>
<span id="cb287-4"><a href="#cb287-4"></a>x[<span class="dv">4</span>, <span class="dv">1</span>] <span class="co"># (4, 1) element</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-5">
<p>📝 Define a matrix of 2 variables and 3 individuals such that each variable captures the height and age of 3 persons, so that the age of the second person is unknown (absent). Then calculate the mean of each variable (we should get a number!).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"age"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="cn">NA</span>, <span class="dv">25</span>), <span class="st">"h"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">160</span>, <span class="dv">165</span>, <span class="dv">170</span>))</span>
<span id="cb288-2"><a href="#cb288-2"></a><span class="fu">apply</span>(data, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="st">"mean"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># mean by columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-6">
<p>📝 Why does the lower code return an error? What is wrong?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"age"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>), <span class="st">"names"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"sandra"</span>, <span class="st">"carlos"</span>))</span>
<span id="cb289-2"><a href="#cb289-2"></a>mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     age  names   
[1,] "15" "javi"  
[2,] "20" "sandra"
[3,] "25" "carlos"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1"></a>mat <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in mat + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="second-attempt-data.frame" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p>Arrays have the same problem as vectors: if we put together data of different types, it <span class="hl-red"><strong>data integrity is compromised</strong></span> as it converts them (see the code below: the ages and the <code>TRUE/FALSE</code> are converted to text).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb293" data-code-line-numbers="4-5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">24</span>, <span class="cn">NA</span>)</span>
<span id="cb293-2"><a href="#cb293-2"></a>single <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">NA</span>, <span class="cn">FALSE</span>)</span>
<span id="cb293-3"><a href="#cb293-3"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"laura"</span>, <span class="st">"lucía"</span>)</span>
<span id="cb293-4"><a href="#cb293-4"></a>mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ages, single, names)</span>
<span id="cb293-5"><a href="#cb293-5"></a>mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ages single  names  
[1,] "14" "TRUE"  "javi" 
[2,] "24" NA      "laura"
[3,] NA   "FALSE" "lucía"</code></pre>
</div>
</div>
<div class="fragment">
<p>In fact, since they are not numbers, we can no longer perform arithmetic operations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1"></a>mat <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in mat + 1: non-numeric argument to binary operator</code></pre>
</div>
</div>
</div>
</section>
<section id="second-attempt-data.frame-1" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p>In order to work with <span class="hl-yellow"><strong>variables of different type</strong></span> we have in <code>R</code> what is known as <span class="hl-yellow"><strong>data.frame</strong></span>: concatenation of variables of equal length but which can be of <span class="hl-purple"><strong>different type</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ages, single, names)</span>
<span id="cb297-2"><a href="#cb297-2"></a><span class="fu">class</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ages single names
1   14   TRUE  javi
2   24     NA laura
3   NA  FALSE lucía</code></pre>
</div>
</div>
</section>
<section id="second-attempt-data.frame-2" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p>Since a <code>data.frame</code> is already an attempt at a <code>database</code> the variables are not mere mathematical vectors: <span class="hl-yellow"><strong>they have a meaning</strong></span> and we can (we must) <span class="hl-purple"><strong>give them names</strong></span> that describe their meaning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb301-2"><a href="#cb301-2"></a>table <span class="ot">&lt;-</span></span>
<span id="cb301-3"><a href="#cb301-3"></a>  <span class="fu">data.frame</span>(<span class="st">"ages"</span> <span class="ot">=</span> ages, <span class="st">"single"</span> <span class="ot">=</span> single, <span class="st">"names"</span> <span class="ot">=</span> names,</span>
<span id="cb301-4"><a href="#cb301-4"></a>             <span class="st">"birth_date"</span> <span class="ot">=</span> <span class="fu">as_date</span>(<span class="fu">c</span>(<span class="st">"1989-09-10"</span>, <span class="st">"1992-04-01"</span>, <span class="st">"1980-11-27"</span>)))</span>
<span id="cb301-5"><a href="#cb301-5"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ages single names birth_date
1   14   TRUE  javi 1989-09-10
2   24     NA laura 1992-04-01
3   NA  FALSE lucía 1980-11-27</code></pre>
</div>
</div>
</section>
<section id="second-attempt-data.frame-3" class="slide level2">
<h2>Second attempt: data.frame</h2>
<p><span class="hl-yellow"><strong>We have our first data set!</strong></span> (strictly speaking we can’t talk about a database but for the moment it looks like one). You can visualize it by typing its name in console or with <code>View(table)</code>.</p>

<img data-src="img/view_tabla.jpg" class="r-stretch"></section>
<section id="get-variables" class="slide level2">
<h2>Get variables</h2>
<p>If we want to access its elements, being again <strong>tabulated data</strong>, we can access as in the matrices (<span class="hl-red"><strong>not recommended</strong></span>): again <span class="hl-yellow"><strong>we have two indexes</strong></span> (rows and columns, leaving free the one we don’t use)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1"></a>table[<span class="dv">2</span>, ]  <span class="co"># second row (all variables)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ages single names birth_date
2   24     NA laura 1992-04-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1"></a>table[, <span class="dv">3</span>]  <span class="co"># third column (all individuals)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "laura" "lucía"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1"></a>table[<span class="dv">2</span>, <span class="dv">1</span>] <span class="co"># first variable of the second individual</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:25%;">
<p><img data-src="img/menu_data_frame.jpg"></p>
</div><div class="column" style="width:75%;">
<p>But it also has the advantages of a <span class="hl-yellow"><strong>database</strong></span> : we can <span class="hl-purple"><strong>access the variables by name</strong></span> (<span class="hl-green"><strong>recommended</strong></span> since the variables can change position and now they have a meaning), putting the name of the table followed by the symbol <code>$</code> (with the <strong>tab</strong>, a menu of columns to choose from will appear).</p>
</div>
</div>
</div>
</section>
<section id="ask-functions" class="slide level2">
<h2>Ask functions</h2>
<ul>
<li><code>names()</code>: shows us the variable names</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1"></a><span class="fu">names</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ages"       "single"     "names"      "birth_date"</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><code>dim()</code>: shows dimensions (also <code>nrow()</code> and <code>ncol()</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1"></a><span class="fu">dim</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Variables can be accessed by name</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1"></a>table[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="st">"names"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "lucía"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1"></a>table<span class="sc">$</span>names[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "javi"  "lucía"</code></pre>
</div>
</div>
</div>
</section>
<section id="add-a-variable" class="slide level2">
<h2>Add a variable</h2>
<p>If we have one already created and we want to <span class="hl-yellow"><strong>add a column</strong></span> it is as simple as using the <code>data.frame()</code> function we have already seen to concatenate the column. Let’s add for example a new variable, the number of siblings of each individual.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1"></a><span class="co"># add a new column</span></span>
<span id="cb317-2"><a href="#cb317-2"></a>siblings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb317-3"><a href="#cb317-3"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(table, <span class="st">"n_sib"</span> <span class="ot">=</span> siblings)</span>
<span id="cb317-4"><a href="#cb317-4"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ages single names birth_date n_sib
1   14   TRUE  javi 1989-09-10     0
2   24     NA laura 1992-04-01     2
3   NA  FALSE lucía 1980-11-27     3</code></pre>
</div>
</div>
</section>
<section id="last-attempt-tibble" class="slide level2">
<h2>Last attempt: tibble</h2>
<p>Tables in <code>data.frame</code> format have some <span class="hl-red"><strong>limitations</strong></span>. The main one is that <span class="hl-red"><strong>does not allow recursion</strong></span>: imagine that we define a database with heights and weights, and we want a third variable with the BMI.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1"></a><span class="fu">data.frame</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb319-2"><a href="#cb319-2"></a>           <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(height = c(1.7, 1.8, 1.6), weight = c(80, 75, 70), : object 'weight' not found</code></pre>
</div>
</div>
<div class="fragment">
<p>Hereafter we will use the <code>tibble</code> (<span class="hl-yellow"><strong>enhanced data.frame</strong></span>) format from the <code>{tibble}</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb321-2"><a href="#cb321-2"></a>data_tb <span class="ot">&lt;-</span> </span>
<span id="cb321-3"><a href="#cb321-3"></a>  <span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>), <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb321-4"><a href="#cb321-4"></a><span class="fu">class</span>(data_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1"></a>data_tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  height weight   BMI
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1    1.7     80  27.7
2    1.8     75  23.1
3    1.6     70  27.3</code></pre>
</div>
</div>
</div>
</section>
<section id="last-attempt-tibble-1" class="slide level2">
<h2>Last attempt: tibble</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1"></a>data_tb <span class="ot">&lt;-</span> </span>
<span id="cb325-2"><a href="#cb325-2"></a>  <span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>), <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb325-3"><a href="#cb325-3"></a><span class="fu">class</span>(data_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1"></a>data_tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  height weight   BMI
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1    1.7     80  27.7
2    1.8     75  23.1
3    1.6     70  27.3</code></pre>
</div>
</div>
<p>Las tablas en formato <code>tibble</code> nos permitirá una <span class="hl-yellow"><strong>gestión más ágil, eficiente y coherente</strong></span> de los data, con 4 ventajas principales:</p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Metainformation</strong></span>: if you look at the header, it automatically tells us the number of rows and columns, and the type of each variable</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Recursivity</strong></span>: allows you to define the variables sequentially (as we have seen)</li>
</ul>
</div>
</section>
<section id="data-pasta" class="slide level2">
<h2>Last attempt: tibble</h2>
<ul>
<li><span class="hl-yellow"><strong>Consistency</strong></span>: if you access a column that does not exist, it warns you with a warning</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1"></a>data_tb<span class="sc">$</span>invent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `invent`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>By rows</strong></span>: create by rows (copy and paste from a table) with <code>tribble()</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1"></a><span class="fu">tribble</span>(<span class="sc">~</span>colA, <span class="sc">~</span>colB,</span>
<span id="cb332-2"><a href="#cb332-2"></a>        <span class="st">"a"</span>,   <span class="dv">1</span>,</span>
<span id="cb332-3"><a href="#cb332-3"></a>        <span class="st">"b"</span>,   <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  colA   colB
  &lt;chr&gt; &lt;dbl&gt;
1 a         1
2 b         2</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Consejo</strong></p>
</div>
<div class="callout-content">
<p>The <code>{datapasta}</code> package allows us to <span class="hl-green"><strong>copy and paste</strong></span> tables from web pages and simple documents as a tribble. See more in <a href="https://milesmcbain.github.io/datapasta/articles/how-to-datapasta.html#pasting-a-table-as-a-formatted-tibble-definition-with-tribble_paste" class="uri">https://milesmcbain.github.io/datapasta/articles/how-to-datapasta.html#pasting-a-table-as-a-formatted-tibble-definition-with-tribble_paste</a></p>
</div>
</div>
</div>
</div>
</section>
<section id="in-summary" class="slide level2">
<h2>In summary…</h2>
<ul>
<li>Each <span class="hl-yellow"><strong>cell can be of a different type</strong></span>: numbers, text, dates, logical values, etc. A [<strong>vector is a concatenation of cells</strong>]{. hl-yellow} (the future columns of our tables) –&gt; In <code>R</code> by default operations are done <span class="hl-yellow"><strong>element to element</strong></span>.</li>
</ul>
<div class="fragment">
<ul>
<li>A <span class="hl-yellow"><strong>matrix</strong></span> allows us to concatenate <span class="hl-yellow"><strong>variables of the SAME type and SAME length</strong></span> –&gt; tabular data.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>A <span class="hl-yellow"><strong>data.frame</strong></span> allows us to concatenate <span class="hl-yellow"><strong>variables of DIFFERENT type and SAME length</strong></span> –&gt; we will use <span class="hl-yellow"><strong>tibble</strong></span> as an enhanced database option.</li>
</ul>
</div>
</section>
<section id="tu-turno-0-2-3" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-5-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-5-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-5-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-5-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-5-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-5-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li><li><a href="#tabset-5-8"><span class="hl-yellow"><strong>Exercise 8</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<p>📝 Load from the <code>{datasets}</code> package the <code>airquality</code> dataset (New York air quality variables from May through September 1973). Is the airquality dataset of type tibble? If not, convert it to tibble (look in the package documentation at <a href="https://tibble.tidyverse.org/index.html" class="uri">https://tibble.tidyverse.org/index.html</a>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb334-2"><a href="#cb334-2"></a><span class="fu">class</span>(datasets<span class="sc">::</span>airquality)</span>
<span id="cb334-3"><a href="#cb334-3"></a>airquality_tb <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(datasets<span class="sc">::</span>airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2">
<p>📝 Once converted to <code>tibble</code> get the name of the variables and the dimensions of the data set. How many variables are there? How many days have been measured?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1"></a><span class="fu">names</span>(airquality_tb)</span>
<span id="cb335-2"><a href="#cb335-2"></a><span class="fu">ncol</span>(airquality_tb)</span>
<span id="cb335-3"><a href="#cb335-3"></a><span class="fu">nrow</span>(airquality_tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-3">
<p>📝 Filters only the data of the fifth observation</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1"></a>airquality_tb[<span class="dv">5</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-4">
<p>📝 Filter only the data for the month of August. How to tell it that we want only the rows that meet a specific condition?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1"></a>airquality_tb[airquality_tb<span class="sc">$</span>Month <span class="sc">==</span> <span class="dv">8</span>, ]</span>
<span id="cb337-2"><a href="#cb337-2"></a></span>
<span id="cb337-3"><a href="#cb337-3"></a><span class="co"># other way</span></span>
<span id="cb337-4"><a href="#cb337-4"></a>var_month <span class="ot">&lt;-</span> airquality_tb<span class="sc">$</span>Month</span>
<span id="cb337-5"><a href="#cb337-5"></a>airquality_tb[var_month <span class="sc">==</span> <span class="dv">8</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-5">
<p>📝 Select those data that are not from July or August.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1"></a>airquality_tb[airquality_tb<span class="sc">$</span>Month <span class="sc">!=</span> <span class="dv">7</span> <span class="sc">&amp;</span> airquality_tb<span class="sc">$</span>Month <span class="sc">!=</span> <span class="dv">8</span>, ]</span>
<span id="cb338-2"><a href="#cb338-2"></a>airquality_tb[<span class="sc">!</span>(airquality_tb<span class="sc">$</span>Month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-6">
<p>📝 Modify the following code to keep only the ozone and temperature variables (no matter what position they are).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1"></a>airquality_tb[, <span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-7">
<p>📝 Select the temperature and wind data for August.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1"></a>airquality_tb[airquality_tb<span class="sc">$</span>Month <span class="sc">==</span> <span class="dv">8</span>, <span class="fu">c</span>(<span class="st">"Temp"</span>, <span class="st">"Wind"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-8">
<p>📝 Translate the name of the variables into your native language.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1"></a><span class="fu">names</span>(airquality_tb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ozono"</span>, <span class="st">"rad_solar"</span>, <span class="st">"viento"</span>, <span class="st">"temp"</span>, <span class="st">"mes"</span>, <span class="st">"dia"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-0-2-1" class="slide level2">
<h2>🐣 Case study I</h2>
<p>In the <code>{datasets}</code> package (already installed by default) we have several datasets and one of them is <code>airquality</code>. Below I have extracted 3 variables from that dataset (note that it is done with <code>data$variable</code>, that dollar will be important in the future).The data captures <span class="hl-yellow"><strong>daily measurements (n = 153 observations) of air quality</strong></span> in New York, from May to September 1973. Six <strong>6 variables</strong> were measured: ozone levels, solar radiation, wind, temperature, month and day.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb342-2"><a href="#cb342-2"></a>temperature <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Temp</span>
<span id="cb342-3"><a href="#cb342-3"></a>month <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Month</span>
<span id="cb342-4"><a href="#cb342-4"></a>day <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/intro-r-base-tibbles-mucss/"><strong>workbook</strong></a></p>
</section>
<section id="caso-practico-0-2-2" class="slide level2">
<h2>🐣 Case study II</h2>
<p>We will consider the <code>surveys.RData</code> file in which we have all poll surveys for Spain from 1982 to 2019.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"./data/surveys.RData"</span>)</span>
<span id="cb343-2"><a href="#cb343-2"></a>survey_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 139,944 × 8
   date_elec  pollster field_date_from field_date_to exit_poll  size party  
   &lt;date&gt;     &lt;chr&gt;    &lt;date&gt;          &lt;date&gt;        &lt;lgl&gt;     &lt;dbl&gt; &lt;chr&gt;  
 1 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 UCD    
 2 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 PSOE   
 3 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 PCE    
 4 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 AP     
 5 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 CIU    
 6 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 PA     
 7 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 EAJ-PNV
 8 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 HB     
 9 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 ERC    
10 1982-10-28 PSOE     1982-10-28      1982-10-28    TRUE      85300 EE     
# ℹ 139,934 more rows
# ℹ 1 more variable: estimation &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/intro-r-base-tibbles-mucss/"><strong>workbook</strong></a></p>
</section></section>
<section>
<section id="clase-0-3" class="title-slide slide level1 center">
<h1>L3: <span class="flow">if-else and Quarto</span></h1>
<p><span style="color:#444442;"><strong>Flow structures: if-else and loops. Functions in R. Quarto</strong></span></p>
<ul>
<li><p><a href="#/tu-turno-0-3-1">💻 Solved exercises: if-else</a></p></li>
<li><p><a href="#/tu-turno-0-3-2">💻 Solved exercises: loops</a></p></li>
<li><p><a href="#/tu-turno-0-3-3">💻 Solved exercises: functions</a></p></li>
<li><p><a href="#/caso-practico-0-3-1">🐣 Workbook/case study I-II-III</a></p></li>
<li><p><a href="#/planificacion">📆 Planning</a></p></li>
</ul>
</section>
<section id="flow-structures" class="slide level2">
<h2>Flow structures</h2>
<p>A <span class="hl-yellow"><strong>flow or control structure</strong></span> consists of a series of commands oriented to <span class="hl-yellow"><strong>decide the path</strong></span> that your code must follow</p>
<ul>
<li><p>If condition A is met, what happens?</p></li>
<li><p>What if B happens?</p></li>
<li><p>How can I repeat the same expression (depending on a variable)?</p></li>
</ul>
<div class="fragment">
<p>If you have programmed before, you may be familiar with what are known as <span class="hl-yellow"><strong>conditional structures</strong></span> such as <code>if (bla bla) {...} else {...}</code> or <span class="hl-yellow"><strong>loops</strong></span> <code>for/while</code> (to be avoided whenever possible).</p>
</div>
</section>
<section id="if" class="slide level2">
<h2>If</h2>
<p>One of the most famous control structures are those known as <span class="hl-yellow"><strong>conditional structures</strong></span> <code>if</code>.</p>
<blockquote>
<p>IF a set of conditions is met (TRUE), then execute whatever is inside the curly brackets.</p>
</blockquote>
<p>For example, the structure <code>if (x == 1) { code A }</code> what it will do is <span class="hl-yellow"><strong>execute code A in braces</strong></span> but <span class="hl-purple"><strong>ONLY IF</strong></span> the <span class="hl-purple"><strong>condition in brackets is true</strong></span> (only if <code>x</code> is 1). In any other case, it will do nothing</p>
<div class="fragment">
<p>For example, let’s define a vector of ages of 8 people</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">24</span>, <span class="dv">56</span>, <span class="dv">31</span>, <span class="dv">20</span>, <span class="dv">87</span>, <span class="dv">73</span>)</span>
<span id="cb345-2"><a href="#cb345-2"></a>ages <span class="sc">&lt;</span> <span class="dv">18</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
</div>
</section>
<section id="if-1" class="slide level2">
<h2>If</h2>
<p>Our conditional structure will do the following: <span class="hl-yellow"><strong>if there is a minor, it will print</strong></span> a message.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1"></a><span class="cf">if</span> (<span class="fu">any</span>(ages <span class="sc">&lt;</span> <span class="dv">18</span>)) { </span>
<span id="cb347-2"><a href="#cb347-2"></a>  </span>
<span id="cb347-3"><a href="#cb347-3"></a>  <span class="fu">print</span>(<span class="st">"There is a minor"</span>)</span>
<span id="cb347-4"><a href="#cb347-4"></a>  </span>
<span id="cb347-5"><a href="#cb347-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "There is a minor"</code></pre>
</div>
</div>
</section>
<section id="if-2" class="slide level2">
<h2>If</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1"></a><span class="cf">if</span> (<span class="fu">any</span>(ages <span class="sc">&lt;</span> <span class="dv">18</span>)) { </span>
<span id="cb349-2"><a href="#cb349-2"></a>  </span>
<span id="cb349-3"><a href="#cb349-3"></a>  <span class="fu">print</span>(<span class="st">"There is a minor"</span>)</span>
<span id="cb349-4"><a href="#cb349-4"></a>  </span>
<span id="cb349-5"><a href="#cb349-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In case the <span class="hl-yellow"><strong>conditions are not true</strong></span> inside <code>if()</code> (<code>FALSE</code>), nothing happens.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ages <span class="sc">&gt;=</span> <span class="dv">18</span>)) { </span>
<span id="cb350-2"><a href="#cb350-2"></a>  </span>
<span id="cb350-3"><a href="#cb350-3"></a>  <span class="fu">print</span>(<span class="st">"All of them are of legal age"</span>)</span>
<span id="cb350-4"><a href="#cb350-4"></a>  </span>
<span id="cb350-5"><a href="#cb350-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>We get no message</strong> because the condition <code>all(ages &gt;= 18)</code> is not <code>TRUE</code>, so it does not execute anything.</p>
</section>
<section id="if-else" class="slide level2">
<h2>If-else</h2>
<p>The structure <code>if (condition) { code A }</code> can be combined with an <code>else { code B }</code>: when the <span class="hl-yellow"><strong>condition is not checked</strong></span>, it will [<strong>execute the alternative code B</strong>]{. hl-yellow} inside <code>else { }</code>, allowing us to decide what happens when it is satisfied and when it is not</p>
<div class="fragment">
<p>For example, <code>if (x == 1) { code A } else { code B }</code> will execute A if <code>x</code> is equal to 1 and B in any other case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ages <span class="sc">&gt;=</span> <span class="dv">18</span>)) { </span>
<span id="cb351-2"><a href="#cb351-2"></a>  </span>
<span id="cb351-3"><a href="#cb351-3"></a>  <span class="fu">print</span>(<span class="st">"All of them are of legal age"</span>)</span>
<span id="cb351-4"><a href="#cb351-4"></a>  </span>
<span id="cb351-5"><a href="#cb351-5"></a>} <span class="cf">else</span> {</span>
<span id="cb351-6"><a href="#cb351-6"></a>  </span>
<span id="cb351-7"><a href="#cb351-7"></a>  <span class="fu">print</span>(<span class="st">"There is a minor"</span>)</span>
<span id="cb351-8"><a href="#cb351-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "There is a minor"</code></pre>
</div>
</div>
</div>
</section>
<section id="if-else-1" class="slide level2">
<h2>If-else</h2>
<p>Esta estructura <code>if - else</code> puede ser <span class="hl-yellow"><strong>anidada</strong></span>: imagina que queremos ejecutar un código si todos son menores; si no sucede, pero todos son mayores de 16, hacer otra cosa; en cualquier otra cosa, otra acción.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ages <span class="sc">&gt;=</span> <span class="dv">18</span>)) { </span>
<span id="cb353-2"><a href="#cb353-2"></a>  </span>
<span id="cb353-3"><a href="#cb353-3"></a>  <span class="fu">print</span>(<span class="st">"All of them are of legal age"</span>)</span>
<span id="cb353-4"><a href="#cb353-4"></a>  </span>
<span id="cb353-5"><a href="#cb353-5"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">all</span>(ages <span class="sc">&gt;=</span> <span class="dv">16</span>)) {</span>
<span id="cb353-6"><a href="#cb353-6"></a>  </span>
<span id="cb353-7"><a href="#cb353-7"></a>  <span class="fu">print</span>(<span class="st">"There is a minor but all of them are greater or equal to 16 years old"</span>)</span>
<span id="cb353-8"><a href="#cb353-8"></a>  </span>
<span id="cb353-9"><a href="#cb353-9"></a>} <span class="cf">else</span> { <span class="fu">print</span>(<span class="st">"There are any persons under 16 years of age"</span>) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "There are any persons under 16 years of age"</code></pre>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>You can <strong>collapse the structures</strong> by clicking on the left arrow in your script.</p>
</div>
</div>
</div>
</section>
<section id="if-else-vectorized" class="slide level2">
<h2>If-else vectorized</h2>
<p>This conditional structure can be <span class="hl-yellow"><strong>vectorized</strong></span> (in a single line) with <code>if_else()</code> (from the <code>{dplyr}</code> package), whose arguments are</p>
<ul>
<li><p>the condition to evaluate</p></li>
<li><p>what happens when it is met and when not</p></li>
<li><p>an optional argument for when the condition to evaluate is <code>NA</code></p></li>
</ul>
<p>We will label without are greater/lesser and an <code>unknown</code> when we don’t know.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb355-2"><a href="#cb355-2"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, ages)</span>
<span id="cb355-3"><a href="#cb355-3"></a><span class="fu">if_else</span>(ages <span class="sc">&gt;=</span> <span class="dv">18</span>, <span class="st">"legal age"</span>, <span class="st">"minor"</span>, <span class="at">missing =</span> <span class="st">"unknown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "unknown"   "minor"     "minor"     "legal age" "legal age" "legal age"
[7] "legal age" "legal age" "legal age"</code></pre>
</div>
</div>
<p>In <code>R</code> base there is <code>ifelse()</code>: it does not let you specify what to do with the absent ones but allows you to specify different types of data in <code>TRUE</code> and <code>FALSE</code>.</p>
</section>
<section id="tu-turno-0-3-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-6-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-6-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-6-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-6-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-6-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<p>📝 What will be the output of the following code?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1"></a><span class="fu">if_else</span>(<span class="fu">sqrt</span>(<span class="dv">9</span>) <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">9</span>), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1"></a>The output is <span class="dv">0</span> since <span class="fu">sqrt</span>(<span class="dv">9</span>) equals <span class="dv">3</span>, and since it is not less than <span class="dv">2</span>, it returns the second argument which is <span class="fl">0.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2">
<p>📝 What will be the output of the following code?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb359-2"><a href="#cb359-2"></a><span class="fu">if_else</span>(<span class="fu">sqrt</span>(x) <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1"></a>The output is the vector <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">1</span>) since <span class="fu">sqrt</span>(<span class="dv">1</span>) is less than <span class="dv">2</span>, <span class="fu">sqrt</span>(<span class="dv">9</span>) is not, and <span class="cf">in</span> the case of both <span class="fu">sqrt</span>(<span class="cn">NA</span>) (root of absent) and <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">1</span>) (returns <span class="cn">NaN</span>, not a number), its square root cannot be checked whether it is less than <span class="dv">2</span> or not, so the output is NA.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-3">
<p>📝 Modify the code below so that, when the square root of a number cannot be verified to be less than 2, it returns -1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb361-2"><a href="#cb361-2"></a><span class="fu">if_else</span>(<span class="fu">sqrt</span>(x) <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb362-2"><a href="#cb362-2"></a><span class="fu">if_else</span>(<span class="fu">sqrt</span>(x) <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">missing =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-4">
<p>📝 What are the values of <code>x</code> and <code>y</code> of the lower code for <code>z &lt;- 1</code>, <code>z &lt;- -1</code> and <code>z &lt;- -5</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1"></a>z <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb363-2"><a href="#cb363-2"></a><span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb363-3"><a href="#cb363-3"></a>  </span>
<span id="cb363-4"><a href="#cb363-4"></a>  x <span class="ot">&lt;-</span> z<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb363-5"><a href="#cb363-5"></a>  y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sqrt</span>(z)</span>
<span id="cb363-6"><a href="#cb363-6"></a>  </span>
<span id="cb363-7"><a href="#cb363-7"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(z) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb363-8"><a href="#cb363-8"></a>  </span>
<span id="cb363-9"><a href="#cb363-9"></a>  x <span class="ot">&lt;-</span> z<span class="sc">^</span><span class="dv">4</span></span>
<span id="cb363-10"><a href="#cb363-10"></a>  y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span>z)</span>
<span id="cb363-11"><a href="#cb363-11"></a>  </span>
<span id="cb363-12"><a href="#cb363-12"></a>} <span class="cf">else</span> {</span>
<span id="cb363-13"><a href="#cb363-13"></a>  </span>
<span id="cb363-14"><a href="#cb363-14"></a>  x <span class="ot">&lt;-</span> z<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb363-15"><a href="#cb363-15"></a>  y <span class="ot">&lt;-</span> <span class="fu">abs</span>(z)</span>
<span id="cb363-16"><a href="#cb363-16"></a>  </span>
<span id="cb363-17"><a href="#cb363-17"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1"></a>In the first case x <span class="ot">=</span> <span class="dv">1</span> and y <span class="ot">=</span> <span class="sc">-</span><span class="fl">1.</span> In the second case x <span class="ot">=</span> <span class="dv">1</span> and y <span class="ot">=</span> <span class="fl">1.</span> In the third case <span class="sc">-</span><span class="dv">1</span> and <span class="fl">2.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-5">
<p>📝 What will happen if we execute the code below?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1"></a>z <span class="ot">&lt;-</span> <span class="st">"a"</span></span>
<span id="cb365-2"><a href="#cb365-2"></a><span class="cf">if</span> (z <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb365-3"><a href="#cb365-3"></a>  </span>
<span id="cb365-4"><a href="#cb365-4"></a>  x <span class="ot">&lt;-</span> z<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb365-5"><a href="#cb365-5"></a>  y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sqrt</span>(z)</span>
<span id="cb365-6"><a href="#cb365-6"></a>  </span>
<span id="cb365-7"><a href="#cb365-7"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(z) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb365-8"><a href="#cb365-8"></a>  </span>
<span id="cb365-9"><a href="#cb365-9"></a>  x <span class="ot">&lt;-</span> z<span class="sc">^</span><span class="dv">4</span></span>
<span id="cb365-10"><a href="#cb365-10"></a>  y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span>z)</span>
<span id="cb365-11"><a href="#cb365-11"></a>  </span>
<span id="cb365-12"><a href="#cb365-12"></a>} <span class="cf">else</span> {</span>
<span id="cb365-13"><a href="#cb365-13"></a>  </span>
<span id="cb365-14"><a href="#cb365-14"></a>  x <span class="ot">&lt;-</span> z<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb365-15"><a href="#cb365-15"></a>  y <span class="ot">&lt;-</span> <span class="fu">abs</span>(z)</span>
<span id="cb365-16"><a href="#cb365-16"></a>  </span>
<span id="cb365-17"><a href="#cb365-17"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1"></a><span class="co"># will give error since it is not a numeric argument</span></span>
<span id="cb366-2"><a href="#cb366-2"></a>Error <span class="cf">in</span> z<span class="sc">^</span><span class="dv">3</span> <span class="sc">:</span> non<span class="sc">-</span>numeric argument to binary operator</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-6">
<p>📝 From the <code>{lubridate}</code> package, the <code>hour()</code> function returns the time of a given date, and the <code>now()</code> function returns the date and time of the current time. With both functions, have <code>cat()</code> (<code>cat()</code>) print “good night” only after 21:00.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1"></a><span class="co"># loading library</span></span>
<span id="cb367-2"><a href="#cb367-2"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb367-3"><a href="#cb367-3"></a></span>
<span id="cb367-4"><a href="#cb367-4"></a><span class="co"># Current date-time</span></span>
<span id="cb367-5"><a href="#cb367-5"></a>current_dt <span class="ot">&lt;-</span> <span class="fu">now</span>()</span>
<span id="cb367-6"><a href="#cb367-6"></a></span>
<span id="cb367-7"><a href="#cb367-7"></a><span class="co"># If structure</span></span>
<span id="cb367-8"><a href="#cb367-8"></a><span class="cf">if</span> (<span class="fu">hour</span>(current_dt) <span class="sc">&gt;</span> <span class="dv">21</span>) {</span>
<span id="cb367-9"><a href="#cb367-9"></a>  </span>
<span id="cb367-10"><a href="#cb367-10"></a>  <span class="fu">cat</span>(<span class="st">"Good night"</span>) <span class="co"># print or cat (two ways of printing)</span></span>
<span id="cb367-11"><a href="#cb367-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="communicate-rmd-and-quarto" class="slide level2">
<h2>Communicate: rmd and Quarto</h2>
<p>One of the <span class="hl-yellow"><strong>main strengths</strong></span> of <code>R</code> is the <span class="hl-yellow"><strong>easiness to generate reports, books, webs, notes and even slides</strong></span> (this same material for example). To do this, <span class="hl-purple"><strong>install</strong></span> before</p>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>the <code>{rmarkdown}</code> package (to generate <code>.rmd</code> files)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1"></a><span class="fu">install.packages</span>(<span class="st">"rmarkdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>install <a href="https://quarto.org/docs/get-started/"><strong>Quarto</strong></a> (if you already knew <code>R</code>, the “new” <code>.rmd</code> now as <code>.qmd</code>)</li>
</ul>
</div><div class="column" style="width:60%;">
<p><img data-src="img/quarto.png"></p>
</div>
</div>
</section>
<section id="communicate-rmd-and-quarto-1" class="slide level2">
<h2>Communicate: rmd and Quarto</h2>
<p>So far we have only programmed in scripts (<code>.R</code> files) within projects, but in many occasions <span class="hl-yellow"><strong>we will not work alone</strong></span> and we will need to <span class="hl-yellow"><strong>communicate the results</strong></span> in different formats:</p>
<ul>
<li>notes (for ourselves)</li>
<li>slides</li>
<li>web</li>
<li>reports</li>
</ul>
<p>For all this we will use <span class="hl-yellow"><strong>Quarto</strong></span> (see more in <a href="https://ivelasq.quarto.pub/intro-to-quarto/" class="uri">https://ivelasq.quarto.pub/intro-to-quarto/</a>)</p>
</section>
<section id="communicate-rmd-and-quarto-2" class="slide level2">
<h2>Communicate: rmd and Quarto</h2>
<p>The <code>.qmd</code> (or <code>.rmd</code> before) extension files will allow us to easily combine:- <span class="hl-yellow"><strong>Markdown</strong></span>:</p>
<ul>
<li><span class="hl-purple"><strong>typed language</strong></span> that allows us to create simple content (wordpress type, with text, <strong>bold</strong>, <em>cursives</em>, etc) with a readable layout.</li>
</ul>
<div class="fragment">
<ul>
<li>[<strong>Math (latex)</strong>]{. hl-yellow}: language for writing mathematical notation such as <span class="math inline">\(x^2\)</span> or <span class="math inline">\(\sqrt{y}\)</span> or <span class="math inline">\(\int_{a}^{b} f(x) dx\)</span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Code and outputs</strong></span>: we can not only show the final step but also the code you have been doing (in <code>R</code>, <code>Python</code>, <code>C++</code>, <code>Julia</code>, …), with <span class="hl-purple"><strong>code boxes called CHUNKS</strong></span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Images, <span class="hl-yellow"><strong>graphs</strong></span>, tables, styles (css, js), etc.</li>
</ul>
</div>
</section>
<section id="communicate-rmd-and-quarto-3" class="slide level2">
<h2>Communicate: rmd and Quarto</h2>
<p>The main advantage of making this type of material in Quarto/Rmarkdown is that, by doing it from <code>RStudio</code>, you can generate a <span class="hl-yellow"><strong>report or presentation without leaving the programming environment</strong></span> in which you are working. This way you can analyze the data, summarize it and at the same time communicate it with the same tool.</p>
<div class="fragment">
<p>Recently the <code>RStudio</code> team developed <span class="hl-yellow"><strong>Quarto</strong></span>, an improved version of Rmarkdown (<code>.qmd</code> files), with a slightly more aesthetic and simpler format. You have all the documentation and examples at <a href="https://quarto.org/"><strong>https://quarto.org/</strong></a></p>
</div>
</section>
<section id="quarto-examples" class="slide level2">
<h2>Quarto examples</h2>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">Webs</a></li><li><a href="#tabset-7-2">Books</a></li><li><a href="#tabset-7-3">Blogs</a></li><li><a href="#tabset-7-4">Slides</a></li><li><a href="#tabset-7-5">Journals</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<p><img data-src="./img/website.png" height="350"></p>
</div>
<div id="tabset-7-2">
<p><img data-src="./img/book.png" height="350"></p>
</div>
<div id="tabset-7-3">
<p><img data-src="./img/blog.png" height="350"></p>
</div>
<div id="tabset-7-4">
<p><img data-src="./img/presentation.png" height="350"></p>
</div>
<div id="tabset-7-5">
<p><img data-src="https://user-images.githubusercontent.com/163582/42351114-e5deaa1c-8078-11e8-90de-2aff57bba255.png" height="350"></p>
</div>
</div>
</div>
<p>Images obtained from <a href="https://ivelasq.quarto.pub/intro-to-quarto/#/working-with-the-rstudio-visual-editor" class="uri">https://ivelasq.quarto.pub/intro-to-quarto/#/working-with-the-rstudio-visual-editor</a></p>
</section>
<section id="our-first-report" class="slide level2">
<h2>Our first report</h2>
<div class="columns">
<div class="column" style="width:55%;">
<p><img data-src="img/quarto-create.png"></p>
</div><div class="column" style="width:45%;">
<p>We are going to create the <span class="hl-yellow"><strong>first rmarkdown file with Quarto</strong></span> with extension <code>.qmd</code>. For this we will only need to click on</p>
<p><code>File &lt;&lt; New File &lt;&lt; Quarto Document</code></p>
</div>
</div>
</section>
<section id="our-first-report-1" class="slide level2">
<h2>Our first report</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/quarto-format.png"></p>
</div><div class="column" style="width:55%;">
<p>After doing so, several <span class="hl-yellow"><strong>output format options</strong></span>:</p>
<ul>
<li><p><code>.pdf</code> file</p></li>
<li><p><code>.html</code> file (<span class="hl-yellow"><strong>recommendable</strong></span>): dynamic document, allows user interaction, like a “web page”.</p></li>
<li><p><code>.doc</code> file (not recommended).</p></li>
</ul>
</div>
</div>
<div class="fragment">
<p>For the moment we will leave the <span class="hl-yellow"><strong>default HTML format</strong></span> checked, and we will write the <span class="hl-yellow"><strong>title</strong></span> of our document. After that we will have our <span class="hl-yellow"><strong>file .qmd</strong></span> (it is no longer an .R script like the ones we have opened so far).</p>
</div>
</section>
<section id="our-first-report-2" class="slide level2">
<h2>Our first report</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/quarto-example.png"></p>
</div><div class="column" style="width:40%;">
<p>You should have something similar to the image capture with <span class="hl-yellow"><strong>two editing modes</strong></span>: <code>Source</code> (with code, the recommended option until you master it) and <code>Visual</code> (more like a blog).</p>
</div>
</div>
<p>To <span class="hl-yellow"><strong>run the WHOLE document</strong></span> you must click <code>Render on Save</code> and hit save.</p>
</section>
<section id="quarto-output-format" class="slide level2">
<h2>Quarto output format</h2>

<img data-src="img/quarto-prueba-html.png" class="r-stretch"><p>You should have obtained an <span class="hl-yellow"><strong>html output similar to this</strong></span> (and a <span class="hl-yellow"><strong>html file</strong></span> has been generated on your computer).</p>
</section>
<section id="editor-source-vs-visual" class="slide level2">
<h2>Editor: source vs visual</h2>
<p>As indicated, you have two ways of working: with pure code and something similar to a Notion (blog).</p>

<img data-src="./img/rstudio-source-visual.png" class="r-stretch"><p>Image retrieved from <a href="https://ivelasq.quarto.pub/intro-to-quarto/#/working-with-the-rstudio-visual-editor" class="uri">https://ivelasq.quarto.pub/intro-to-quarto/#/working-with-the-rstudio-visual-editor</a></p>
</section>
<section id="our-first-report-3" class="slide level2">
<h2>Our first report</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-example.png"></p>
</div><div class="column" style="width:50%;">
<p>A <code>.qmd</code> file is <span class="hl-yellow"><strong>basically divided into three parts</strong></span>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Header</strong></span>: the part you have at the beginning between <code>---</code>.</p></li>
<li><p>[<strong>Text</strong>]{. hl-yellow}: which we can format and enhance with bold (written as <strong>bold</strong>, with double asterisk at the beginning and end), italics (<em>cursive</em>, with underscore at the beginning and end) or highlight function or variable names from R. You can add equations like <span class="math inline">\(x^2\)</span> (I have written <code>$x^2$</code>, between dollars).</p></li>
<li><p><span class="hl-yellow"><strong>R code</strong></span></p></li>
</ul>
</div>
</div>
</section>
<section id="header" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Header</h2>
<p>The <span class="hl-yellow"><strong>header is in YAML</strong></span> format and contains the <span class="hl-yellow"><strong>metadata</strong></span> of the document.</p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><code>title</code> and <code>subtitle</code>: the title/subtitle of the document</li>
<li><code>author</code>: author of the document</li>
<li><code>format</code>: output format (we can customize)
<ul>
<li><code>theme</code>: if you have any style file</li>
<li><code>toc</code>: if you want index or not</li>
<li><code>toc-location</code>: index position</li>
<li><code>toc-title</code>: index title</li>
</ul></li>
<li><code>editor</code>: if you are in visual or source mode.</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="sourceCode" id="cb369"><pre class="sourceCode numberSource yaml number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode yaml hljs"><span id="cb369-1" class="hljs-ln-code"><a href="#cb369-1"></a><span class="pp">---</span></span>
<span id="cb369-2" class="hljs-ln-code"><a href="#cb369-2"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"prueba"</span></span>
<span id="cb369-3" class="hljs-ln-code"><a href="#cb369-3"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb369-4" class="hljs-ln-code"><a href="#cb369-4"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb369-5" class="hljs-ln-code"><a href="#cb369-5"></a><span class="fu">editor</span><span class="kw">:</span><span class="at"> visual</span></span>
<span id="cb369-6" class="hljs-ln-code"><a href="#cb369-6"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="header-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Header</h2>
<p>The <span class="hl-yellow"><strong>header is in YAML</strong></span> format and contains the <span class="hl-yellow"><strong>metadata</strong></span> of the document.</p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><code>title</code> and <code>subtitle</code>: the title/subtitle of the document</li>
<li><code>author</code>: author of the document</li>
<li><code>format</code>: output format (we can customize)
<ul>
<li><code>theme</code>: if you have any style file</li>
<li><code>toc</code>: if you want index or not</li>
<li><code>toc-location</code>: index position</li>
<li><code>toc-title</code>: index title</li>
</ul></li>
<li><code>editor</code>: if you are in visual or source mode.</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="sourceCode" id="cb370"><pre class="sourceCode numberSource yaml number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode yaml hljs"><span id="cb370-1" class="hljs-ln-code"><a href="#cb370-1"></a><span class="pp">---</span></span>
<span id="cb370-2" class="hljs-ln-code"><a href="#cb370-2"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"prueba"</span></span>
<span id="cb370-3" class="hljs-ln-code"><a href="#cb370-3"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"javier álvarez liébana"</span></span>
<span id="cb370-4" class="hljs-ln-code"><a href="#cb370-4"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb370-5" class="hljs-ln-code"><a href="#cb370-5"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb370-6" class="hljs-ln-code"><a href="#cb370-6"></a><span class="fu">editor</span><span class="kw">:</span><span class="at"> visual</span></span>
<span id="cb370-7" class="hljs-ln-code"><a href="#cb370-7"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="header-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Header</h2>
<p>The <span class="hl-yellow"><strong>header is in YAML</strong></span> format and contains the <span class="hl-yellow"><strong>metadata</strong></span> of the document.</p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><code>title</code> and <code>subtitle</code>: the title/subtitle of the document</li>
<li><code>author</code>: author of the document</li>
<li><code>format</code>: output format (we can customize)
<ul>
<li><code>theme</code>: if you have any style file</li>
<li><code>toc</code>: if you want index or not</li>
<li><code>toc-location</code>: index position</li>
<li><code>toc-title</code>: index title</li>
</ul></li>
<li><code>editor</code>: if you are in visual or source mode.</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="sourceCode" id="cb371"><pre class="sourceCode numberSource yaml number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode yaml hljs"><span id="cb371-1" class="hljs-ln-code"><a href="#cb371-1"></a><span class="pp">---</span></span>
<span id="cb371-2" class="hljs-ln-code"><a href="#cb371-2"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"prueba"</span></span>
<span id="cb371-3" class="hljs-ln-code"><a href="#cb371-3"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"javier álvarez liébana"</span></span>
<span id="cb371-4" class="hljs-ln-code"><a href="#cb371-4"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb371-5" class="hljs-ln-code"><a href="#cb371-5"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb371-6" class="hljs-ln-code"><a href="#cb371-6"></a><span class="at">    </span><span class="fu">style</span><span class="kw">:</span><span class="at"> style.css</span></span>
<span id="cb371-7" class="hljs-ln-code"><a href="#cb371-7"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb371-8" class="hljs-ln-code"><a href="#cb371-8"></a><span class="fu">editor</span><span class="kw">:</span><span class="at"> visual</span></span>
<span id="cb371-9" class="hljs-ln-code"><a href="#cb371-9"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="header-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Header</h2>
<p>The <span class="hl-yellow"><strong>header is in YAML</strong></span> format and contains the <span class="hl-yellow"><strong>metadata</strong></span> of the document.</p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><code>title</code> and <code>subtitle</code>: the title/subtitle of the document</li>
<li><code>author</code>: author of the document</li>
<li><code>format</code>: output format (we can customize)
<ul>
<li><code>theme</code>: if you have any style file</li>
<li><code>toc</code>: if you want index or not</li>
<li><code>toc-location</code>: index position</li>
<li><code>toc-title</code>: index title</li>
</ul></li>
<li><code>editor</code>: if you are in visual or source mode.</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="sourceCode" id="cb372"><pre class="sourceCode numberSource yaml number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode yaml hljs"><span id="cb372-1" class="hljs-ln-code"><a href="#cb372-1"></a><span class="pp">---</span></span>
<span id="cb372-2" class="hljs-ln-code"><a href="#cb372-2"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"prueba"</span></span>
<span id="cb372-3" class="hljs-ln-code"><a href="#cb372-3"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"javier álvarez liébana"</span></span>
<span id="cb372-4" class="hljs-ln-code"><a href="#cb372-4"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb372-5" class="hljs-ln-code"><a href="#cb372-5"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb372-6" class="hljs-ln-code"><a href="#cb372-6"></a><span class="at">    </span><span class="fu">style</span><span class="kw">:</span><span class="at"> style.css</span></span>
<span id="cb372-7" class="hljs-ln-code"><a href="#cb372-7"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb372-8" class="hljs-ln-code"><a href="#cb372-8"></a><span class="at">    </span><span class="fu">toc-location</span><span class="kw">:</span><span class="at"> left</span></span>
<span id="cb372-9" class="hljs-ln-code"><a href="#cb372-9"></a><span class="fu">editor</span><span class="kw">:</span><span class="at"> visual</span></span>
<span id="cb372-10" class="hljs-ln-code"><a href="#cb372-10"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="header-4" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Header</h2>
<p>The <span class="hl-yellow"><strong>header is in YAML</strong></span> format and contains the <span class="hl-yellow"><strong>metadata</strong></span> of the document.</p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><code>title</code> and <code>subtitle</code>: the title/subtitle of the document</li>
<li><code>author</code>: author of the document</li>
<li><code>format</code>: output format (we can customize)
<ul>
<li><code>theme</code>: if you have any style file</li>
<li><code>toc</code>: if you want index or not</li>
<li><code>toc-location</code>: index position</li>
<li><code>toc-title</code>: index title</li>
</ul></li>
<li><code>editor</code>: if you are in visual or source mode.</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="sourceCode" id="cb373"><pre class="sourceCode numberSource yaml number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode yaml hljs"><span id="cb373-1" class="hljs-ln-code"><a href="#cb373-1"></a><span class="pp">---</span></span>
<span id="cb373-2" class="hljs-ln-code"><a href="#cb373-2"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"prueba"</span></span>
<span id="cb373-3" class="hljs-ln-code"><a href="#cb373-3"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"javier álvarez liébana"</span></span>
<span id="cb373-4" class="hljs-ln-code"><a href="#cb373-4"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb373-5" class="hljs-ln-code"><a href="#cb373-5"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb373-6" class="hljs-ln-code"><a href="#cb373-6"></a><span class="at">    </span><span class="fu">style</span><span class="kw">:</span><span class="at"> style.css</span></span>
<span id="cb373-7" class="hljs-ln-code"><a href="#cb373-7"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb373-8" class="hljs-ln-code"><a href="#cb373-8"></a><span class="at">    </span><span class="fu">toc-location</span><span class="kw">:</span><span class="at"> left</span></span>
<span id="cb373-9" class="hljs-ln-code"><a href="#cb373-9"></a><span class="at">    </span><span class="fu">toc-title</span><span class="kw">:</span><span class="at"> Índice</span></span>
<span id="cb373-10" class="hljs-ln-code"><a href="#cb373-10"></a><span class="fu">editor</span><span class="kw">:</span><span class="at"> visual</span></span>
<span id="cb373-11" class="hljs-ln-code"><a href="#cb373-11"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="text" class="slide level2">
<h2>Text</h2>
<p>Regarding typing there is only one <span class="hl-yellow"><strong>important thing</strong></span>: unless we indicate otherwise, <span class="hl-yellow"><strong>EVERYTHING we are going to type is (normal)</strong></span> text; no R code.</p>
<div class="columns">
<div class="column" style="width:35%;">
<p><img data-src="img/quarto-prueba-qmd2.png" width="350"> <img data-src="img/quarto-prueba-html2.png" width="320"></p>
</div><div class="column" style="width:65%;">
<p>We are going to start by writing a section at the beginning (<code># Intro</code> and behind it, for example, the sentence</p>
<blockquote>
<p>This material has been designed by Professor Javier Álvarez Liébana, professor at the Complutense University of Madrid</p>
</blockquote>
<p>In addition to the <code>Running Code</code> we will add a <code>#</code> pad: the <span class="hl-yellow"><strong>outside-chunks</strong></span> pads will help us create <span class="hl-yellow"><strong>epigraphs (sections)</strong></span> in the document.</p>
</div>
</div>
</section>
<section id="index" class="slide level2">
<h2>Index</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/quarto-indice-qmd-2.png" width="370"> <img data-src="img/quarto-indice-html2.png" width="370"></p>
</div><div class="column" style="width:60%;">
<p>To make the <span class="hl-yellow"><strong>index capture those sections</strong></span> we will modify the header of the file as shown in the image (you can change the location of the index and the title if you want to test).</p>
</div>
</div>
</section>
<section id="text-1" class="slide level2">
<h2>Text</h2>
<p>Let’s <span class="hl-yellow"><strong>customize the text</strong></span> a bit by doing the following:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-texto-mejorado-qmd.png" width="370"> <img data-src="img/quarto-texto-mejorado-html.png" width="370"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p>We will add <span class="hl-yellow"><strong>bold to the name</strong></span> (putting ** at the beginning and at the end).</p></li>
<li><p>We will add <span class="hl-yellow"><strong>cursive</strong></span> to the word material (putting _ at the beginning and at the end).</p></li>
<li><p>We will add a <span class="hl-yellow"><strong>link</strong></span> <a href="https://www.ucm.es" class="uri">https://www.ucm.es</a>, associating it to the name of the University. To do this we put the title in square brackets and just behind the link in brackets <code>[“Universidad Complutense de Madrid”](https://www.ucm.es)</code>.</p></li>
</ul>
</div>
</div>
</section>
<section id="code" class="slide level2">
<h2>Code</h2>
<p>To <span class="hl-yellow"><strong>include R code</strong></span> we must create our <span class="hl-yellow"><strong>code boxes called chunks</strong></span>: high in the path in our markdown text where we can include code from almost any language (and its outputs).</p>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-chunk-qmd.png" width="470"></p>
</div><div class="column" style="width:50%;">
<p>To include one you must go <span class="hl-yellow"><strong>header</strong></span> as follows you have a shortcut <code>Command + Option + I</code> (Mac) or <code>Ctrl + Shift + I</code> (Windows)</p>
</div>
</div>
</section>
<section id="code-1" class="slide level2">
<h2>Code</h2>
<p>Inside this box (which now has a different color in the document) <span class="hl-yellow"><strong>write code R</strong></span> as we have been doing so far in the scripts.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-chunk-1-qmd.png" width="410"> <img data-src="img/quarto-chunk-1-html.png" width="410"></p>
</div><div class="column" style="width:50%;">
<p>Let’s for example define two variables and their sum in the following way, writing this code in our <code>.qmd</code> (inside that chunk)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1"></a><span class="co"># R code</span></span>
<span id="cb374-2"><a href="#cb374-2"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb374-3"><a href="#cb374-3"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb374-4"><a href="#cb374-4"></a>x <span class="sc">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="running-chunks" class="slide level2">
<h2>Running chunks</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-tag-chunks-qmd.png" width="400"> <img data-src="img/quarto-tag-chunks-html.png" width="400"></p>
</div><div class="column" style="width:50%;">
<p>Chunks can have a <span class="hl-yellow"><strong>name or tag</strong></span>, so that we can reference them again to avoid repeating code.</p>
</div>
</div>
</section>
<section id="running-chunks-1" class="slide level2">
<h2>Running chunks</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/quarto-inline-qmd.png" width="400"> <img data-src="img/quarto-inline-html.png" width="380"></p>
</div><div class="column" style="width:60%;">
<p>In each chunk there are <span class="hl-yellow"><strong>two buttons</strong></span>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>play</strong></span> button: activates the <span class="hl-yellow"><strong>play and exit of that particular chunk</strong></span> (you can view it within your own <code>RStudio</code>)</p></li>
<li><p><span class="hl-yellow"><strong>rewind</strong></span> button: activates the <span class="hl-yellow"><strong>play and exit of all chunks up to that one</strong></span> (without reaching it).</p></li>
</ul>
<p>&nbsp;</p>
<p>In addition we can <span class="hl-yellow"><strong>include R code inside the text line</strong></span> (instead of displaying the text x execute the R code displaying the variable).</p>
</div>
</div>
</section>
<section id="customizing-chunks" class="slide level2">
<h2>Customizing chunks</h2>
<p>The <span class="hl-yellow"><strong>chunks can be customized</strong></span> with options at the beginning of the chunk preceded by <code>#|</code>:</p>
<ul>
<li><p><code>#| echo: false</code>: <span class="hl-green"><strong>execute code</strong></span> and <span class="hl-green"><strong>show result</strong></span> but <span class="hl-red"><strong>does not display code</strong></span> in the output. hl-red} on output.</p></li>
<li><p><code>#| include: false</code>: <span class="hl-green"><strong>executes code</strong></span> but <span class="hl-red"><strong>does not display result</strong></span> and <span class="hl-red"><strong>does not display code</strong></span> on output.</p></li>
<li><p><code>#| eval: false</code>: [<strong>does not execute code</strong>]{. hl-red}, <span class="hl-red"><strong>does not display result</strong></span> but <span class="hl-green"><strong>does display code</strong></span> on output.</p></li>
<li><p><code>#| message: false</code>: <span class="hl-green"><strong>executes code</strong></span> but <span class="hl-red"><strong>does not display output messages</strong></span>.</p></li>
<li><p><code>#| warning: false</code>: <span class="hl-green"><strong>runs code</strong></span> but <span class="hl-red"><strong>does not display warning messages</strong></span>.</p></li>
<li><p><code>#| error: true</code>: <span class="hl-green"><strong>runs code</strong></span> and <span class="hl-green"><strong>allows errors</strong></span> displaying the error message in the output.</p></li>
</ul>

<img data-src="img/quarto-options-chunk.png" width="380" class="r-stretch"><p>These options can be applied chunk by chunk or set globally with <code>knitr::opts_chunk$set()</code> at the beginning of the document (within a chunk).</p>
</section>
<section id="customizing-chunks-1" class="slide level2">
<h2>Customizing chunks</h2>
<p>If we want to apply the <strong>option to all chunks by default</strong> we must include it at the end of the header, as <span class="hl-yellow"><strong>run options</strong></span></p>
<div class="sourceCode" id="cb376"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb376-1"><a href="#cb376-1"></a><span class="pp">---</span></span>
<span id="cb376-2"><a href="#cb376-2"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"¡Hola!"</span></span>
<span id="cb376-3"><a href="#cb376-3"></a><span class="fu">format</span><span class="kw">:</span><span class="at"> html</span></span>
<span id="cb376-4"><a href="#cb376-4"></a><span class="fu">editor</span><span class="kw">:</span><span class="at"> visual</span></span>
<span id="cb376-5"><a href="#cb376-5"></a><span class="fu">execute</span><span class="kw">:</span></span>
<span id="cb376-6"><a href="#cb376-6"></a><span class="at">  </span><span class="fu">echo</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb376-7"><a href="#cb376-7"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="organizing" class="slide level2">
<h2>Organizing</h2>
<p>In addition to text and code we can enter the following:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Equations</strong></span>: you can also add equations like <span class="math inline">\(x^2\)</span> (I have written <code>$x^2$</code>, the equation between dollars).</p></li>
<li><p>[<strong>Lists</strong>]{. hl-yellow}: you can itemize elements by putting <code>* Step 1: ... *Step 2: ...</code></p></li>
<li><p><span class="hl-yellow"><strong>Cross-references</strong></span>: you can tag parts of the document (the tag is constructed with <code>{#section-name}</code>) and then call them with <code>[Section](@section-name)</code>.</p></li>
</ul>
</section>
<section id="figures-and-images" class="slide level2">
<h2>Figures and images</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-fig-qmd.png" width="340"> <img data-src="img/quarto-fig-html.png" width="390"></p>
</div><div class="column" style="width:50%;">
<p>Finally, we can also <span class="hl-yellow"><strong>add captions to graphics or images</strong></span> by adding <code>#| fig-cap: "..."</code>.</p>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:65%;">
<p>Notice that the <span class="hl-yellow"><strong>caption is in the margin</strong></span> (for example). You can change it by entering <span class="hl-yellow"><strong>header settings</strong></span> (everything about figures starts with <code>fig-</code>, and you can see the options by tabbing). You have more information at <strong><a href="https://quarto.org/" class="uri">https://quarto.org/</a></strong></p>
</div><div class="column" style="width:35%;">
<p><img data-src="img/quarto-cabecera-desplegable.png" width="400"></p>
</div>
</div>
</div>
</section>
<section id="styles" class="slide level2">
<h2>Styles</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/quarto-estilos-qmd.png" width="400"> <img data-src="img/quarto-estilos-html.png" width="400"></p>
</div><div class="column" style="width:50%;">
<p>Finally you can add a <span class="hl-yellow"><strong>custom theme</strong></span> including a <span class="hl-yellow"><strong>style file</strong></span> (<code>.scss</code> or <code>.css</code> file). I have left one for you at <a href="https://github.com/dadosdelaplace/docencia-R-master-bio-2324/tree/main/material" class="uri">https://github.com/dadosdelaplace/docencia-R-master-bio-2324/tree/main/material</a>.</p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>The style file must be in the same folder as the <code>.qmd</code> file.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="styles-1" class="slide level2">
<h2>Styles</h2>
<p>You can also do it in a simple way <span class="hl-yellow"><strong>adding a bit of HTML</strong></span> to the text. For example, to customize the color of a text it goes between square brackets and right after the text, between braces, the style options</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode numberSource html number-lines code-with-copy"><code class="sourceCode html"><span id="cb377-1"><a href="#cb377-1"></a>This word is [red]{style="color:red;"} ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb378"><pre class="sourceCode numberSource html number-lines code-with-copy"><code class="sourceCode html"><span id="cb378-1"><a href="#cb378-1"></a>... and this is [green in bold]{style="color:green; font-weight: bold;"}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<p>This word is <span style="color:red;">red</span> …</p>
<p>… and this is <span style="color:green; font-weight: bold;">green in bold</span></p>
</div>
</section>
<section id="revealjs" class="slide level2">
<h2>Revealjs</h2>
<p>You can add some “animations” using what is known as Revealjs (javascript), specifying it in the header and using <span class="hl-yellow"><strong>blocks</strong></span> of that language delimited by <code>:::</code> at the beginning and end, and the word of the “tool” to use. For example <code>{.incremental}</code> transitions the elements.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb379-1"><a href="#cb379-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb379-2"><a href="#cb379-2"></a><span class="at">  revealjs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>&nbsp;</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode numberSource revealjs number-lines code-with-copy"><code class="sourceCode"><span id="cb380-1"><a href="#cb380-1"></a>::: {.incremental}</span>
<span id="cb380-2"><a href="#cb380-2"></a>- I</span>
<span id="cb380-3"><a href="#cb380-3"></a>- am</span>
<span id="cb380-4"><a href="#cb380-4"></a>- Javi</span>
<span id="cb380-5"><a href="#cb380-5"></a>:::</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div>
<ul>
<li class="fragment">I</li>
<li class="fragment">am</li>
<li class="fragment">Javi</li>
</ul>
</div>
</section>
<section id="call-blocks" class="slide level2">
<h2>Call blocks</h2>
<p>You can also use the <span class="hl-yellow"><strong>callout-blocks</strong></span> which by default are <code>note</code>, <code>tip</code>, <code>warning</code>, <code>caution</code> and <code>important</code> (although you can create and customize them). To do this, just use <code>::{.callout-type}</code> and the type you want to use</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode numberSource html number-lines code-with-copy"><code class="sourceCode html"><span id="cb381-1"><a href="#cb381-1"></a>:::{.callout-tip}</span>
<span id="cb381-2"><a href="#cb381-2"></a></span>
<span id="cb381-3"><a href="#cb381-3"></a>Note that there are five types of callouts, including: </span>
<span id="cb381-4"><a href="#cb381-4"></a>`note`, `tip`, `warning`, `caution`, and `important`.</span>
<span id="cb381-5"><a href="#cb381-5"></a></span>
<span id="cb381-6"><a href="#cb381-6"></a>:::</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Consejo</strong></p>
</div>
<div class="callout-content">
<p>Note that there are five types of callouts, including: <code>note</code>, <code>tip</code>, <code>warning</code>, <code>caution</code>, and <code>important</code>.</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Peligro</strong></p>
</div>
<div class="callout-content">
<p>Use them wisely, sometimes a lot of aesthetic resources can be dizzying.</p>
</div>
</div>
</div>
</div>
</section>
<section id="multiple-columns-layout" class="slide level2">
<h2>Multiple columns layout</h2>
<p>With <code>:::: columns</code> we can define a layout of <span class="hl-yellow"><strong>multiple columns</strong></span> where each one is defined by <code>::: {.column width=“65%”} something :::</code>, indicating next to the percentage how much you want each column to occupy (be careful not to leave spaces!).</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode numberSource html number-lines code-with-copy"><code class="sourceCode html"><span id="cb382-1"><a href="#cb382-1"></a>:::: columns</span>
<span id="cb382-2"><a href="#cb382-2"></a>::: {.column width="65%"}</span>
<span id="cb382-3"><a href="#cb382-3"></a>This is how to define a vector</span>
<span id="cb382-4"><a href="#cb382-4"></a>:::</span>
<span id="cb382-5"><a href="#cb382-5"></a>::: {.column width="35%"}</span>
<span id="cb382-6"><a href="#cb382-6"></a>x <span class="er">&lt;</span>- c(1, 2, 3)</span>
<span id="cb382-7"><a href="#cb382-7"></a>x</span>
<span id="cb382-8"><a href="#cb382-8"></a>:::</span>
<span id="cb382-9"><a href="#cb382-9"></a>::::</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>&nbsp;</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:65%;">
<p>This is how to define a vector</p>
</div><div class="column" style="width:35%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb383-2"><a href="#cb383-2"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="non-r-code" class="slide level2">
<h2>Non-R code</h2>
<p>In addition <code>{reticulate}</code> allows us to create <code>python</code> chunks inside a Quarto in <code>R</code> (see <a href="https://quarto.org/docs/computations/python.html" class="uri">https://quarto.org/docs/computations/python.html</a> to create jupyter notebooks directly from Quarto).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1"></a><span class="co"># install.packages("reticulate")</span></span>
<span id="cb385-2"><a href="#cb385-2"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb385-3"><a href="#cb385-3"></a></span>
<span id="cb385-4"><a href="#cb385-4"></a><span class="fu">install_python</span>(<span class="st">"3.9.12"</span>) <span class="co"># Installing python if you have not done before</span></span>
<span id="cb385-5"><a href="#cb385-5"></a></span>
<span id="cb385-6"><a href="#cb385-6"></a><span class="co"># Installing Python libraries</span></span>
<span id="cb385-7"><a href="#cb385-7"></a>reticulate<span class="sc">::</span><span class="fu">py_install</span>(<span class="st">"numpy"</span>)</span>
<span id="cb385-8"><a href="#cb385-8"></a>reticulate<span class="sc">::</span><span class="fu">py_install</span>(<span class="st">"matplotlib"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb386-1"><a href="#cb386-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb386-2"><a href="#cb386-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb386-3"><a href="#cb386-3"></a>r <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.05</span>)</span>
<span id="cb386-4"><a href="#cb386-4"></a>theta <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> r</span>
<span id="cb386-5"><a href="#cb386-5"></a>fig, ax <span class="op">=</span> plt.subplots(</span>
<span id="cb386-6"><a href="#cb386-6"></a>  subplot_kw <span class="op">=</span> {<span class="st">'projection'</span>: <span class="st">'polar'</span>} </span>
<span id="cb386-7"><a href="#cb386-7"></a>)</span>
<span id="cb386-8"><a href="#cb386-8"></a>ax.plot(theta, r)</span>
<span id="cb386-9"><a href="#cb386-9"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="caso-practico-0-3-1" class="slide level2">
<h2>🐣 Case study I: flow structures</h2>
<p>To practice control structures we are going to perform a <span class="hl-yellow"><strong>simulation exercise</strong></span></p>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/flow-structure-functions"><strong>workbook</strong></a></p>
</section>
<section id="caso-practico-0-3-2" class="slide level2">
<h2>🐣 Case study II: functions</h2>
<p>Define a function called <code>temperature_converter</code> that, given a temperature in Fahrenheit, Celsius or Kelvin, converts it to any of the others</p>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/flow-structures-functions"><strong>workbook</strong></a></p>
</section>
<section id="caso-practico-0-3-3" class="slide level2">
<h2>🐣 Case study III: mock task</h2>
<p>Let’s perform a small simulation before delivery using the <code>starwars</code> dataset from the <code>{dplyr}</code> package.</p>

<img data-src="https://sm.ign.com/t/ign_latam/screenshot/default/baby-yoda-nombre_3x56.1280.jpg" class="r-stretch"></section>
<section id="case-study-iii-mock-task" class="slide level2">
<h2>🐣 Case study III: mock task</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb387-2"><a href="#cb387-2"></a>starwars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<p>We have <strong>different variables of the Star Wars characters</strong>, with characteristics of their hair, skin, height, name, etc.</p>
</section>
<section id="case-study-iii-mock-task-1" class="slide level2">
<h2>🐣 Case study III: mock task</h2>
<blockquote>
<p>Create a <code>.qmd</code> document with name, title, format and index. Each subsequent Exercise will be a subsection of the document. Run the chunks you consider and comment on the outputs to answer each question</p>
</blockquote>
<div class="fragment">
<blockquote>
<p>Exercise 1. How many characters are stored in the database? How many characteristics have been measured for each one?</p>
</blockquote>
</div>
<div class="fragment">
<blockquote>
<p>Exercise 2. Extract in two different variables <code>names</code> and <code>ages</code> the corresponding variables from the table. What type is the variable name? And the variable birth_year?</p>
</blockquote>
</div>
<div class="fragment">
<blockquote>
<p>Exercise 3. Obtain the vector of names of the characters sorted from oldest to youngest.</p>
</blockquote>
</div>
</section>
<section id="case-study-iii-mock-task-2" class="slide level2">
<h2>🐣 Case study III: mock task</h2>
<blockquote>
<p>Exercise 4. Get help from the unique() function. Use it to find out what modalities the qualitative variable for eye color has. How many different ones are there?</p>
</blockquote>
<div class="fragment">
<blockquote>
<p>Exercise 5. Are there ANY missing values in the eye color variable?</p>
</blockquote>
</div>
<div class="fragment">
<blockquote>
<p>Exercise 6. Calculate the mean and standard deviation of the height and weight variables (watch out for missing values). Define a new tibble with these two variables and incorporate a third variable called “BMI” that calculates the body mass index. Incorporate with <code>$ $</code> the formula used for BMI.</p>
</blockquote>
</div>
</section></section>
<section>
<section id="clase-0-4" class="title-slide slide level1 center">
<h1>Final task: <span class="flow">foundations of R base</span></h1>
<p><span style="color:#444442;"><strong>Final task (70%)</strong>: 10/09/2024 from 15:00 to 16:10</span></p>
</section>
<section id="final-task-intro-r" class="slide level2">
<h2>Final task (intro R)</h2>
<p>The day of the submission you will have uploaded a <span class="hl-yellow"><strong>submission template</strong></span> in <code>.qmd</code> format on campus.</p>
<ol type="1">
<li><p><strong>Unzip the folder</strong> (important! if you don’t unzip, even if you can edit the <code>.qmd</code>, you won’t be able to generate the <code>. html</code>)</p></li>
<li><p><strong>Edit the header</strong> with your name and ID</p></li>
<li><p>You must <strong>fill in each chunk</strong> with the code you consider (in some I have left hints) and <strong>change</strong> from <code>#| eval: false</code> to <code>#| eval: true</code> (if you remove them directly, by default it is already true)</p></li>
<li><p>You must <strong>comment</strong> with normal text what you consider to answer the questions.</p></li>
<li><p>It will be <span class="hl-yellow"><strong>MANDATORY</strong></span> to upload the generated <code>.html</code> file (only that file will be corrected) so render as you fill in the document, don’t leave it to the end.</p></li>
</ol>
</section></section>
<section id="data-programming" class="title-slide slide level1 center">
<h1><span class="flow">DATA PROGRAMMING</span></h1>

</section>

<section>
<section id="clase-1" class="title-slide slide level1 center">
<h1>L1: <span class="flow">tidydata</span></h1>
<p><span style="color:#444442;"><strong>Our favorite format: tibble. Tidyverse: an universe of tidy data</strong></span></p>
<ul>
<li><a href="#/tu-turno-1-1">💻 Task correction</a></li>
<li><a href="#/tu-turno-1-2">💻 Solved exercises: tidy data</a></li>
<li><a href="#/caso-practico-1">🐣 Workbook/case study</a></li>
<li><a href="#/planificacion-curso">📆 Planning</a></li>
</ul>
</section>
<section id="tu-turno-1-1" class="slide level2">
<h2>💻 Task correction</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
</section>
<section id="previously-in-breaking-bad" class="slide level2">
<h2>Previously, in Breaking Bad…</h2>
<p>Our <span class="hl-yellow"><strong>final database format</strong></span> will be the <code>tibble</code> type object, an enhanced <code>data.frame</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb389-2"><a href="#cb389-2"></a><span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>), <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>), <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  height weight   BMI
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1    1.7     80  27.7
2    1.8     75  23.1
3    1.6     70  27.3</code></pre>
</div>
</div>
<ul>
<li><p><span class="hl-yellow"><strong>Metainformation</strong></span>: in the header it automatically tells us the number of rows and columns, and the type of each variable.</p></li>
<li><p><span class="hl-yellow"><strong>Recursivity</strong></span>: allows to define the variables sequentially (as we have seen).</p></li>
<li><p><span class="hl-yellow"><strong>Consistency</strong></span>: if you access a column that does not exist it warns you with a warning.</p></li>
<li><p><span class="hl-yellow"><strong>By rows</strong></span>: allows to create by rows with <code>tribble()</code>.</p></li>
</ul>
</section>
<section id="previously-in-breaking-bad-1" class="slide level2">
<h2>Previously, in Breaking Bad…</h2>
<p>To define a <code>tibble()</code> ourselves we have two options:</p>
<ul>
<li><span class="hl-yellow"><strong>Concatenating vectors</strong></span> that we already have defined, making use of the <code>tibble()</code> function of the <code>{tibble}</code> package (already included in <code>{tidyverse}</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>)</span>
<span id="cb391-2"><a href="#cb391-2"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>)</span>
<span id="cb391-3"><a href="#cb391-3"></a>BMI <span class="ot">&lt;-</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb391-4"><a href="#cb391-4"></a><span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> height, <span class="st">"weight"</span> <span class="ot">=</span> weight, <span class="st">"BMI"</span> <span class="ot">=</span> BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  height weight   BMI
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1    1.7     80  27.7
2    1.8     75  23.1
3    1.6     70  27.3</code></pre>
</div>
</div>
</section>
<section id="previously-in-breaking-bad-2" class="slide level2">
<h2>Previously, in Breaking Bad…</h2>
<ul>
<li><span class="hl-yellow"><strong>Directly in a tibble</strong></span> manually providing values and variable names</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1"></a><span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.7</span>, <span class="fl">1.8</span>, <span class="fl">1.6</span>),</span>
<span id="cb393-2"><a href="#cb393-2"></a>       <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">70</span>),</span>
<span id="cb393-3"><a href="#cb393-3"></a>       <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  height weight   BMI
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1    1.7     80  27.7
2    1.8     75  23.1
3    1.6     70  27.3</code></pre>
</div>
</div>
</section>
<section id="r-base-vs-tidyverse" class="slide level2">
<h2>R base vs Tidyverse</h2>
<p>So far, everything we have done in <code>R</code> has been done in the programming paradigm known as <span class="hl-yellow"><strong>R base</strong></span>. When <code>R</code> was born as a language, many of those who programmed in it imitated forms and methodologies inherited from other languages, based on the use of</p>
<ul>
<li><p>Loops <span class="hl-yellow"><strong>for</strong></span> and <span class="hl-yellow"><strong>while</strong></span></p></li>
<li><p>Dollar <code>$</code> to access to the variables</p></li>
<li><p>Structures <span class="hl-yellow"><strong>if-else</strong></span></p></li>
</ul>
<p>And although knowing these structures can be interesting in some cases, in <span class="hl-red"><strong>most cases they are obsolete and we will be able to avoid them</strong></span> (especially loops) since <code>R</code> is specially <span class="hl-yellow"><strong>designed to work in a functional way</strong></span> (instead of element-by-element).</p>
</section>
<section id="what-is-tidyverse" class="slide level2">
<h2>What is tidyverse?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/flow_tidyverse.jpg"></p>
</div>
</div>
<p>In this context of functional programming, a decade ago <code>{tidyverse}</code> was born, a <span class="hl-yellow"><strong>“universe” of packages</strong></span> to guarantee an efficient, coherent and lexicographically simple to understand workflow, based on the idea that <span class="hl-purple"><strong>our data is clean and tidy</strong></span>.</p>
</section>
<section id="what-is-tidyverse-1" class="slide level2">
<h2>What is tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
<ul>
<li><code>{lubridate}</code>: date management</li>
<li><code>{rvest}</code>: web scraping</li>
<li><code>{tidymodels}</code>: modeling/prediction</li>
</ul>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: optimizing data.frame</li>
<li><code>{tidyr}</code>: data cleaning</li>
<li><code>{readr}</code>: load rectangular data (.csv), <code>{readxl}</code>: import .xls and .xlsx files</li>
<li><code>{dplyr}</code>: grammar for debugging</li>
<li><code>{stringr}</code>: text handling</li>
<li><code>{purrr}</code>: list handling</li>
<li><code>{forcats}</code>: qualitative handling</li>
<li><code>{ggplot2}</code>: data visualization</li>
</ul>
</div>
</div>
</section>
<section id="what-is-tidyverse-2" class="slide level2">
<h2>What is tidyverse?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/tidyverrse_universe.jpg"></p>
<ul>
<li><code>{lubridate}</code>: date management</li>
<li><code>{rvest}</code>: web scraping</li>
<li><code>{tidymodels}</code>: modeling/prediction</li>
</ul>
</div><div class="column" style="width:55%;">
<ul>
<li><code>{tibble}</code>: <span class="hl-yellow"><strong>optimizing data.frame</strong></span></li>
<li><code>{tidyr}</code>: <span class="hl-yellow"><strong>data cleaning</strong></span></li>
<li><code>{readr}</code>: load rectangular data (.csv), <code>{readxl}</code>: import .xls and .xlsx files</li>
<li><code>{dplyr}</code>: grammar for debugging</li>
<li><code>{stringr}</code>: text handling</li>
<li><code>{purrr}</code>: list handling</li>
<li><code>{forcats}</code>: qualitative handling</li>
<li><code>{ggplot2}</code>: data visualization</li>
</ul>
</div>
</div>
</section>
<section id="basic-idea-tidy-data" class="slide level2">
<h2>Basic idea: tidy data</h2>
<blockquote>
<p>Tidy datasets are all alike, but every messy dataset is messy in its own way (Hadley Wickham, Chief Scientist en RStudio)</p>
</blockquote>
<div style="font-size:120px; text-align: center; color:#F8DF58;">
<p><b>TIDY</b><b><span style="color:#CAB0EE;">VERSE</span></b></p>
</div>
<p>The <span class="hl-purple"><strong>universe</strong></span> of <code>{tidyverse}</code> packages is based on the idea introduced by <strong>Hadley Wickham</strong> (the God we pray to) of <span class="hl-yellow"><strong>standardizing</strong></span> the format of data to</p>
<div>
<ul>
<li class="fragment"><span class="hl-green"><strong>systematize</strong></span> debugging</li>
<li class="fragment">make it easier <span class="hl-green"><strong>simpler</strong></span> to manipulate</li>
<li class="fragment"><span class="hl-green"><strong>legible</strong></span> code.</li>
</ul>
</div>
</section>
<section id="rules" class="slide level2">
<h2>Rules</h2>
<p>The first thing will therefore be to understand what the <span class="hl-yellow"><strong>tidydata sets</strong></span> are, since the whole <code>{tidyverse}</code> is based on the data being standardized.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment fade-in">
<ol type="1">
<li>Each <span class="hl-yellow"><strong>variable</strong></span> in a <span class="hl-purple"><strong>single column</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="2" type="1">
<li>Each <span class="hl-yellow"><strong>individual</strong></span> in a <span class="hl-purple"><strong>different row</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="3" type="1">
<li>Each <span class="hl-yellow"><strong>cell</strong></span> with a <span class="hl-purple"><strong>single value</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="4" type="1">
<li>Each <span class="hl-yellow"><strong>dataset</strong></span> in a <span class="hl-purple"><strong>tibble</strong></span></li>
</ol>
</div>
<div class="fragment fade-in">
<ol start="5" type="1">
<li>If we want to join <span class="hl-yellow"><strong>multiple datasets</strong></span> we must have a <span class="hl-purple"><strong>common (key) column</strong></span>.</li>
</ol>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidy_def.jpg" style="width:160.0%"></p>
</div>
</div>
</section>
<section id="pipe" class="slide level2">
<h2>Pipe</h2>
<p>In <code>{tidyverse}</code> the <span class="hl-yellow"><strong>operator pipe (pipe)</strong></span> defined as <code>|&gt;</code> (<span class="hl-purple"><strong>ctrl+shift+M</strong></span>) will be key: it will be a <span class="hl-yellow"><strong>pipe that traverses the data</strong></span> and transforms it. . . .</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>In R base, if we want to apply three functions <code>first()</code>, <code>second()</code> and <code>third()</code> in order, it would be</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1"></a><span class="fu">third</span>(<span class="fu">second</span>(<span class="fu">first</span>(data)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<p>In <code>{tidyverse}</code> we can <span class="hl-yellow"><strong>read from left to right</strong></span> and separate data from the actions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1"></a>data <span class="sc">|&gt;</span> <span class="fu">first</span>() <span class="sc">|&gt;</span> <span class="fu">second</span>() <span class="sc">|&gt;</span> <span class="fu">third</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Since version 4.1.0 of <code>R</code> we have <code>|&gt;</code>, a <strong>native</strong> pipe available <span class="hl-purple"><strong>outside tidyverse</strong></span>, replacing the <span class="hl-red"><strong>old pipe</strong></span> <code>%&gt;%</code> which depended on the <code>{magrittr}</code> package (quite problematic).</p>
</div>
</div>
</div>
</div>
</section>
<section id="pipe-1" class="slide level2">
<h2>Pipe</h2>
<p>The main advantage is that the <span class="hl-yellow"><strong>code is very readable (almost literal)</strong></span> and you can do large operations on the data with very little code.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb397-2"><a href="#cb397-2"></a>  <span class="fu">tidy</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-3"><a href="#cb397-3"></a>  <span class="fu">filter</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-4"><a href="#cb397-4"></a>  <span class="fu">select</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-5"><a href="#cb397-5"></a>  <span class="fu">arrange</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-6"><a href="#cb397-6"></a>  <span class="fu">modify</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-7"><a href="#cb397-7"></a>  <span class="fu">rename</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-8"><a href="#cb397-8"></a>  <span class="fu">group</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-9"><a href="#cb397-9"></a>  <span class="fu">count</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-10"><a href="#cb397-10"></a>  <span class="fu">summarise</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb397-11"><a href="#cb397-11"></a>  <span class="fu">plot</span>(...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<center>
<img src="img/logo_pipe.png" width="360px">
</center>
</div>
</div>
</section>
<section id="messy-data" class="slide level2">
<h2>Messy data</h2>
<p>But what does the <span class="hl-yellow"><strong>non-tidy (messy) data</strong></span> look like? Let’s load the <code>table4a</code> table from the <code>{tidyr}</code> package (we already have it loaded from the <code>{tidyverse}</code> environment).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb398-2"><a href="#cb398-2"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="pivot-longer" class="slide level2">
<h2>Pivot longer</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>❎ Each <span class="hl-red"><strong>row represents two observations</strong></span> (1999 and 2000) → the columns <code>1999</code> and <code>2000</code> should actually themselves be <span class="hl-yellow"><strong>values of a variable</strong></span> and not column names.</p>
</div>
</div>
<div class="fragment">
<p>We will include a <span class="hl-yellow"><strong>new column</strong></span> that stores the year and another one that stores the value of the variable of interest in each of those years. And we will do it with the <code>pivot_longer()</code> function: <span class="hl-yellow"><strong>pivot the table</strong></span> to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1"></a>table4a <span class="sc">|&gt;</span> </span>
<span id="cb402-2"><a href="#cb402-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"1999"</span>, <span class="st">"2000"</span>), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</div>
</section>
<section id="pivot-longer-1" class="slide level2">
<h2>Pivot longer</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1"></a>table4a <span class="sc">|&gt;</span> </span>
<span id="cb404-2"><a href="#cb404-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"1999"</span>, <span class="st">"2000"</span>),</span>
<span id="cb404-3"><a href="#cb404-3"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb404-4"><a href="#cb404-4"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/table4a.jpg"></p>
</div>
</div>
<ul>
<li><code>cols</code>: <span class="hl-yellow"><strong>name of the variables to pivot</strong></span>.</li>
<li><code>names_to</code>: name of the new variable to which we send the <span class="hl-yellow"><strong>header</strong></span> of the table (the names).</li>
<li><code>values_to</code>: name of the new variable to which we are going to send the <span class="hl-yellow"><strong>data</strong></span>.</li>
</ul>
</section>
<section id="messy-data-1" class="slide level2">
<h2>Messy data</h2>
<p>Let’s see another example with table <code>table2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="pivot-wider" class="slide level2">
<h2>Pivot wider</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>❎ Each <span class="hl-red"><strong>observation is divided into two rows</strong></span> → the <span class="hl-yellow"><strong>records with the same year should be the same</strong></span></p>
</div>
</div>
<div class="fragment">
<p>What we will do will be the opposite: with <code>pivot_wider()</code> <span class="hl-yellow"><strong>we will widen the table</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1"></a>table2 <span class="sc">|&gt;</span>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="messy-data-2" class="slide level2">
<h2>Messy data</h2>
<p>Let’s see another example with table <code>table3</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="separate" class="slide level2">
<h2>Separate</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<p>❎ Each <span class="hl-red"><strong>cell contains several values</strong></span></p>
</div>
</div>
<div class="fragment">
<p>What we will do is make use of the <code>separate()</code> function to send <span class="hl-yellow"><strong>separate each value</strong></span> to a different column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  pop       
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="separate-1" class="slide level2">
<h2>Separate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  pop       
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
<p>Notice that the data, although it has separated them, <span class="hl-red"><strong>kept them as text</strong></span> when in fact they should be numeric variables. For this we can add the optional argument <code>convert = TRUE</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1"></a>table3 <span class="sc">|&gt;</span> <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"pop"</span>), <span class="at">convert =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases        pop
  &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="messy-data-3" class="slide level2">
<h2>Messy data</h2>
<p>Let’s see the last example with table <code>table5</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="unite" class="slide level2">
<h2>Unite</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1"></a>table5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>❎ We have <span class="hl-red"><strong>same values divided in two columns</strong></span></p>
</div>
</div>
<div class="fragment">
<p>We will use <code>unite()</code> to <span class="hl-yellow"><strong>unite the values</strong></span> of century and year in the same column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1"></a>table5 <span class="sc">|&gt;</span> <span class="fu">unite</span>(<span class="at">col =</span> whole_year, century, year, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     whole_year rate             
  &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;            
1 Afghanistan 1999       745/19987071     
2 Afghanistan 2000       2666/20595360    
3 Brazil      1999       37737/172006362  
4 Brazil      2000       80488/174504898  
5 China       1999       212258/1272915272
6 China       2000       213766/1280428583</code></pre>
</div>
</div>
</div>
</section>
<section id="nest-data" class="slide level2">
<h2>Nest data</h2>
<p>We can also <span class="hl-yellow"><strong>nest datasets inside another one</strong></span>: imagine we have a dataset with variables <code>x</code> and <code>y</code>, with two records, another with one and another with 3 of them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1"></a>data <span class="ot">&lt;-</span></span>
<span id="cb427-2"><a href="#cb427-2"></a>  <span class="fu">tibble</span>(<span class="st">"dataset"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>), </span>
<span id="cb427-3"><a href="#cb427-3"></a>         <span class="st">"x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">7</span>),</span>
<span id="cb427-4"><a href="#cb427-4"></a>         <span class="st">"y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb427-5"><a href="#cb427-5"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  dataset     x     y
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1       1     0  -1  
2       1     2  NA  
3       2    NA   5  
4       3    -2   1.5
5       3     6  NA  
6       3     7  -2  </code></pre>
</div>
</div>
<p>In reality everything that has an equal value in <code>dataset</code> should form its own <code>tibble</code> so let’s create one inside the one we have</p>
</section>
<section id="nest-data-1" class="slide level2">
<h2>Nest data</h2>
<p>For it we will use the function <code>nest()</code> indicating it which variables form the datasets that will be nested (in this case variables <code>x</code> and <code>y</code>). Notice that inside what it stores is a variable of type list (since each dataset has a different length).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1"></a>data_nest <span class="ot">&lt;-</span></span>
<span id="cb429-2"><a href="#cb429-2"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb429-3"><a href="#cb429-3"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(x, y))</span>
<span id="cb429-4"><a href="#cb429-4"></a>data_nest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  dataset data            
    &lt;dbl&gt; &lt;list&gt;          
1       1 &lt;tibble [2 × 2]&gt;
2       2 &lt;tibble [1 × 2]&gt;
3       3 &lt;tibble [3 × 2]&gt;</code></pre>
</div>
</div>
</section>
<section id="nest-data-2" class="slide level2">
<h2>Nest data</h2>
<p>To <span class="hl-yellow"><strong>unnest</strong></span> just use the <code>unnest()</code> function indicating the column to unnest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1"></a>data_nest <span class="sc">|&gt;</span> <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  dataset     x     y
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1       1     0  -1  
2       1     2  NA  
3       2    NA   5  
4       3    -2   1.5
5       3     6  NA  
6       3     7  -2  </code></pre>
</div>
</div>
</section>
<section id="example-world-bank-pop" class="slide level2">
<h2>Example: world bank pop</h2>
<p>In the <code>{tidyr}</code> package we have the <code>world_bank_pop</code> dataset which contains data from the World Bank about population per country from 2000 to 2018.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb433-2"><a href="#cb433-2"></a>world_bank_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,064 × 20
   country indicator      `2000`  `2001`  `2002`  `2003`  `2004`  `2005`  `2006`
   &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 ABW     SP.URB.TOTL    4.16e4 4.20e+4 4.22e+4 4.23e+4 4.23e+4 4.24e+4 4.26e+4
 2 ABW     SP.URB.GROW    1.66e0 9.56e-1 4.01e-1 1.97e-1 9.46e-2 1.94e-1 3.67e-1
 3 ABW     SP.POP.TOTL    8.91e4 9.07e+4 9.18e+4 9.27e+4 9.35e+4 9.45e+4 9.56e+4
 4 ABW     SP.POP.GROW    2.54e0 1.77e+0 1.19e+0 9.97e-1 9.01e-1 1.00e+0 1.18e+0
 5 AFE     SP.URB.TOTL    1.16e8 1.20e+8 1.24e+8 1.29e+8 1.34e+8 1.39e+8 1.44e+8
 6 AFE     SP.URB.GROW    3.60e0 3.66e+0 3.72e+0 3.71e+0 3.74e+0 3.81e+0 3.81e+0
 7 AFE     SP.POP.TOTL    4.02e8 4.12e+8 4.23e+8 4.34e+8 4.45e+8 4.57e+8 4.70e+8
 8 AFE     SP.POP.GROW    2.58e0 2.59e+0 2.61e+0 2.62e+0 2.64e+0 2.67e+0 2.70e+0
 9 AFG     SP.URB.TOTL    4.31e6 4.36e+6 4.67e+6 5.06e+6 5.30e+6 5.54e+6 5.83e+6
10 AFG     SP.URB.GROW    1.86e0 1.15e+0 6.86e+0 7.95e+0 4.59e+0 4.47e+0 5.03e+0
# ℹ 1,054 more rows
# ℹ 11 more variables: `2007` &lt;dbl&gt;, `2008` &lt;dbl&gt;, `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;,
#   `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;,
#   `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>What could be wrong?</strong></span></p>
</section>
<section id="example-world-bank-pop-1" class="slide level2">
<h2>Example: world bank pop</h2>
<p>First of all, we can see that we effectively have the same variable in 18 columns: population.</p>
<div class="fragment">
<p>What we should have is a column called <code>pop</code> with these values and another <code>year</code> indicating to which year corresponds the measurement. And for this we will do it with <code>pivot_longer()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1"></a>world_bank_pop_tidy <span class="ot">&lt;-</span></span>
<span id="cb435-2"><a href="#cb435-2"></a>  world_bank_pop <span class="sc">|&gt;</span> </span>
<span id="cb435-3"><a href="#cb435-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>(country<span class="sc">:</span>indicator), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb435-4"><a href="#cb435-4"></a>world_bank_pop_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19,152 × 4
   country indicator   year  value
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt;
 1 ABW     SP.URB.TOTL 2000  41625
 2 ABW     SP.URB.TOTL 2001  42025
 3 ABW     SP.URB.TOTL 2002  42194
 4 ABW     SP.URB.TOTL 2003  42277
 5 ABW     SP.URB.TOTL 2004  42317
 6 ABW     SP.URB.TOTL 2005  42399
 7 ABW     SP.URB.TOTL 2006  42555
 8 ABW     SP.URB.TOTL 2007  42729
 9 ABW     SP.URB.TOTL 2008  42906
10 ABW     SP.URB.TOTL 2009  43079
# ℹ 19,142 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="example-world-bank-pop-2" class="slide level2">
<h2>Example: world bank pop</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1"></a>world_bank_pop_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19,152 × 4
   country indicator   year  value
   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt;
 1 ABW     SP.URB.TOTL 2000  41625
 2 ABW     SP.URB.TOTL 2001  42025
 3 ABW     SP.URB.TOTL 2002  42194
 4 ABW     SP.URB.TOTL 2003  42277
 5 ABW     SP.URB.TOTL 2004  42317
 6 ABW     SP.URB.TOTL 2005  42399
 7 ABW     SP.URB.TOTL 2006  42555
 8 ABW     SP.URB.TOTL 2007  42729
 9 ABW     SP.URB.TOTL 2008  42906
10 ABW     SP.URB.TOTL 2009  43079
# ℹ 19,142 more rows</code></pre>
</div>
</div>
<p><span class="hl-red"><strong>Is everything correct?</strong></span></p>
<div class="fragment">
<p>If you notice we have two types of population measures, total <code>...TOTL</code> and its growth <code>...GROW</code>, but in addition we have them for each country in global <code>SP.POP...</code> and only in urban area <code>SP.URB...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1"></a><span class="fu">unique</span>(world_bank_pop_tidy<span class="sc">$</span>indicator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SP.URB.TOTL" "SP.URB.GROW" "SP.POP.TOTL" "SP.POP.GROW"</code></pre>
</div>
</div>
</div>
</section>
<section id="example-world-bank-pop-3" class="slide level2">
<h2>Example: world bank pop</h2>
<p>What should be done?</p>
<div class="fragment">
<p>We will separate this variable into 3: one for the prefix <code>SP</code> (which we will eliminate later), one for the area (<code>POP/URB</code>) and one for the value (<code>variable</code>), which can be total or growth.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1"></a>world_bank_pop_tidy2 <span class="ot">&lt;-</span></span>
<span id="cb441-2"><a href="#cb441-2"></a>  world_bank_pop_tidy <span class="sc">|&gt;</span></span>
<span id="cb441-3"><a href="#cb441-3"></a>  <span class="fu">separate</span>(indicator, <span class="fu">c</span>(<span class="st">"dummy"</span>, <span class="st">"area"</span>, <span class="st">"variable"</span>))</span>
<span id="cb441-4"><a href="#cb441-4"></a>world_bank_pop_tidy2<span class="sc">$</span>dummy <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb441-5"><a href="#cb441-5"></a>world_bank_pop_tidy2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19,152 × 5
   country area  variable year  value
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
 1 ABW     URB   TOTL     2000  41625
 2 ABW     URB   TOTL     2001  42025
 3 ABW     URB   TOTL     2002  42194
 4 ABW     URB   TOTL     2003  42277
 5 ABW     URB   TOTL     2004  42317
 6 ABW     URB   TOTL     2005  42399
 7 ABW     URB   TOTL     2006  42555
 8 ABW     URB   TOTL     2007  42729
 9 ABW     URB   TOTL     2008  42906
10 ABW     URB   TOTL     2009  43079
# ℹ 19,142 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="example-world-bank-pop-4" class="slide level2">
<h2>Example: world bank pop</h2>
<p>This can be done in a simpler way by indicating in the variable that we want to eliminate that it is <code>NA</code> inside <code>separate()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1"></a>world_bank_pop_tidy <span class="ot">&lt;-</span></span>
<span id="cb443-2"><a href="#cb443-2"></a>  world_bank_pop_tidy <span class="sc">|&gt;</span></span>
<span id="cb443-3"><a href="#cb443-3"></a>  <span class="fu">separate</span>(indicator, <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"area"</span>, <span class="st">"variable"</span>))</span>
<span id="cb443-4"><a href="#cb443-4"></a>world_bank_pop_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19,152 × 5
   country area  variable year  value
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
 1 ABW     URB   TOTL     2000  41625
 2 ABW     URB   TOTL     2001  42025
 3 ABW     URB   TOTL     2002  42194
 4 ABW     URB   TOTL     2003  42277
 5 ABW     URB   TOTL     2004  42317
 6 ABW     URB   TOTL     2005  42399
 7 ABW     URB   TOTL     2006  42555
 8 ABW     URB   TOTL     2007  42729
 9 ABW     URB   TOTL     2008  42906
10 ABW     URB   TOTL     2009  43079
# ℹ 19,142 more rows</code></pre>
</div>
</div>
<div class="fragment">
<p>Have we got it yet? Think carefully: does each variable have its own column?</p>
</div>
</section>
<section id="example-world-bank-pop-5" class="slide level2">
<h2>Example: world bank pop</h2>
<p>If you actually look at the total population and growth variables, they should be different variables, since they even have different units: one is inhabitants, the other is percentage points.</p>
<div class="fragment">
<p>To do the reverse of the initial operation, <code>pivot_wider()</code> (later we will use a tremendously useful function, <code>{janitor}</code>’s <code>clean_names()</code> which unifies variable names).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1"></a>world_bank_pop_tidy <span class="ot">&lt;-</span></span>
<span id="cb445-2"><a href="#cb445-2"></a>  world_bank_pop_tidy <span class="sc">|&gt;</span></span>
<span id="cb445-3"><a href="#cb445-3"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"variable"</span>, <span class="at">values_from =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb445-4"><a href="#cb445-4"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb445-5"><a href="#cb445-5"></a>world_bank_pop_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,576 × 5
   country area  year   totl   grow
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 ABW     URB   2000  41625 1.66  
 2 ABW     URB   2001  42025 0.956 
 3 ABW     URB   2002  42194 0.401 
 4 ABW     URB   2003  42277 0.197 
 5 ABW     URB   2004  42317 0.0946
 6 ABW     URB   2005  42399 0.194 
 7 ABW     URB   2006  42555 0.367 
 8 ABW     URB   2007  42729 0.408 
 9 ABW     URB   2008  42906 0.413 
10 ABW     URB   2009  43079 0.402 
# ℹ 9,566 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="example-world-bank-pop-6" class="slide level2">
<h2>Example: world bank pop</h2>
<p>The complete code would be this: short, concise, readable and self-descriptive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1"></a>world_bank_pop_tidy <span class="ot">&lt;-</span></span>
<span id="cb447-2"><a href="#cb447-2"></a>  world_bank_pop <span class="sc">|&gt;</span> </span>
<span id="cb447-3"><a href="#cb447-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>(country<span class="sc">:</span>indicator), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb447-4"><a href="#cb447-4"></a>  <span class="fu">separate</span>(indicator, <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"area"</span>, <span class="st">"variable"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb447-5"><a href="#cb447-5"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"variable"</span>, <span class="at">values_from =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb447-6"><a href="#cb447-6"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb447-7"><a href="#cb447-7"></a>world_bank_pop_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,576 × 5
   country area  year   totl   grow
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 ABW     URB   2000  41625 1.66  
 2 ABW     URB   2001  42025 0.956 
 3 ABW     URB   2002  42194 0.401 
 4 ABW     URB   2003  42277 0.197 
 5 ABW     URB   2004  42317 0.0946
 6 ABW     URB   2005  42399 0.194 
 7 ABW     URB   2006  42555 0.367 
 8 ABW     URB   2007  42729 0.408 
 9 ABW     URB   2008  42906 0.413 
10 ABW     URB   2009  43079 0.402 
# ℹ 9,566 more rows</code></pre>
</div>
</div>
</section>
<section id="example-who-dataset" class="slide level2">
<h2>Example: who dataset</h2>
<p>In<code>{tidyr}</code> package we have <code>who2</code> dataset (World Health Organization dataset)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb449-2"><a href="#cb449-2"></a>who2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,240 × 58
   country      year sp_m_014 sp_m_1524 sp_m_2534 sp_m_3544 sp_m_4554 sp_m_5564
   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  1980       NA        NA        NA        NA        NA        NA
 2 Afghanistan  1981       NA        NA        NA        NA        NA        NA
 3 Afghanistan  1982       NA        NA        NA        NA        NA        NA
 4 Afghanistan  1983       NA        NA        NA        NA        NA        NA
 5 Afghanistan  1984       NA        NA        NA        NA        NA        NA
 6 Afghanistan  1985       NA        NA        NA        NA        NA        NA
 7 Afghanistan  1986       NA        NA        NA        NA        NA        NA
 8 Afghanistan  1987       NA        NA        NA        NA        NA        NA
 9 Afghanistan  1988       NA        NA        NA        NA        NA        NA
10 Afghanistan  1989       NA        NA        NA        NA        NA        NA
# ℹ 7,230 more rows
# ℹ 50 more variables: sp_m_65 &lt;dbl&gt;, sp_f_014 &lt;dbl&gt;, sp_f_1524 &lt;dbl&gt;,
#   sp_f_2534 &lt;dbl&gt;, sp_f_3544 &lt;dbl&gt;, sp_f_4554 &lt;dbl&gt;, sp_f_5564 &lt;dbl&gt;,
#   sp_f_65 &lt;dbl&gt;, sn_m_014 &lt;dbl&gt;, sn_m_1524 &lt;dbl&gt;, sn_m_2534 &lt;dbl&gt;,
#   sn_m_3544 &lt;dbl&gt;, sn_m_4554 &lt;dbl&gt;, sn_m_5564 &lt;dbl&gt;, sn_m_65 &lt;dbl&gt;,
#   sn_f_014 &lt;dbl&gt;, sn_f_1524 &lt;dbl&gt;, sn_f_2534 &lt;dbl&gt;, sn_f_3544 &lt;dbl&gt;,
#   sn_f_4554 &lt;dbl&gt;, sn_f_5564 &lt;dbl&gt;, sn_f_65 &lt;dbl&gt;, ep_m_014 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p><strong>Is it tidy data? Why?</strong></p>
</section>
<section id="example-who-dataset-1" class="slide level2">
<h2>Example: who dataset</h2>
<p>First step for tidy data: we must pivot the table (tip: use paper and pen to sketch how the database should look like) so that there is a column called <code>cases</code> (since all columns starting from <code>year</code> is actually the same, cases of a disease).</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb451-2"><a href="#cb451-2"></a>  who2 <span class="sc">|&gt;</span> </span>
<span id="cb451-3"><a href="#cb451-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>(country<span class="sc">:</span>year), <span class="at">names_to =</span> <span class="st">"type"</span>, <span class="at">values_to =</span> <span class="st">"cases"</span>)</span>
<span id="cb451-4"><a href="#cb451-4"></a>who_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 405,440 × 4
   country      year type      cases
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 Afghanistan  1980 sp_m_014     NA
 2 Afghanistan  1980 sp_m_1524    NA
 3 Afghanistan  1980 sp_m_2534    NA
 4 Afghanistan  1980 sp_m_3544    NA
 5 Afghanistan  1980 sp_m_4554    NA
 6 Afghanistan  1980 sp_m_5564    NA
 7 Afghanistan  1980 sp_m_65      NA
 8 Afghanistan  1980 sp_f_014     NA
 9 Afghanistan  1980 sp_f_1524    NA
10 Afghanistan  1980 sp_f_2534    NA
# ℹ 405,430 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="example-who-dataset-2" class="slide level2">
<h2>Example: who dataset</h2>
<p>If you notice there are a lot of rows that do not make sense to keep because we have no cases! Investigate the <code>pivot_longer()</code> options to see how we can directly remove them in the pivot.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb453-2"><a href="#cb453-2"></a>  who2 <span class="sc">|&gt;</span> </span>
<span id="cb453-3"><a href="#cb453-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>(country<span class="sc">:</span>year), <span class="at">names_to =</span> <span class="st">"type"</span>, <span class="at">values_to =</span> <span class="st">"cases"</span>,</span>
<span id="cb453-4"><a href="#cb453-4"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span>
<span id="cb453-5"><a href="#cb453-5"></a>who_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 76,046 × 4
   country      year type      cases
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
 1 Afghanistan  1997 sp_m_014      0
 2 Afghanistan  1997 sp_m_1524    10
 3 Afghanistan  1997 sp_m_2534     6
 4 Afghanistan  1997 sp_m_3544     3
 5 Afghanistan  1997 sp_m_4554     5
 6 Afghanistan  1997 sp_m_5564     2
 7 Afghanistan  1997 sp_m_65       0
 8 Afghanistan  1997 sp_f_014      5
 9 Afghanistan  1997 sp_f_1524    38
10 Afghanistan  1997 sp_f_2534    36
# ℹ 76,036 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="example-who-dataset-3" class="slide level2">
<h2>Example: who dataset</h2>
<p>Now in <code>type</code> we have coded the information as <code>diagnosis_sex_age</code>. How to separate it in 3 columns? Investigate both <code>separate()</code> and <code>pivot_longer()</code> options.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1"></a><span class="co"># separate</span></span>
<span id="cb455-2"><a href="#cb455-2"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb455-3"><a href="#cb455-3"></a>  who_tidy <span class="sc">|&gt;</span> </span>
<span id="cb455-4"><a href="#cb455-4"></a>  <span class="fu">separate</span>(<span class="at">col =</span> <span class="st">"type"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"sex"</span>, <span class="st">"age"</span>))</span>
<span id="cb455-5"><a href="#cb455-5"></a></span>
<span id="cb455-6"><a href="#cb455-6"></a><span class="co"># pivot_longer</span></span>
<span id="cb455-7"><a href="#cb455-7"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb455-8"><a href="#cb455-8"></a>  who2 <span class="sc">|&gt;</span> </span>
<span id="cb455-9"><a href="#cb455-9"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>(country<span class="sc">:</span>year), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"sex"</span>, <span class="st">"age"</span>),</span>
<span id="cb455-10"><a href="#cb455-10"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>, <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>,</span>
<span id="cb455-11"><a href="#cb455-11"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>)</span>
<span id="cb455-12"><a href="#cb455-12"></a>who_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 76,046 × 6
   country      year diagnosis sex   age   cases
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
 1 Afghanistan  1997 sp        m     014       0
 2 Afghanistan  1997 sp        m     1524     10
 3 Afghanistan  1997 sp        m     2534      6
 4 Afghanistan  1997 sp        m     3544      3
 5 Afghanistan  1997 sp        m     4554      5
 6 Afghanistan  1997 sp        m     5564      2
 7 Afghanistan  1997 sp        m     65        0
 8 Afghanistan  1997 sp        f     014       5
 9 Afghanistan  1997 sp        f     1524     38
10 Afghanistan  1997 sp        f     2534     36
# ℹ 76,036 more rows</code></pre>
</div>
</div>
</section>
<section id="example-who-dataset-4" class="slide level2">
<h2>Example: who dataset</h2>
<p>Finally, separate in two (<code>age_inf</code>, <code>age_sup</code>) the age range (which are numbers). Think about how to do it since it is not always 4 numbers (if there is no upper age range defined, put <code>Inf</code> as an upper bound).</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1"></a>who_tidy <span class="ot">&lt;-</span></span>
<span id="cb457-2"><a href="#cb457-2"></a>  who_tidy <span class="sc">|&gt;</span> </span>
<span id="cb457-3"><a href="#cb457-3"></a>  <span class="fu">separate</span>(<span class="at">col =</span> <span class="st">"age"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"age_inf"</span>, <span class="st">"age_sup"</span>), <span class="at">sep =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb457-4"><a href="#cb457-4"></a>who_tidy<span class="sc">$</span>age_inf <span class="ot">&lt;-</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(who_tidy<span class="sc">$</span>age_inf), <span class="dv">65</span>, who_tidy<span class="sc">$</span>age_inf)</span>
<span id="cb457-5"><a href="#cb457-5"></a>who_tidy<span class="sc">$</span>age_sup <span class="ot">&lt;-</span> <span class="fu">if_else</span>(who_tidy<span class="sc">$</span>age_sup <span class="sc">==</span> <span class="dv">65</span>, <span class="cn">Inf</span>, who_tidy<span class="sc">$</span>age_sup)</span>
<span id="cb457-6"><a href="#cb457-6"></a>who_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 76,046 × 7
   country      year diagnosis sex   age_inf age_sup cases
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 Afghanistan  1997 sp        m           0      14     0
 2 Afghanistan  1997 sp        m          15      24    10
 3 Afghanistan  1997 sp        m          25      34     6
 4 Afghanistan  1997 sp        m          35      44     3
 5 Afghanistan  1997 sp        m          45      54     5
 6 Afghanistan  1997 sp        m          55      64     2
 7 Afghanistan  1997 sp        m          65     Inf     0
 8 Afghanistan  1997 sp        f           0      14     5
 9 Afghanistan  1997 sp        f          15      24    38
10 Afghanistan  1997 sp        f          25      34    36
# ℹ 76,036 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-1-2" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-8-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-8-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-8-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-8-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<p>📝 Use the original <code>who2</code> dataset from the <code>{tidyr}</code> package and try to answer the question: how many cases of tuberculosis were there in Spain in 1995 among women? Do it without converting it to tidydata. After that, pivot in a simple way and compare the code to be done when we have tidydata to when we don’t. Which one is more readable if you didn’t know <code>R</code>? Which one has higher error probability?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1"></a><span class="co"># messy data</span></span>
<span id="cb459-2"><a href="#cb459-2"></a><span class="fu">sum</span>(who2[who2<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Spain"</span> <span class="sc">&amp;</span> who2<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1995</span>,</span>
<span id="cb459-3"><a href="#cb459-3"></a>     <span class="fu">names</span>(who2)[<span class="fu">str_detect</span>(<span class="fu">names</span>(who2), <span class="st">"f_"</span>)]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb459-4"><a href="#cb459-4"></a></span>
<span id="cb459-5"><a href="#cb459-5"></a><span class="co"># tidy data (at this moment)</span></span>
<span id="cb459-6"><a href="#cb459-6"></a><span class="fu">sum</span>(who_tidy[who_tidy<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Spain"</span> <span class="sc">&amp;</span></span>
<span id="cb459-7"><a href="#cb459-7"></a>           who_tidy<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1995</span> <span class="sc">&amp;</span></span>
<span id="cb459-8"><a href="#cb459-8"></a>           who_tidy<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"f"</span>, ]<span class="sc">$</span>cases)</span>
<span id="cb459-9"><a href="#cb459-9"></a></span>
<span id="cb459-10"><a href="#cb459-10"></a><span class="co"># in the future</span></span>
<span id="cb459-11"><a href="#cb459-11"></a>who_tidy <span class="sc">|&gt;</span> </span>
<span id="cb459-12"><a href="#cb459-12"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Spain"</span> <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">1995</span> <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">"f"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb459-13"><a href="#cb459-13"></a>  <span class="fu">summarise</span>(<span class="fu">sum</span>(cases))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-2">
<p>📝 Using <code>who_tidy</code> determine which sex has had more cases, men or women? Create a new variable <code>avg_age</code> (mean age of the interval): if the range is 25 to 34, the mean age will be <span class="math inline">\((25 + 34)/2 = 29.5\)</span> (if <code>Inf</code> above, <code>NA</code>)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1"></a><span class="co"># f vs m</span></span>
<span id="cb460-2"><a href="#cb460-2"></a><span class="fu">sum</span>(who_tidy[who_tidy<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"m"</span>, ]<span class="sc">$</span>cases)</span>
<span id="cb460-3"><a href="#cb460-3"></a><span class="fu">sum</span>(who_tidy[who_tidy<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"f"</span>, ]<span class="sc">$</span>cases)</span>
<span id="cb460-4"><a href="#cb460-4"></a></span>
<span id="cb460-5"><a href="#cb460-5"></a><span class="co"># ave age</span></span>
<span id="cb460-6"><a href="#cb460-6"></a>who_tidy<span class="sc">$</span>ave_age <span class="ot">&lt;-</span> </span>
<span id="cb460-7"><a href="#cb460-7"></a>  <span class="fu">if_else</span>(<span class="fu">is.infinite</span>(who_tidy<span class="sc">$</span>age_sup), <span class="cn">NA</span>, (who_tidy<span class="sc">$</span>age_inf <span class="sc">+</span> who_tidy<span class="sc">$</span>age_sup)<span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-3">
<p>📝 If we must choose a country in which we have the lowest probability of infection, which country, between the United Kingdom (<code>United Kingdom of Great Britain and Northern Ireland</code>) and France (similar population), had the fewest cases in the most recent year (whichever it was, even if the table was updated)?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1"></a>last_cases <span class="ot">&lt;-</span> who_tidy[who_tidy<span class="sc">$</span>year <span class="sc">==</span> <span class="fu">max</span>(who_tidy<span class="sc">$</span>year), ]</span>
<span id="cb461-2"><a href="#cb461-2"></a><span class="fu">sum</span>(last_cases[last_cases<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"United Kingdom of Great Britain and Northern Ireland"</span>, <span class="st">"cases"</span>])</span>
<span id="cb461-3"><a href="#cb461-3"></a><span class="fu">sum</span>(last_cases[last_cases<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"France"</span>, <span class="st">"cases"</span>])</span>
<span id="cb461-4"><a href="#cb461-4"></a><span class="co"># better France</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-4">
<p>📝 Take a look at table <code>table4b</code> in package <code>{tidyr}</code>. Is it tidydata? If not, what is wrong, how to convert it to tidy data in case it is not already?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1"></a>table4b <span class="sc">|&gt;</span></span>
<span id="cb462-2"><a href="#cb462-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"1999"</span><span class="sc">:</span><span class="st">"2000"</span>, <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb462-3"><a href="#cb462-3"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-8-5">
<p>📝 Take a look at the <code>billboard</code> table in the <code>{tidyr}</code> package. Is it tidydata? If not, what is wrong, how to convert it to tidy data in case it is not already?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1"></a>billboard <span class="sc">|&gt;</span></span>
<span id="cb463-2"><a href="#cb463-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"wk1"</span><span class="sc">:</span><span class="st">"wk76"</span>,</span>
<span id="cb463-3"><a href="#cb463-3"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>,</span>
<span id="cb463-4"><a href="#cb463-4"></a>               <span class="at">names_prefix =</span> <span class="st">"wk"</span>,</span>
<span id="cb463-5"><a href="#cb463-5"></a>               <span class="at">values_to =</span> <span class="st">"position"</span>,</span>
<span id="cb463-6"><a href="#cb463-6"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-1" class="slide level2">
<h2>🐣 Case study</h2>
<p>Let’s perform a case study with the <code>relig_income</code> table in <code>{tidyr}</code> package. As indicated (<code>? relig_income</code>), the table represents the number of people in each annual income bracket (20k = 20 000$) and in each religion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1"></a>relig_income</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/tidy-data-mucss"><strong>workbook</strong></a></p>
</section></section>
<section>
<section id="clase-2" class="title-slide slide level1 center">
<h1>L2: <span class="flow">tidyverse (rows)</span></h1>
<p><span style="color:#444442;"><strong>Tidyverse: actions by rows</strong></span></p>
<ul>
<li><p><a href="#/tu-turno-2-1">💻 Solved exercises: filter</a></p></li>
<li><p><a href="#/tu-turno-2-2">💻 Solved exercises: slice, sample, arrange</a></p></li>
<li><p><a href="#/caso-practico-2">🐣 Workbook/caso study</a></p></li>
<li><p><a href="#/planificacion-curso">📆 Planning</a></p></li>
</ul>
</section>
<section id="preprocessing-dplyr" class="slide level2">
<h2>Preprocessing: dplyr</h2>
<p>Within <code>{tidyverse}</code> we will use the <code>{dplyr}</code> package for the <span class="hl-yellow"><strong>preprocessing process</strong></span> of the data.</p>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/dplyr.png" width="450"></p>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb465-2"><a href="#cb465-2"></a>  <span class="fu">tidy</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb465-3"><a href="#cb465-3"></a>  <span class="fu">filter</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb465-4"><a href="#cb465-4"></a>  <span class="fu">select</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb465-5"><a href="#cb465-5"></a>  <span class="fu">arrange</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb465-6"><a href="#cb465-6"></a>  <span class="fu">modify</span>(...) <span class="sc">|&gt;</span> <span class="co"># mutate in the code</span></span>
<span id="cb465-7"><a href="#cb465-7"></a>  <span class="fu">rename</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb465-8"><a href="#cb465-8"></a>  <span class="fu">group</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb465-9"><a href="#cb465-9"></a>  <span class="fu">count</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb465-10"><a href="#cb465-10"></a>  <span class="fu">summarise</span>(...) <span class="sc">|&gt;</span></span>
<span id="cb465-11"><a href="#cb465-11"></a>  <span class="fu">plot</span>(...) <span class="co"># actually ggplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The idea is that the <span class="hl-yellow"><strong>code is as readable as possible</strong></span>, as if it were a <strong>list of instructions</strong> that when read tells us in a very obvious way what it is doing.</p>
</section>
<section id="assumption-tidydata" class="slide level2">
<h2>Assumption: tidydata</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>All the preprocessing process we are going to perform is on the <span class="hl-yellow"><strong>assumption that our data is in tidydata</strong></span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidy_def.jpg" style="width:160.0%"></p>
</div>
</div>
<p>Remember that in <code>{tidyverse}</code> the <span class="hl-yellow"><strong>pipe operator</strong></span> defined as <code>|&gt;</code> (<span class="hl-purple"><strong>ctrl+shift+M</strong></span>) will be key: it will be a <span class="hl-yellow"><strong>pipe that traverses the data</strong></span> and transforms it.</p>
<div class="fragment">
<p>Let us practice with the <code>starwars</code> dataset from the <code>{dplyr}</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb466-2"><a href="#cb466-2"></a>starwars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="sampling" class="slide level2">
<h2>Sampling</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>One of the most common operations is what is known in statistics as <span class="hl-yellow"><strong>sampling</strong></span>: a <span class="hl-yellow"><strong>selection or filtering of records (rows)</strong></span> (a subsample).</p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/muestreo.jpeg" width="500"></p>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Non-random (by quota)</strong></span>: based on logical conditions on the records (<code>filter()</code>).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Non-random (intentional/discretionary)</strong></span>: based on a position (<code>slice()</code>).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Simple random</strong></span> (<code>slice_sample()</code>).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Stratified</strong></span> (<code>group_by()</code> + <code>slice_sample()</code>).</li>
</ul>
</div>
</section>
<section id="filter-rows-filter" class="slide level2">
<h2>Filter rows: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb467-2"><a href="#cb467-2"></a>  <span class="fu">filtro</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb468-2"><a href="#cb468-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The simplest action by rows is when <span class="hl-yellow"><strong>filter records</strong></span> based on some logical condition: with <code>filter()</code> only individuals meeting certain conditions will be selected (non-random sampling by conditions).</p>
<div>
<ul>
<li class="fragment"><code>==</code>, <code>!=</code>: <span class="hl-purple"><strong>equal</strong></span> or <span class="hl-yellow"><strong>different</strong></span> to (<code>|&gt; filter(variable == "a")</code>)</li>
<li class="fragment"><code>&gt;</code>, <code>&lt;</code>: <span class="hl-purple"><strong>greater</strong></span> or <span class="hl-yellow"><strong>less</strong></span> than (<code>|&gt; filter(variable &lt; 3)</code>)</li>
<li class="fragment"><code>&gt;=</code>, <code>&lt;=</code>: <span class="hl-yellow"><strong>greater or equal</strong></span> or <span class="hl-purple"><strong>less or equal</strong></span> than (<code>|&gt; filter(variable &gt;= 5)</code>)</li>
<li class="fragment"><code>%in%</code>: values <span class="hl-yellow"><strong>belong</strong></span> to a set of discrete options (<code>|&gt; filter(variable %in% c("blue", "green"))</code>)</li>
<li class="fragment"><code>between(variable, val1, val2)</code>: if continuous values are <span class="hl-yellow"><strong>inside of a range</strong></span> (<code>|&gt; filter(between(variable, 160, 180))</code>)</li>
</ul>
</div>
</section>
<section id="filter-rows-filter-1" class="slide level2">
<h2>Filter rows: filter()</h2>
<p>These <span class="hl-yellow"><strong>logical conditions</strong></span> can be <span class="hl-yellow"><strong>combined</strong></span> in different ways (and, or, or mutually exclusive).</p>

<img data-src="img/tablas_verdad.png" class="r-stretch"><div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Remember that inside <code>filter()</code> there must always be something that returns a <span class="hl-green"><strong>vector of logical values</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="filter-rows-filter-2" class="slide level2">
<h2>Filter rows: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb469-2"><a href="#cb469-2"></a>  <span class="fu">filtro</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb470-2"><a href="#cb470-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you go about… <span class="hl-yellow"><strong>filter</strong></span> the characters with <span class="hl-purple"><strong>brown eyes</strong></span>?</p>
<div class="fragment">
<p><span class="hl-yellow"><strong>What type of variable is it?</strong></span> –&gt; The <code>eye_color</code> variable is qualitative so it is represented by texts.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb471-2"><a href="#cb471-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Leia Or…    150  49   brown      light      brown           19   fema… femin…
 2 Biggs D…    183  84   black      light      brown           24   male  mascu…
 3 Han Solo    180  80   brown      fair       brown           29   male  mascu…
 4 Yoda         66  17   white      green      brown          896   male  mascu…
 5 Boba Fe…    183  78.2 black      fair       brown           31.5 male  mascu…
 6 Lando C…    177  79   black      dark       brown           31   male  mascu…
 7 Arvel C…     NA  NA   brown      fair       brown           NA   male  mascu…
 8 Wicket …     88  20   brown      brown      brown            8   male  mascu…
 9 Padmé A…    185  45   brown      light      brown           46   fema… femin…
10 Quarsh …    183  NA   black      dark       brown           62   male  mascu…
# ℹ 11 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filter-rows-filter-3" class="slide level2">
<h2>Filter rows: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb473-2"><a href="#cb473-2"></a>  <span class="fu">filtro</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb474"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb474-2"><a href="#cb474-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you go about… <span class="hl-yellow"><strong>filter</strong></span> the characters that <span class="hl-purple"><strong>do not have brown eyes</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb475-2"><a href="#cb475-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">!=</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 66 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 6 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 7 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 8 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
 9 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
10 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
# ℹ 56 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filter-rows-filter-4" class="slide level2">
<h2>Filter rows: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb477-2"><a href="#cb477-2"></a>  <span class="fu">filtro</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb478-2"><a href="#cb478-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you go about … <span class="hl-yellow"><strong>filter</strong></span> characters that <span class="hl-purple"><strong>have brown or blue eyes</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb479-2"><a href="#cb479-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"brown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 3 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 4 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 5 Biggs D…    183    84 black      light      brown           24   male  mascu…
 6 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
 7 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
 8 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
 9 Han Solo    180    80 brown      fair       brown           29   male  mascu…
10 Jek Ton…    180   110 brown      fair       blue            NA   &lt;NA&gt;  &lt;NA&gt;  
# ℹ 30 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filter-rows-filter-5" class="slide level2">
<h2>Filter rows: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb481-2"><a href="#cb481-2"></a>  <span class="fu">filtro</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb482-2"><a href="#cb482-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Note that <code>%in%</code> is equivalent to concatenating several <code>==</code> with a conjunction or (<code>|</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb483-2"><a href="#cb483-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"blue"</span> <span class="sc">|</span> eye_color <span class="sc">==</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 3 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 4 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 5 Biggs D…    183    84 black      light      brown           24   male  mascu…
 6 Anakin …    188    84 blond      fair       blue            41.9 male  mascu…
 7 Wilhuff…    180    NA auburn, g… fair       blue            64   male  mascu…
 8 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
 9 Han Solo    180    80 brown      fair       brown           29   male  mascu…
10 Jek Ton…    180   110 brown      fair       blue            NA   &lt;NA&gt;  &lt;NA&gt;  
# ℹ 30 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="filter-rows-filter-6" class="slide level2">
<h2>Filter rows: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb485-2"><a href="#cb485-2"></a>  <span class="fu">filtro</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb486"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb486-2"><a href="#cb486-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you go about … <span class="hl-yellow"><strong>filter</strong></span> the characters that <span class="hl-purple"><strong>are between 120 and 160 cm</strong></span>?</p>
<div class="fragment">
<p><span class="hl-yellow"><strong>What type of variable is it?</strong></span> –&gt; The variable <code>height</code> is a continuous quantitative variable so we must filter by ranges of values (intervals) –&gt; we will use <code>between()</code>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb487-2"><a href="#cb487-2"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(height, <span class="dv">120</span>, <span class="dv">160</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Leia Org…    150    49 brown      light      brown             19 fema… femin…
2 Mon Moth…    150    NA auburn     fair       blue              48 fema… femin…
3 Nien Nunb    160    68 none       grey       black             NA male  mascu…
4 Watto        137    NA black      blue, grey yellow            NA male  mascu…
5 Gasgano      122    NA none       white, bl… black             NA male  mascu…
6 Cordé        157    NA brown      light      brown             NA &lt;NA&gt;  &lt;NA&gt;  
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filter-rows-filter-7" class="slide level2">
<h2>Filter rows: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb489"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb489-2"><a href="#cb489-2"></a>  <span class="fu">filtro</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb490-2"><a href="#cb490-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you… <span class="hl-yellow"><strong>filter</strong></span> characters that <span class="hl-purple"><strong>have eyes and are not human</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb491"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb491-2"><a href="#cb491-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span> <span class="sc">&amp;</span> species <span class="sc">!=</span> <span class="st">"Human"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yoda          66    17 white      green      brown            896 male  mascu…
2 Wicket S…     88    20 brown      brown      brown              8 male  mascu…
3 Eeth Koth    171    NA black      brown      brown             NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="filter-rows-filter-8" class="slide level2">
<h2>Filter rows: filter()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb493-2"><a href="#cb493-2"></a>  <span class="fu">filtro</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb494"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb494-2"><a href="#cb494-2"></a>  <span class="fu">filter</span>(condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>How would you… <span class="hl-yellow"><strong>filter</strong></span> characters that <span class="hl-purple"><strong>have eyes and are not human, or are over 60 years old</strong></span>? Think it through: the <span class="hl-yellow"><strong>parentheses are important</strong></span>: <span class="math inline">\((a+b)*c\)</span> is not the same as <span class="math inline">\(a+(b*c)\)</span>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb495-2"><a href="#cb495-2"></a>  <span class="fu">filter</span>((eye_color <span class="sc">==</span> <span class="st">"brown"</span> <span class="sc">&amp;</span> species <span class="sc">!=</span> <span class="st">"Human"</span>) <span class="sc">|</span> birth_year <span class="sc">&gt;</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 C-3PO       167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
 2 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…
 3 Chewbac…    228   112 brown      unknown    blue             200 male  mascu…
 4 Jabba D…    175  1358 &lt;NA&gt;       green-tan… orange           600 herm… mascu…
 5 Yoda         66    17 white      green      brown            896 male  mascu…
 6 Palpati…    170    75 grey       pale       yellow            82 male  mascu…
 7 Wicket …     88    20 brown      brown      brown              8 male  mascu…
 8 Qui-Gon…    193    89 brown      fair       blue              92 male  mascu…
 9 Finis V…    170    NA blond      fair       blue              91 male  mascu…
10 Quarsh …    183    NA black      dark       brown             62 male  mascu…
11 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…
12 Mace Wi…    188    84 none       dark       brown             72 male  mascu…
13 Ki-Adi-…    198    82 white      pale       yellow            92 male  mascu…
14 Eeth Ko…    171    NA black      brown      brown             NA male  mascu…
15 Cliegg …    183    NA brown      fair       blue              82 male  mascu…
16 Dooku       193    80 white      fair       brown            102 male  mascu…
17 Bail Pr…    191    NA black      tan        brown             67 male  mascu…
18 Jango F…    183    79 black      tan        brown             66 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="drop-missings-drop_na" class="slide level2">
<h2>Drop missings: drop_na()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb497-2"><a href="#cb497-2"></a>  <span class="fu">drop_missings</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb498"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb498-2"><a href="#cb498-2"></a>  <span class="fu">drop_na</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>There is a special <strong>filter</strong> for one of the most common operations in debugging: <span class="hl-yellow"><strong>remove absent</strong></span>. For this we can use inside a filter <code>is.na()</code>, which returns <code>TRUE/FALSE</code> depending on whether it is absent, or …</p>
<div class="fragment">
<p>Use <code>drop_na()</code>: if we do not specify a variable, it removes records with missing in any variable. Later on we will see how to <span class="hl-yellow"><strong>impute those missing</strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb499-2"><a href="#cb499-2"></a>  <span class="fu">drop_na</span>(mass, height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  name                mass height hair_color 
  &lt;chr&gt;              &lt;dbl&gt;  &lt;int&gt; &lt;chr&gt;      
1 Luke Skywalker        77    172 blond      
2 C-3PO                 75    167 &lt;NA&gt;       
3 R2-D2                 32     96 &lt;NA&gt;       
4 Darth Vader          136    202 none       
5 Leia Organa           49    150 brown      
6 Owen Lars            120    178 brown, grey
7 Beru Whitesun Lars    75    165 brown      </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb501"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb501-2"><a href="#cb501-2"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  name                mass height hair_color   
  &lt;chr&gt;              &lt;dbl&gt;  &lt;int&gt; &lt;chr&gt;        
1 Luke Skywalker        77    172 blond        
2 Darth Vader          136    202 none         
3 Leia Organa           49    150 brown        
4 Owen Lars            120    178 brown, grey  
5 Beru Whitesun Lars    75    165 brown        
6 Biggs Darklighter     84    183 black        
7 Obi-Wan Kenobi        77    182 auburn, white</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-2-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-9-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-9-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-9-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-9-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<p>📝 Select from the starwars set only those characters that are androids or whose <code>species</code> value is unknown.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb503"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb503-2"><a href="#cb503-2"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Droid"</span> <span class="sc">|</span> <span class="fu">is.na</span>(species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-2">
<p>📝 Select from the starwars set only the characters whose weight is between 65 and 90 kg.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">between</span>(mass, <span class="dv">65</span>, <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-3">
<p>📝 After clearing absent in all variables, select from the starwars set only the characters that are human and come from Tatooine.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb505"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb505-2"><a href="#cb505-2"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb505-3"><a href="#cb505-3"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> homeworld <span class="sc">==</span> <span class="st">"Tatooine"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-4">
<p>📝 Select from the original starwars set non-human characters, <code>male</code> in sex and measuring between 120 and 170 cm, or characters with brown or red eyes.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb506-2"><a href="#cb506-2"></a>  <span class="fu">filter</span>((species <span class="sc">!=</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">"male"</span> <span class="sc">&amp;</span></span>
<span id="cb506-3"><a href="#cb506-3"></a>            <span class="fu">between</span>(height, <span class="dv">120</span>, <span class="dv">170</span>)) <span class="sc">|</span></span>
<span id="cb506-4"><a href="#cb506-4"></a>           eye_color <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"brown"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-9-5">
<p>📝 Look for information in the <code>str_detect()</code> function help of the <code>{stringr}</code> package (loaded in <code>{tidyverse}</code>). Tip: test the functions you are going to use with some test vector beforehand so that you can check how they work. After you know what it does, filter out only those characters with the last name <code>Skywalker</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb507"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(name, <span class="st">"Skywalker"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="slices-of-data-slice" class="slide level2">
<h2>Slices of data: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1"></a>data <span class="sc">|&gt;</span> <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb509"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Sometimes we may be interested in performing a <span class="hl-yellow"><strong>non-random discretionary sampling</strong></span>, or in other words, <span class="hl-yellow"><strong>filter by position</strong></span>: with <code>slice(positions)</code> we can select specific rows by passing as argument a <span class="hl-yellow"><strong>index vector</strong></span>.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1"></a><span class="co"># fila 1</span></span>
<span id="cb510-2"><a href="#cb510-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb510-3"><a href="#cb510-3"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Luke Skywalker    172    77 blond     </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1"></a><span class="co"># from the 7th to the 9th row</span></span>
<span id="cb512-2"><a href="#cb512-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb512-3"><a href="#cb512-3"></a>  <span class="fu">slice</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  name               height  mass hair_color
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Beru Whitesun Lars    165    75 brown     
2 R5-D4                  97    32 &lt;NA&gt;      
3 Biggs Darklighter     183    84 black     </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1"></a><span class="co"># 2, 7, 10 and 31th rows</span></span>
<span id="cb514-2"><a href="#cb514-2"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb514-3"><a href="#cb514-3"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">31</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  name             height  mass hair_color skin_color eye_color birth_year sex  
  &lt;chr&gt;             &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
1 C-3PO               167    75 &lt;NA&gt;       gold       yellow           112 none 
2 Beru Whitesun L…    165    75 brown      light      blue              47 fema…
3 Obi-Wan Kenobi      182    77 auburn, w… fair       blue-gray         57 male 
4 Qui-Gon Jinn        193    89 brown      fair       blue              92 male </code></pre>
</div>
</div>
</div>
</section>
<section id="slices-of-data-slice-1" class="slide level2">
<h2>Slices of data: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb516-2"><a href="#cb516-2"></a>  <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb517-2"><a href="#cb517-2"></a>  <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We have default options:</p>
<ul>
<li>with <code>slice_head(n = ...)</code> and <code>slice_tail(n = ...)</code> we can get the <span class="hl-yellow"><strong>header and tail</strong></span> of the table</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb518"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Luke Skywalker    172    77 blond     
2 C-3PO             167    75 &lt;NA&gt;      </code></pre>
</div>
</div>
</div><div class="column" style="width:&quot;50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name           height  mass hair_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 BB8                NA    NA none      
2 Captain Phasma     NA    NA none      </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="slices-of-data-slice-2" class="slide level2">
<h2>Slices of data: slice()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb522-2"><a href="#cb522-2"></a>  <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb523-2"><a href="#cb523-2"></a>  <span class="fu">slice</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We have default options:</p>
<ul>
<li>with <code>slice_max()</code> and <code>slice_min()</code> we get the <span class="hl-yellow"><strong>rows with smallest/largest value of a variable</strong></span> (if tie, all unless <code>with_ties = FALSE</code>) which we indicate in <code>order_by = ...</code>.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_min</span>(mass, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name         height  mass hair_color
  &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Ratts Tyerel     79    15 none      
2 Yoda             66    17 white     </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  name        height  mass hair_color
  &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Yarael Poof    264    NA none      
2 Tarfful        234   136 brown     </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="random-sampling-slice_sample" class="slide level2">
<h2>Random sampling: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb528-2"><a href="#cb528-2"></a>  <span class="fu">slice_aleatorias</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb529"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb529-2"><a href="#cb529-2"></a>  <span class="fu">slice_sample</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The so-called <span class="hl-yellow"><strong>simple random sampling</strong></span> is based on <span class="hl-yellow"><strong>selecting individuals randomly</strong></span>, so that each one has certain <span class="hl-yellow"><strong>probabilities</strong></span> of being selected. With <code>slice_sample(n = ...)</code> we can randomly extract n (a priori equiprobable) records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Mas Amed…    196    NA none       blue       blue              NA male  mascu…
2 Ratts Ty…     79    15 none       grey, blue unknown           NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><span class="hl-yellow"><strong>“Random” does not imply equiprobable</strong></span>: a normal die is just as random as a trick die. There are no things “more random” than others, they simply have different underlying probability laws.</p>
</div>
</div>
</div>
</div>
</section>
<section id="random-sampling-slice_sample-1" class="slide level2">
<h2>Random sampling: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb532-2"><a href="#cb532-2"></a>  <span class="fu">slice_random</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb533"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb533-2"><a href="#cb533-2"></a>  <span class="fu">slice_sample</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can also indicate the <span class="hl-yellow"><strong>proportion of data to sample</strong></span> (instead of the number) and if we want it to be <span class="hl-yellow"><strong>with replacement (that can be repeated)</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb534"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1"></a><span class="co"># 5% of random rows with replacement</span></span>
<span id="cb534-2"><a href="#cb534-2"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb534-3"><a href="#cb534-3"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.05</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Rugor Na…    206    NA none       green      orange            NA male  mascu…
2 Watto        137    NA black      blue, grey yellow            NA male  mascu…
3 Rey           NA    NA brown      light      hazel             NA fema… femin…
4 Jek Tono…    180   110 brown      fair       blue              NA &lt;NA&gt;  &lt;NA&gt;  
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="random-sampling-slice_sample-2" class="slide level2">
<h2>Random sampling: slice_sample()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb536-2"><a href="#cb536-2"></a>  <span class="fu">slice_random</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb537"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb537-2"><a href="#cb537-2"></a>  <span class="fu">slice_sample</span>(positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>As we said, “random” is not the same as “equiprobable”, so we can pass a <span class="hl-yellow"><strong>probability vector</strong></span>. For example, let’s force that it is very improbable to draw a row other than the first two rows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb538"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb538-2"><a href="#cb538-2"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">weight_by =</span> <span class="fu">c</span>(<span class="fl">0.495</span>, <span class="fl">0.495</span>, <span class="fu">rep</span>(<span class="fl">0.01</span><span class="sc">/</span><span class="dv">85</span>, <span class="dv">85</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb540"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb540-2"><a href="#cb540-2"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>, <span class="at">weight_by =</span> <span class="fu">c</span>(<span class="fl">0.495</span>, <span class="fl">0.495</span>, <span class="fu">rep</span>(<span class="fl">0.01</span><span class="sc">/</span><span class="dv">85</span>, <span class="dv">85</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
2 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="sample" class="slide level2">
<h2>sample()</h2>
<p>The <code>slice_sample()</code> function is simply a <code>{tidyverse}</code> integration of the basic <code>R</code> function known as <code>sample()</code> that allows us to <span class="hl-yellow"><strong>sample elements</strong></span></p>
<div class="fragment">
<p>For example, let’s <span class="hl-yellow"><strong>sample 10 rolls of a die</strong></span>, telling it</p>
<ul>
<li><span class="hl-purple"><strong>support</strong></span> of our random variable (allowed values in <code>x</code>)</li>
<li><span class="hl-purple"><strong>sample size</strong></span> (<code>size</code>)</li>
<li><span class="hl-purple"><strong>replacement</strong></span> (if <code>TRUE</code> then they can come out repeated, as in the case of the die).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb542"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1"></a><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2 2 3 2 6 3 1 4 5 1</code></pre>
</div>
</div>
</div>
</section>
<section id="sample-1" class="slide level2">
<h2>sample()</h2>
<p>The previous option generates events of a random variable <span class="hl-yellow"><strong>equiprobable</strong></span> but as before, we can assign a vector of probabilities or <span class="hl-yellow"><strong>mass function</strong></span> to it with the argument <code>prob = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1"></a><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb544-2"><a href="#cb544-2"></a>       <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 3 2 1 1 3 5 4 1 2 1 3 1 1 1 1 1 5 1 1 1 1 5 3 1 1 1 2 3 1 1 1 3 2 3
[39] 5 1 1 1 2 3 5 1 1 3 1 1</code></pre>
</div>
</div>
</section>
<section id="sample-2" class="slide level2">
<h2>sample()</h2>
<p><strong>How would you make the following statement?</strong></p>
<p>&nbsp;</p>
<p>Suppose that seasonal flu episodes have been studied in a city. Let <span class="math inline">\(X_m\)</span> and <span class="math inline">\(X_p\)</span> be random variables such that <span class="math inline">\(X_m=1\)</span> if the mother has flu, <span class="math inline">\(X_m=0\)</span> if the mother does not have flu, <span class="math inline">\(X_p=1\)</span> if the father has flu and <span class="math inline">\(X_p=0\)</span> if the father does not have flu. The theoretical model associated with this type of epidemics indicates that the joint distribution is given by <span class="math inline">\(P(X_m = 1, X_p=1)=0.02\)</span>, <span class="math inline">\(P(X_m = 1, X_p=0)=0.08\)</span>, <span class="math inline">\(P(X_m = 1, X_p=0)=0. 1\)</span> and <span class="math inline">\(P(X_m = 0, X_p=0)=0.8\)</span></p>
<p><strong>Generate a sample</strong> of size <span class="math inline">\(n = 1000\)</span> (support <code>"10"</code>, <code>"01"</code>, <code>"00"</code> and <code>"11"</code>) by making use of <code>runif()</code> and by making use of <code>sample()</code>.</p>
</section>
<section id="sort-by-rows-arrange" class="slide level2">
<h2>Sort by rows: arrange()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1"></a>data <span class="sc">|&gt;</span> <span class="fu">sort</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb547"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can also <span class="hl-yellow"><strong>order by rows</strong></span> according to some variable with <code>arrange()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  name                  height  mass hair_color skin_color  eye_color
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    
1 Ratts Tyerel              79    15 none       grey, blue  unknown  
2 Yoda                      66    17 white      green       brown    
3 Wicket Systri Warrick     88    20 brown      brown       brown    
4 R2-D2                     96    32 &lt;NA&gt;       white, blue red      
5 R5-D4                     97    32 &lt;NA&gt;       white, red  red      </code></pre>
</div>
</div>
<div class="fragment">
<p>By <span class="hl-yellow"><strong>from lowest to highest</strong></span> but we can <span class="hl-purple"><strong>reverse the order</strong></span> with <code>desc()</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb550"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name         height  mass
  &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt;
1 Yarael Poof     264    NA
2 Tarfful         234   136
3 Lama Su         229    88
4 Chewbacca       228   112
5 Roos Tarpals    224    82</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb552"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mass, <span class="fu">desc</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  name                  height  mass
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt;
1 Ratts Tyerel              79    15
2 Yoda                      66    17
3 Wicket Systri Warrick     88    20
4 R5-D4                     97    32
5 R2-D2                     96    32</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="remove-duplicates-distinct" class="slide level2">
<h2>Remove duplicates: distinct()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb554"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1"></a>data <span class="sc">|&gt;</span> <span class="fu">no_duplicates</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb555"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Many times we will need to make sure that there are no duplicates in some variable (DNI) and we can <span class="hl-yellow"><strong>delete duplicate rows</strong></span> with <code>distinct()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb556"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  sex           
  &lt;chr&gt;         
1 male          
2 none          
3 female        
4 hermaphroditic
5 &lt;NA&gt;          </code></pre>
</div>
</div>
<div class="fragment">
<p>To keep all the columns of the table we will use <code>.keep_all = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb558"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(sex, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
3 Leia Org…    150    49 brown      light      brown             19 fema… femin…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="including-rows-bind_rows" class="slide level2">
<h2>Including rows: bind_rows()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb560"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1"></a>tibble1 <span class="sc">|&gt;</span> <span class="fu">include_rows</span>(tibble2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb561"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1"></a>tibble1 <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>(tibble2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Finally, we can <span class="hl-yellow"><strong>bind new rows</strong></span> with <code>bind_rows()</code> with <span class="hl-red"><strong>new observations in table</strong></span> (if columns do not match fill with absent)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1"></a>data <span class="ot">&lt;-</span></span>
<span id="cb562-2"><a href="#cb562-2"></a>  <span class="fu">tibble</span>(<span class="st">"name"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"laura"</span>), <span class="st">"age"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">50</span>))</span>
<span id="cb562-3"><a href="#cb562-3"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  name    age
  &lt;chr&gt; &lt;dbl&gt;
1 javi     33
2 laura    50</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1"></a>data <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="st">"name"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"carlos"</span>, <span class="cn">NA</span>), <span class="st">"cp"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">28045</span>, <span class="dv">28019</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  name     age    cp
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 javi      33    NA
2 laura     50    NA
3 carlos    NA 28045
4 &lt;NA&gt;      NA 28019</code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-2-2" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-10" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-10-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-10-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-10-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-10-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-10-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-10-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-10-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1">
<p>📝 Select only the characters that are human and brown-eyed, then sort them in descending height and ascending weight.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb566"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb566-2"><a href="#cb566-2"></a>  <span class="fu">filter</span>(eye_color <span class="sc">==</span> <span class="st">"brown"</span> <span class="sc">&amp;</span> species <span class="sc">==</span> <span class="st">"Human"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb566-3"><a href="#cb566-3"></a>  <span class="fu">arrange</span>(height, <span class="fu">desc</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-2">
<p>📝 Randomly extracts 3 records.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb567"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-3">
<p>📝 Extracts 10% of the records randomly.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb568"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-4">
<p>📝R andomly draws 10 characters but in such a way that the probability of each character being drawn is proportional to its weight (heavier, more likely).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb569"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb569-2"><a href="#cb569-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb569-3"><a href="#cb569-3"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">weight_by =</span> mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-5">
<p>📝 Select the 3 oldest characters.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb570"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(birth_year, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-6">
<p>📝 To find out what unique values are in the hair color, remove duplicates of the <code>hair_color</code> variable by first removing the missing ones from the <code>hair_color</code> variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb571"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb571-2"><a href="#cb571-2"></a>  <span class="fu">drop_na</span>(hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb571-3"><a href="#cb571-3"></a>  <span class="fu">distinct</span>(hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-10-7">
<p>📝 Of the characters that are human and taller than 160 cm, eliminate duplicates in eye color, eliminate absent in weight, select the 3 tallest, and order from tallest to shortest in weight. Return the table.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb572-2"><a href="#cb572-2"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Human"</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">|&gt;</span> </span>
<span id="cb572-3"><a href="#cb572-3"></a>  <span class="fu">distinct</span>(eye_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb572-4"><a href="#cb572-4"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span> </span>
<span id="cb572-5"><a href="#cb572-5"></a>  <span class="fu">slice_max</span>(height, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb572-6"><a href="#cb572-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-2" class="slide level2">
<h2>🐣 Case study</h2>
<p>Let’s go back to a known dataset: in the <code>{datasets}</code> package (already installed by default) we had several datasets and one of them was <code>airquality</code> which we already worked with. The data captures <span class="hl-yellow"><strong>daily measurements (n = 153 observations) of air quality</strong></span> in New York, from May to September 1973.</p>
<p>At that time we worked it from the R base perspective and extracted some variables from it. The objective now will be to work it from the <code>{tidyverse}</code> perspective looking at the differences from one form to the other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb573"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb573-2"><a href="#cb573-2"></a>airquality</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/tidyverse-mucss/"><strong>workbook</strong></a>.</p>
</section></section>
<section>
<section id="clase-3" class="title-slide slide level1 center">
<h1>L3: <span class="flow">tidyverse (columns)</span></h1>
<p><span style="color:#444442;"><strong>Tidyverse: actions by columns</strong></span></p>
<ul>
<li><p><a href="#/tu-turno-3-1">💻 Solved exercises: select</a></p></li>
<li><p><a href="#/tu-turno-3-2">💻 Solved exercises: mutate, if_else, case_when</a></p></li>
<li><p><a href="#/caso-practico-3-1">🐣 Workbook/case study I: viogen survey</a></p></li>
<li><p><a href="#/caso-practico-3-2">🐣 Workbook/case study II: Taylor Swift again</a></p></li>
<li><p><a href="#/caso-practico-3-3">🐣 Workbook/case study III: The Lord of the Rings</a></p></li>
<li><p><a href="#/planificacion-curso">📆 Planning</a></p></li>
</ul>
</section>
<section id="select-columns-select" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb574"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1"></a>data <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb575"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Up to now all operations performed (even if we used column info) were by rows. In the case of columns, the simplest action is to <span class="hl-yellow"><strong>select variables by name</strong></span> with <code>select()</code>, giving as arguments the column names <span class="hl-purple"><strong>without quotes</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb576"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name, hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 2
   name               hair_color   
   &lt;chr&gt;              &lt;chr&gt;        
 1 Luke Skywalker     blond        
 2 C-3PO              &lt;NA&gt;         
 3 R2-D2              &lt;NA&gt;         
 4 Darth Vader        none         
 5 Leia Organa        brown        
 6 Owen Lars          brown, grey  
 7 Beru Whitesun Lars brown        
 8 R5-D4              &lt;NA&gt;         
 9 Biggs Darklighter  black        
10 Obi-Wan Kenobi     auburn, white
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="select-columns-select-1" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb578"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1"></a>data <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb579"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The <code>select()</code> function allows us to select several variables at once, including <span class="hl-yellow"><strong>concatenating their names as if they were numerical indexes</strong></span> with <code>:</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb580"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name<span class="sc">:</span>eye_color) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  name           height  mass hair_color skin_color  eye_color
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;    
1 Luke Skywalker    172    77 blond      fair        blue     
2 C-3PO             167    75 &lt;NA&gt;       gold        yellow   
3 R2-D2              96    32 &lt;NA&gt;       white, blue red      
4 Darth Vader       202   136 none       white       yellow   </code></pre>
</div>
</div>
<div class="fragment">
<p>And we can <span class="hl-yellow"><strong>deselect columns</strong></span> with <code>-</code> in front of it</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb582"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1"></a>starwars <span class="sc">|&gt;</span>  <span class="fu">select</span>(<span class="sc">-</span>mass, <span class="sc">-</span>(eye_color<span class="sc">:</span>starships))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  name           height hair_color skin_color 
  &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      
1 Luke Skywalker    172 blond      fair       
2 C-3PO             167 &lt;NA&gt;       gold       
3 R2-D2              96 &lt;NA&gt;       white, blue
4 Darth Vader       202 none       white      </code></pre>
</div>
</div>
</div>
</section>
<section id="select-columns-select-2" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb584"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1"></a>data <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb585"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We have also <span class="hl-yellow"><strong>reserved words</strong></span>: <code>everything()</code> <span class="hl-purple"><strong>all variables</strong></span>….</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb586"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb586-1"><a href="#cb586-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(mass, homeworld, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 14
   mass homeworld name   height hair_color skin_color eye_color birth_year sex  
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
1    77 Tatooine  Luke …    172 blond      fair       blue            19   male 
2    75 Tatooine  C-3PO     167 &lt;NA&gt;       gold       yellow         112   none 
3    32 Naboo     R2-D2      96 &lt;NA&gt;       white, bl… red             33   none 
4   136 Tatooine  Darth…    202 none       white      yellow          41.9 male 
# ℹ 5 more variables: gender &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<div class="fragment">
<p>…and <code>last_col()</code> to refer to <span class="hl-purple"><strong>last column</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb588"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name<span class="sc">:</span>mass, homeworld, <span class="fu">last_col</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  name           height  mass homeworld starships
  &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;list&gt;   
1 Luke Skywalker    172    77 Tatooine  &lt;chr [2]&gt;
2 C-3PO             167    75 Tatooine  &lt;chr [0]&gt;
3 R2-D2              96    32 Naboo     &lt;chr [0]&gt;
4 Darth Vader       202   136 Tatooine  &lt;chr [1]&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="select-columns-select-3" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb590"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1"></a>data <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb591"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can also play with <span class="hl-yellow"><strong>patterns</strong></span> in the name, those that <span class="hl-purple"><strong>begin with a prefix</strong></span> (<code>starts_with()</code>), [<strong>end with a suffix</strong>]{. hl-purple} (<code>ends_with()</code>), <span class="hl-purple"><strong>contain text</strong></span> (<code>contains()</code>) or fulfill a <span class="hl-purple"><strong>regular expression</strong></span> (<code>matches()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb592"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1"></a><span class="co"># variables which col name finish as "color" and contains sex and gender</span></span>
<span id="cb592-2"><a href="#cb592-2"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"color"</span>), <span class="fu">matches</span>(<span class="st">"sex|gender"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 5
   hair_color    skin_color  eye_color sex    gender   
   &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;    
 1 blond         fair        blue      male   masculine
 2 &lt;NA&gt;          gold        yellow    none   masculine
 3 &lt;NA&gt;          white, blue red       none   masculine
 4 none          white       yellow    male   masculine
 5 brown         light       brown     female feminine 
 6 brown, grey   light       blue      male   masculine
 7 brown         light       blue      female feminine 
 8 &lt;NA&gt;          white, red  red       none   masculine
 9 black         light       brown     male   masculine
10 auburn, white fair        blue-gray male   masculine
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="select-columns-select-4" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb594"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1"></a>data <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb595"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can even <span class="hl-yellow"><strong>select by numeric range</strong></span> if we have variables with a prefix and numbers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb596"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1"></a>data <span class="ot">&lt;-</span></span>
<span id="cb596-2"><a href="#cb596-2"></a>  <span class="fu">tibble</span>(<span class="st">"wk1"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">115</span>, <span class="dv">141</span>, <span class="dv">232</span>), <span class="st">"wk2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="cn">NA</span>, <span class="dv">17</span>),</span>
<span id="cb596-3"><a href="#cb596-3"></a>         <span class="st">"wk3"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">162</span>, <span class="cn">NA</span>), <span class="st">"wk4"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">19</span>, <span class="dv">15</span>),</span>
<span id="cb596-4"><a href="#cb596-4"></a>         <span class="st">"wk5"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">262</span>, <span class="dv">190</span>), <span class="st">"wk6"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">15</span>, <span class="dv">23</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>With <code>num_range()</code> we can select with a prefix and a numeric sequence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb597"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1"></a>data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">num_range</span>(<span class="st">"wk"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
    wk1   wk2   wk3   wk4
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1   115     7    95    11
2   141    NA   162    19
3   232    17    NA    15</code></pre>
</div>
</div>
</div>
</section>
<section id="select-columns-select-5" class="slide level2">
<h2>Select columns: select()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb599"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1"></a>data <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb600"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(var1, var2, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Finally, we can select columns by <span class="hl-yellow"><strong>datatatype</strong></span> using <code>where()</code> and inside a function that returns a logical value of datatype.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb601"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb601-1"><a href="#cb601-1"></a><span class="co"># just numeric and string columns</span></span>
<span id="cb601-2"><a href="#cb601-2"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">|</span> <span class="fu">where</span>(is.character))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 11
   height  mass birth_year name     hair_color skin_color eye_color sex   gender
    &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; 
 1    172    77       19   Luke Sk… blond      fair       blue      male  mascu…
 2    167    75      112   C-3PO    &lt;NA&gt;       gold       yellow    none  mascu…
 3     96    32       33   R2-D2    &lt;NA&gt;       white, bl… red       none  mascu…
 4    202   136       41.9 Darth V… none       white      yellow    male  mascu…
 5    150    49       19   Leia Or… brown      light      brown     fema… femin…
 6    178   120       52   Owen La… brown, gr… light      blue      male  mascu…
 7    165    75       47   Beru Wh… brown      light      blue      fema… femin…
 8     97    32       NA   R5-D4    &lt;NA&gt;       white, red red       none  mascu…
 9    183    84       24   Biggs D… black      light      brown     male  mascu…
10    182    77       57   Obi-Wan… auburn, w… fair       blue-gray male  mascu…
# ℹ 77 more rows
# ℹ 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="move-columns-relocate" class="slide level2">
<h2>Move columns: relocate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb603"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb603-1"><a href="#cb603-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb603-2"><a href="#cb603-2"></a>  <span class="fu">move</span>(var1, <span class="at">after =</span> var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb604"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb604-2"><a href="#cb604-2"></a>  <span class="fu">relocate</span>(var1, <span class="at">.after =</span> var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>To facilitate the <span class="hl-yellow"><strong>relocation of variables</strong></span> we have a function for it, <code>relocate()</code>, indicating in <code>.after</code> or <code>.before</code> <span class="hl-purple"><strong>behind</strong></span> or <span class="hl-purple"><strong>in front</strong></span> of which columns we want to move them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb605"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb605-1"><a href="#cb605-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">relocate</span>(species, <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   species name    height  mass hair_color skin_color eye_color birth_year sex  
   &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1 Human   Luke S…    172    77 blond      fair       blue            19   male 
 2 Droid   C-3PO      167    75 &lt;NA&gt;       gold       yellow         112   none 
 3 Droid   R2-D2       96    32 &lt;NA&gt;       white, bl… red             33   none 
 4 Human   Darth …    202   136 none       white      yellow          41.9 male 
 5 Human   Leia O…    150    49 brown      light      brown           19   fema…
 6 Human   Owen L…    178   120 brown, gr… light      blue            52   male 
 7 Human   Beru W…    165    75 brown      light      blue            47   fema…
 8 Droid   R5-D4       97    32 &lt;NA&gt;       white, red red             NA   none 
 9 Human   Biggs …    183    84 black      light      brown           24   male 
10 Human   Obi-Wa…    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 77 more rows
# ℹ 5 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="rename-rename" class="slide level2">
<h2>Rename: rename()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb607"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb607-1"><a href="#cb607-1"></a>data <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">new =</span> old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb608"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">new =</span> old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Sometimes we may also want to <span class="hl-yellow"><strong>modify the “meta-information”</strong></span> of the data, <span class="hl-yellow"><strong>renaming columns</strong></span>. To do this we will use <code>rename()</code> by typing <span class="hl-purple"><strong>first the new name</strong></span> and then the <span class="hl-purple"><strong>old</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb609"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb609-1"><a href="#cb609-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height, <span class="at">peso =</span> mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   nombre   altura  peso hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="extract-columns-pull" class="slide level2">
<h2>Extract columns: pull()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb611"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb611-1"><a href="#cb611-1"></a>data <span class="sc">|&gt;</span> <span class="fu">extract</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb612"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>If you look at the output of the <code>select()</code> <span class="hl-yellow"><strong>still a tibble table</strong></span>, it preserves the nature of our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb613"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">select</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 1
   name              
   &lt;chr&gt;             
 1 Luke Skywalker    
 2 C-3PO             
 3 R2-D2             
 4 Darth Vader       
 5 Leia Organa       
 6 Owen Lars         
 7 Beru Whitesun Lars
 8 R5-D4             
 9 Biggs Darklighter 
10 Obi-Wan Kenobi    
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="extract-columns-pull-1" class="slide level2">
<h2>Extract columns: pull()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb615"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb615-1"><a href="#cb615-1"></a>data <span class="sc">|&gt;</span> <span class="fu">extract</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb616"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Sometimes we will not want such a structure but <span class="hl-yellow"><strong>literally extract the column in a VECTOR</strong></span>, something we can do with <code>pull()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb617"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">pull</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Luke Skywalker"        "C-3PO"                 "R2-D2"                
 [4] "Darth Vader"           "Leia Organa"           "Owen Lars"            
 [7] "Beru Whitesun Lars"    "R5-D4"                 "Biggs Darklighter"    
[10] "Obi-Wan Kenobi"        "Anakin Skywalker"      "Wilhuff Tarkin"       
[13] "Chewbacca"             "Han Solo"              "Greedo"               
[16] "Jabba Desilijic Tiure" "Wedge Antilles"        "Jek Tono Porkins"     
[19] "Yoda"                  "Palpatine"             "Boba Fett"            
[22] "IG-88"                 "Bossk"                 "Lando Calrissian"     
[25] "Lobot"                 "Ackbar"                "Mon Mothma"           
[28] "Arvel Crynyd"          "Wicket Systri Warrick" "Nien Nunb"            
[31] "Qui-Gon Jinn"          "Nute Gunray"           "Finis Valorum"        
[34] "Padmé Amidala"         "Jar Jar Binks"         "Roos Tarpals"         
[37] "Rugor Nass"            "Ric Olié"              "Watto"                
[40] "Sebulba"               "Quarsh Panaka"         "Shmi Skywalker"       
[43] "Darth Maul"            "Bib Fortuna"           "Ayla Secura"          
[46] "Ratts Tyerel"          "Dud Bolt"              "Gasgano"              
[49] "Ben Quadinaros"        "Mace Windu"            "Ki-Adi-Mundi"         
[52] "Kit Fisto"             "Eeth Koth"             "Adi Gallia"           
[55] "Saesee Tiin"           "Yarael Poof"           "Plo Koon"             
[58] "Mas Amedda"            "Gregar Typho"          "Cordé"                
[61] "Cliegg Lars"           "Poggle the Lesser"     "Luminara Unduli"      
[64] "Barriss Offee"         "Dormé"                 "Dooku"                
[67] "Bail Prestor Organa"   "Jango Fett"            "Zam Wesell"           
[70] "Dexter Jettster"       "Lama Su"               "Taun We"              
[73] "Jocasta Nu"            "R4-P17"                "Wat Tambor"           
[76] "San Hill"              "Shaak Ti"              "Grievous"             
[79] "Tarfful"               "Raymus Antilles"       "Sly Moore"            
[82] "Tion Medon"            "Finn"                  "Rey"                  
[85] "Poe Dameron"           "BB8"                   "Captain Phasma"       </code></pre>
</div>
</div>
</section>
<section id="tu-turno-3-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-11" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-11-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-11-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-11-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-11-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-11-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-11-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-11-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1">
<p>📝 Filter the set of characters and keep only those that do not have a missing data in the <code>height</code> variable. With the data obtained from the previous filter, select only the variables name, height, as well as all those variables that CONTAIN the word color in their name.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb619"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1"></a>starwars_2 <span class="ot">&lt;-</span></span>
<span id="cb619-2"><a href="#cb619-2"></a>  starwars <span class="sc">|&gt;</span> </span>
<span id="cb619-3"><a href="#cb619-3"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb619-4"><a href="#cb619-4"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-2">
<p>📝 With the data obtained from the previous Exercise, translate the names of the columns into Spanish (or your motherlanguage).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb620"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb620-1"><a href="#cb620-1"></a>starwars_2 <span class="sc">|&gt;</span> </span>
<span id="cb620-2"><a href="#cb620-2"></a>  <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height, <span class="at">color_pelo =</span> hair_color,</span>
<span id="cb620-3"><a href="#cb620-3"></a>         <span class="at">color_piel =</span> skin_color, <span class="at">color_ojos =</span> eye_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-3">
<p>📝 With the data obtained from Exercise 1, place the hair color variable just after the name variable.</p>
<p>Con los data obtenidos del Exercise anterior, coloca la variable de color de pelo justo detrás de la variable de nombres.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb621"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1"></a>starwars_2 <span class="sc">|&gt;</span></span>
<span id="cb621-2"><a href="#cb621-2"></a>  <span class="fu">relocate</span>(hair_color, <span class="at">.after =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-4">
<p>📝 With the data obtained from the Exercise 1, check how many unique modalities there are in the hair color variable (without using <code>unique()</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb622"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1"></a>starwars_2 <span class="sc">|&gt;</span></span>
<span id="cb622-2"><a href="#cb622-2"></a>  <span class="fu">distinct</span>(hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-5">
<p>📝 From the original data set, it removes the list type columns, and then removes duplicates in the <code>eye_color</code> variable. After removing duplicates it extracts that column into a vector.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb623"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb623-2"><a href="#cb623-2"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">where</span>(is.list)) <span class="sc">|&gt;</span> </span>
<span id="cb623-3"><a href="#cb623-3"></a>  <span class="fu">distinct</span>(eye_color, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb623-4"><a href="#cb623-4"></a>  <span class="fu">pull</span>(eye_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-6">
<p>📝 From the original starwars dataset, with only the characters whose height is known, extract in a vector with that variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb624"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb624-2"><a href="#cb624-2"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb624-3"><a href="#cb624-3"></a>  <span class="fu">pull</span>(height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-7">
<p>📝 After obtaining the vector from the previous Exercise, use this vector to randomly sample 50% of the data so that the probability of each character being chosen is inversely proportional to their height (shorter, more options).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb625"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1"></a>heights <span class="ot">&lt;-</span></span>
<span id="cb625-2"><a href="#cb625-2"></a>  starwars <span class="sc">|&gt;</span> </span>
<span id="cb625-3"><a href="#cb625-3"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb625-4"><a href="#cb625-4"></a>  <span class="fu">pull</span>(height)</span>
<span id="cb625-5"><a href="#cb625-5"></a>  </span>
<span id="cb625-6"><a href="#cb625-6"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb625-7"><a href="#cb625-7"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.5</span>, <span class="at">weight_by =</span> <span class="dv">1</span><span class="sc">/</span>heights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="modify-columns-mutate" class="slide level2">
<h2>Modify columns: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb626"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb626-1"><a href="#cb626-1"></a>data <span class="sc">|&gt;</span> <span class="fu">modify</span>(<span class="at">new_var =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb627"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_var =</span> <span class="cf">function</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>In many occasions we will want to <span class="hl-yellow"><strong>modify or create variables</strong></span> with <code>mutate()</code>.</p>
<div class="fragment">
<p>Let’s create for example a new variable <code>height_m</code> with the height in meters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb628"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb628-1"><a href="#cb628-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">height_m =</span> height <span class="sc">/</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 15
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 6 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;, height_m &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="modify-columns-mutate-1" class="slide level2">
<h2>Modify columns: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb630"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1"></a>data <span class="sc">|&gt;</span> <span class="fu">modify</span>(<span class="at">new_var =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb631"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_var =</span> <span class="cf">function</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>In addition with the optional arguments we can <span class="hl-yellow"><strong>reposition the modified column</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb632"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb632-1"><a href="#cb632-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb632-2"><a href="#cb632-2"></a>  <span class="fu">mutate</span>(<span class="at">height_m =</span> height <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb632-3"><a href="#cb632-3"></a>         <span class="at">BMI =</span> mass <span class="sc">/</span> (height_m<span class="sc">^</span><span class="dv">2</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 16
   height_m   BMI name   height  mass hair_color skin_color eye_color birth_year
      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt;
 1     1.72  26.0 Luke …    172    77 blond      fair       blue            19  
 2     1.67  26.9 C-3PO     167    75 &lt;NA&gt;       gold       yellow         112  
 3     0.96  34.7 R2-D2      96    32 &lt;NA&gt;       white, bl… red             33  
 4     2.02  33.3 Darth…    202   136 none       white      yellow          41.9
 5     1.5   21.8 Leia …    150    49 brown      light      brown           19  
 6     1.78  37.9 Owen …    178   120 brown, gr… light      blue            52  
 7     1.65  27.5 Beru …    165    75 brown      light      blue            47  
 8     0.97  34.0 R5-D4      97    32 &lt;NA&gt;       white, red red             NA  
 9     1.83  25.1 Biggs…    183    84 black      light      brown           24  
10     1.82  23.2 Obi-W…    182    77 auburn, w… fair       blue-gray       57  
# ℹ 77 more rows
# ℹ 7 more variables: sex &lt;chr&gt;, gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="modify-columns-mutate-2" class="slide level2">
<h2>Modify columns: mutate()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb634"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb634-1"><a href="#cb634-1"></a>data <span class="sc">|&gt;</span> <span class="fu">modify</span>(<span class="at">new_var =</span> <span class="fu">funcion</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb635"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_var =</span> <span class="cf">function</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>When we apply <code>mutate()</code>, we must remember that the <span class="hl-yellow"><strong>operations are performed vector by vector</strong></span>, element by element, so the function we use inside must return a vector of equal length. Otherwise, <span class="hl-red"><strong>it will return a constant</strong></span>.</p>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb636"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb636-1"><a href="#cb636-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb636-2"><a href="#cb636-2"></a>  <span class="fu">mutate</span>(<span class="at">constante =</span> <span class="fu">mean</span>(mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 15
   constante name  height  mass hair_color skin_color eye_color birth_year sex  
       &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1      97.3 Luke…    172    77 blond      fair       blue            19   male 
 2      97.3 C-3PO    167    75 &lt;NA&gt;       gold       yellow         112   none 
 3      97.3 R2-D2     96    32 &lt;NA&gt;       white, bl… red             33   none 
 4      97.3 Dart…    202   136 none       white      yellow          41.9 male 
 5      97.3 Leia…    150    49 brown      light      brown           19   fema…
 6      97.3 Owen…    178   120 brown, gr… light      blue            52   male 
 7      97.3 Beru…    165    75 brown      light      blue            47   fema…
 8      97.3 R5-D4     97    32 &lt;NA&gt;       white, red red             NA   none 
 9      97.3 Bigg…    183    84 black      light      brown           24   male 
10      97.3 Obi-…    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 77 more rows
# ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="recategorize-if_else" class="slide level2">
<h2>Recategorize: if_else()</h2>
<p>We can also combine <code>mutate()</code> with the <code>if_else()</code> control expression to <span class="hl-yellow"><strong>recategorize the variable</strong></span>: if <span class="hl-purple"><strong>a condition</strong></span> is met, it does one thing, otherwise another.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb638"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb638-1"><a href="#cb638-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb638-2"><a href="#cb638-2"></a>  <span class="fu">mutate</span>(<span class="at">human =</span> <span class="fu">if_else</span>(species <span class="sc">==</span> <span class="st">"Human"</span>, <span class="st">"Human"</span>, <span class="st">"Not Human"</span>),</span>
<span id="cb638-3"><a href="#cb638-3"></a>         <span class="at">.after =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb638-4"><a href="#cb638-4"></a>  <span class="fu">select</span>(name<span class="sc">:</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 4
   name               human     height  mass
   &lt;chr&gt;              &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
 1 Luke Skywalker     Human        172    77
 2 C-3PO              Not Human    167    75
 3 R2-D2              Not Human     96    32
 4 Darth Vader        Human        202   136
 5 Leia Organa        Human        150    49
 6 Owen Lars          Human        178   120
 7 Beru Whitesun Lars Human        165    75
 8 R5-D4              Not Human     97    32
 9 Biggs Darklighter  Human        183    84
10 Obi-Wan Kenobi     Human        182    77
# ℹ 77 more rows</code></pre>
</div>
</div>
</section>
<section id="recategorize-case_when" class="slide level2">
<h2>Recategorize: case_when()</h2>
<p>For <span class="hl-yellow"><strong>more complex categorizations</strong></span> we have <code>case_when()</code>, for example, to create a category of characters based on their height.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb640"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb640-1"><a href="#cb640-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb640-2"><a href="#cb640-2"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb640-3"><a href="#cb640-3"></a>  <span class="fu">mutate</span>(<span class="at">altura =</span> <span class="fu">case_when</span>(height <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">"dwarf"</span>,</span>
<span id="cb640-4"><a href="#cb640-4"></a>                            height <span class="sc">&lt;</span> <span class="dv">160</span> <span class="sc">~</span> <span class="st">"short"</span>,</span>
<span id="cb640-5"><a href="#cb640-5"></a>                            height <span class="sc">&lt;</span> <span class="dv">180</span> <span class="sc">~</span> <span class="st">"normal"</span>,</span>
<span id="cb640-6"><a href="#cb640-6"></a>                            height <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"tall"</span>,</span>
<span id="cb640-7"><a href="#cb640-7"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"giant"</span>), <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 15
   altura name     height  mass hair_color skin_color eye_color birth_year sex  
   &lt;chr&gt;  &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;
 1 normal Luke Sk…    172    77 blond      fair       blue            19   male 
 2 normal C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none 
 3 dwarf  R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none 
 4 giant  Darth V…    202   136 none       white      yellow          41.9 male 
 5 short  Leia Or…    150    49 brown      light      brown           19   fema…
 6 normal Owen La…    178   120 brown, gr… light      blue            52   male 
 7 normal Beru Wh…    165    75 brown      light      blue            47   fema…
 8 dwarf  R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none 
 9 tall   Biggs D…    183    84 black      light      brown           24   male 
10 tall   Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male 
# ℹ 71 more rows
# ℹ 6 more variables: gender &lt;chr&gt;, homeworld &lt;chr&gt;, species &lt;chr&gt;,
#   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="nest-data-3" class="slide level2">
<h2>nest data</h2>
<p>We can also <span class="hl-yellow"><strong>nest or embed datasets inside each other</strong></span>. Imagine that we have a dataset of <code>x</code> and <code>y</code> variables with 2 records, another one with the same variables but only one record and another one with 3 records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb642"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1"></a>data_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="st">"y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="cn">NA</span>))</span>
<span id="cb642-2"><a href="#cb642-2"></a>data_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>), <span class="st">"y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>))</span>
<span id="cb642-3"><a href="#cb642-3"></a>data_3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">7</span>), <span class="st">"y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>So far the only way we know how to <span class="hl-yellow"><strong>bind the 3 datasets</strong></span> is by using <code>bind_rows()</code> (by the way, if you use the argument <code>.id = “variable_name”</code> we can make it add a new variable that tells us to which dataset each row belonged.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb643"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb643-1"><a href="#cb643-1"></a>data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_1, data_2, data_3, <span class="at">.id =</span> <span class="st">"dataset"</span>)</span>
<span id="cb643-2"><a href="#cb643-2"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  dataset     x     y
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 1           0  -1  
2 1           2  NA  
3 2          NA   5  
4 3          -2   1.5
5 3           6  NA  
6 3           7  -2  </code></pre>
</div>
</div>
</div>
</section>
<section id="nest-data-4" class="slide level2">
<h2>nest data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb645"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb645-1"><a href="#cb645-1"></a>data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_1, data_2, data_3, <span class="at">.id =</span> <span class="st">"dataset"</span>)</span>
<span id="cb645-2"><a href="#cb645-2"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  dataset     x     y
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 1           0  -1  
2 1           2  NA  
3 2          NA   5  
4 3          -2   1.5
5 3           6  NA  
6 3           7  -2  </code></pre>
</div>
</div>
<p>However, in many occasions we will want to have <span class="hl-yellow"><strong>all 3 in the same object BUT each dataset on its own</strong></span>: an object (a list) that stores the 3 datasets separated from each other</p>
<div class="fragment">
<p>To do this we will use the <code>nest()</code> function indicating which common variables form the datasets (in this case <code>x</code> and <code>y</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb647"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb647-1"><a href="#cb647-1"></a>data_nest <span class="ot">&lt;-</span></span>
<span id="cb647-2"><a href="#cb647-2"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb647-3"><a href="#cb647-3"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(x, y))</span>
<span id="cb647-4"><a href="#cb647-4"></a>data_nest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  dataset data            
  &lt;chr&gt;   &lt;list&gt;          
1 1       &lt;tibble [2 × 2]&gt;
2 2       &lt;tibble [1 × 2]&gt;
3 3       &lt;tibble [3 × 2]&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="nest-data-5" class="slide level2">
<h2>nest data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb649"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb649-1"><a href="#cb649-1"></a>data_nest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  dataset data            
  &lt;chr&gt;   &lt;list&gt;          
1 1       &lt;tibble [2 × 2]&gt;
2 2       &lt;tibble [1 × 2]&gt;
3 3       &lt;tibble [3 × 2]&gt;</code></pre>
</div>
</div>
<p>Note that now <code>data_nest</code> is a list as each stored dataset could have different lengths</p>
</section>
<section id="nest-data-6" class="slide level2">
<h2>nest data</h2>
<p>To <span class="hl-yellow"><strong>unnest we can use unnest()</strong></span> indicating the column containing the datasets</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb651"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb651-1"><a href="#cb651-1"></a>data_nest <span class="sc">|&gt;</span> <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  dataset     x     y
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 1           0  -1  
2 1           2  NA  
3 2          NA   5  
4 3          -2   1.5
5 3           6  NA  
6 3           7  -2  </code></pre>
</div>
</div>
</section>
<section id="tu-turno-3-2" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-12" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-12-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-12-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-12-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-12-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-12-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-12-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-12-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1">
<p>📝 Select only the variables name, height and as well as all those variables related to the color, while keeping only those that are not absent in the height.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb653"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb653-2"><a href="#cb653-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb653-3"><a href="#cb653-3"></a>  <span class="fu">drop_na</span>(height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-2">
<p>📝 With the data obtained from the previous Exercise, translate the names of the columns into Spanish or your mother language.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb654"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb654-2"><a href="#cb654-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb654-3"><a href="#cb654-3"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb654-4"><a href="#cb654-4"></a>  <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height,</span>
<span id="cb654-5"><a href="#cb654-5"></a>         <span class="at">color_pelo =</span> eye_color, <span class="at">color_piel =</span> skin_color,</span>
<span id="cb654-6"><a href="#cb654-6"></a>         <span class="at">color_pelo =</span> hair_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-3">
<p>📝 With the data obtained from the previous Exercise, place the hair color variable just after the name variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb655"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb655-1"><a href="#cb655-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb655-2"><a href="#cb655-2"></a>  <span class="fu">select</span>(name, height, <span class="fu">contains</span>(<span class="st">"color"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb655-3"><a href="#cb655-3"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb655-4"><a href="#cb655-4"></a>  <span class="fu">rename</span>(<span class="at">nombre =</span> name, <span class="at">altura =</span> height,</span>
<span id="cb655-5"><a href="#cb655-5"></a>         <span class="at">color_pelo =</span> eye_color, <span class="at">color_piel =</span> skin_color,</span>
<span id="cb655-6"><a href="#cb655-6"></a>         <span class="at">color_pelo =</span> hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb655-7"><a href="#cb655-7"></a>  <span class="fu">relocate</span>(color_pelo, <span class="at">.after =</span> nombre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-4">
<p>📝 With the original data, check how many unique modalities there are in the hair color variable.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb656"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb656-1"><a href="#cb656-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb656-2"><a href="#cb656-2"></a>  <span class="fu">distinct</span>(hair_color) <span class="sc">|&gt;</span> </span>
<span id="cb656-3"><a href="#cb656-3"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-5">
<p>📝 From the original dataset, select only the numeric and text variables. Then define a new variable called <code>under_18</code> to recategorize the age variable: <code>TRUE</code> if under age and <code>FALSE</code> if not.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb657"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb657-1"><a href="#cb657-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb657-2"><a href="#cb657-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric) <span class="sc">|</span> <span class="fu">where</span>(is.character)) <span class="sc">|&gt;</span> </span>
<span id="cb657-3"><a href="#cb657-3"></a>  <span class="fu">mutate</span>(<span class="at">under_18 =</span> birth_year <span class="sc">&lt;</span> <span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-6">
<p>📝 From the original dataset, create a new column named <code>auburn</code> that tells us TRUE if the hair color contains that word and FALSE otherwise (reminder <code>str_detect()</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb658"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb658-1"><a href="#cb658-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb658-2"><a href="#cb658-2"></a>  <span class="fu">mutate</span>(<span class="at">auburn =</span> <span class="fu">str_detect</span>(hair_color, <span class="st">"auburn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-12-7">
<p>📝 From the original dataset, include a column that calculates BMI. After that, create a new variable that values <code>NA</code> if not human, <code>underweight</code> below 18, <code>normal</code> between 18 and 30, <code>overweight</code> above 30.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb659"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb659-1"><a href="#cb659-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb659-2"><a href="#cb659-2"></a>  <span class="fu">mutate</span>(<span class="at">IMC =</span> mass <span class="sc">/</span> ((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb659-3"><a href="#cb659-3"></a>         <span class="at">IMC_recat =</span> <span class="fu">case_when</span>(species <span class="sc">!=</span> <span class="st">"Human"</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb659-4"><a href="#cb659-4"></a>                               IMC <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">~</span> <span class="st">"underweight"</span>,</span>
<span id="cb659-5"><a href="#cb659-5"></a>                               IMC <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"normal"</span>,</span>
<span id="cb659-6"><a href="#cb659-6"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"overweight"</span>),</span>
<span id="cb659-7"><a href="#cb659-7"></a>         <span class="at">.after =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-3-1" class="slide level2">
<h2>🐣 Case study I: CIS feminismos</h2>
<p>pending to submit</p>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/tidyverse-mucss/"><strong>workbook</strong></a>.</p>
</section>
<section id="caso-practico-3-2" class="slide level2">
<h2>🐣 Case study II: Taylor Swift</h2>
<p>Let’s go back to the analysis of Taylor Swift songs we did in the previous installment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb660"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb660-1"><a href="#cb660-1"></a><span class="fu">library</span>(taylor)</span>
<span id="cb660-2"><a href="#cb660-2"></a>taylor_album_songs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 240 × 29
   album_name   ep    album_release track_number track_name     artist featuring
   &lt;chr&gt;        &lt;lgl&gt; &lt;date&gt;               &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;    
 1 Taylor Swift FALSE 2006-10-24               1 Tim McGraw     Taylo… &lt;NA&gt;     
 2 Taylor Swift FALSE 2006-10-24               2 Picture To Bu… Taylo… &lt;NA&gt;     
 3 Taylor Swift FALSE 2006-10-24               3 Teardrops On … Taylo… &lt;NA&gt;     
 4 Taylor Swift FALSE 2006-10-24               4 A Place In Th… Taylo… &lt;NA&gt;     
 5 Taylor Swift FALSE 2006-10-24               5 Cold As You    Taylo… &lt;NA&gt;     
 6 Taylor Swift FALSE 2006-10-24               6 The Outside    Taylo… &lt;NA&gt;     
 7 Taylor Swift FALSE 2006-10-24               7 Tied Together… Taylo… &lt;NA&gt;     
 8 Taylor Swift FALSE 2006-10-24               8 Stay Beautiful Taylo… &lt;NA&gt;     
 9 Taylor Swift FALSE 2006-10-24               9 Should've Sai… Taylo… &lt;NA&gt;     
10 Taylor Swift FALSE 2006-10-24              10 Mary's Song (… Taylo… &lt;NA&gt;     
# ℹ 230 more rows
# ℹ 22 more variables: bonus_track &lt;lgl&gt;, promotional_release &lt;date&gt;,
#   single_release &lt;date&gt;, track_release &lt;date&gt;, danceability &lt;dbl&gt;,
#   energy &lt;dbl&gt;, key &lt;int&gt;, loudness &lt;dbl&gt;, mode &lt;int&gt;, speechiness &lt;dbl&gt;,
#   acousticness &lt;dbl&gt;, instrumentalness &lt;dbl&gt;, liveness &lt;dbl&gt;, valence &lt;dbl&gt;,
#   tempo &lt;dbl&gt;, time_signature &lt;int&gt;, duration_ms &lt;int&gt;, explicit &lt;lgl&gt;,
#   key_name &lt;chr&gt;, mode_name &lt;chr&gt;, key_mode &lt;chr&gt;, lyrics &lt;list&gt;</code></pre>
</div>
</div>
<p>The difference is that now we will try to do everything from a <strong>tidyverse view instead of R base</strong> (it is interesting that you try to translate from one to the other to know how to master both views)</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/tidyverse-mucss/"><strong>workbook</strong></a>.</p>
</section>
<section id="caso-practico-3-3" class="slide level2">
<h2>🐣 Case study III: The Lord of the Rings</h2>
<p>To practice some <code>{dplyr}</code> functions we are going to use data from the <span class="hl-yellow"><strong>Lord of the Rings trilogy</strong></span> movies. We will load the data directly from the web (Github in this case), without going through the computer before, simply <strong>indicating as path the web where the file is</strong></p>
<ul>
<li><p>The Fellowship of the Ring -&gt; <a href="https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Fellowship_Of_The_Ring.csv" class="uri">https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Fellowship_Of_The_Ring.csv</a></p></li>
<li><p>The 2 Towers -&gt; <a href="https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Two_Towers.csv" class="uri">https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Two_Towers.csv</a></p></li>
<li><p>The Return of the King -&gt; <a href="https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Return_Of_The_King.csv" class="uri">https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Return_Of_The_King.csv</a>.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb662"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb662-1"><a href="#cb662-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb662-2"><a href="#cb662-2"></a>lotr_1 <span class="ot">&lt;-</span></span>
<span id="cb662-3"><a href="#cb662-3"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Fellowship_Of_The_Ring.csv"</span>)</span>
<span id="cb662-4"><a href="#cb662-4"></a>lotr_2 <span class="ot">&lt;-</span></span>
<span id="cb662-5"><a href="#cb662-5"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Two_Towers.csv"</span>)</span>
<span id="cb662-6"><a href="#cb662-6"></a>lotr_3 <span class="ot">&lt;-</span></span>
<span id="cb662-7"><a href="#cb662-7"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/jennybc/lotr-tidy/master/data/The_Return_Of_The_King.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/tidyverse-mucss/"><strong>workbook</strong></a>.</p>
</section></section>
<section>
<section id="clase-4" class="title-slide slide level1 center">
<h1>L4: <span class="flow">tidyverse (summaries)</span></h1>
<p><span style="color:#444442;"><strong>Summarise and group_by(). Count and summaries</strong></span></p>
<ul>
<li><p><a href="#/tu-turno-4-1">💻 Solved exercises</a></p></li>
<li><p><a href="#/caso-practico-4-1">🐣 Workbook/case study I: billboard</a></p></li>
<li><p><a href="#/caso-practico-4-2">🐣 Workbook/case study II: soccer</a></p></li>
<li><p><a href="#/planificacion-curso">📆 Planning</a></p></li>
</ul>
</section>
<section id="count" class="slide level2">
<h2>count()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb663"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb663-1"><a href="#cb663-1"></a>data <span class="sc">|&gt;</span> <span class="fu">count</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb664"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb664-1"><a href="#cb664-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>So far we have only transformed or queried the data but we have not generated statistics. Let’s start with the simple: <span class="hl-yellow"><strong>how to count (frequencies)?</strong></span></p>
<div class="fragment">
<p>When used alone <code>count()</code> will simply return the number of records, but when used with <code>count()</code> variables it calculates what is known as <span class="hl-yellow"><strong>frequencies</strong></span>: <span class="hl-purple"><strong>number of elements of each modality</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb665"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb665-1"><a href="#cb665-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</div>
</section>
<section id="count-1" class="slide level2">
<h2>count()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb667"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb667-1"><a href="#cb667-1"></a>data <span class="sc">|&gt;</span> <span class="fu">count</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb668"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb668-1"><a href="#cb668-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(var1, var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Also if we pass several variables it calculates what is known as a <span class="hl-yellow"><strong>contiguity table</strong></span>. With <code>sort = TRUE</code> it will return the <span class="hl-purple"><strong>ordered count</strong></span> (most frequent first).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb669"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb669-1"><a href="#cb669-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex, gender, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sex            gender        n
  &lt;chr&gt;          &lt;chr&gt;     &lt;int&gt;
1 male           masculine    60
2 female         feminine     16
3 none           masculine     5
4 &lt;NA&gt;           &lt;NA&gt;          4
5 hermaphroditic masculine     1
6 none           feminine      1</code></pre>
</div>
</div>
</section>
<section id="group_by" class="slide level2">
<h2>group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb671"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb671-1"><a href="#cb671-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb671-2"><a href="#cb671-2"></a>  <span class="fu">group</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb671-3"><a href="#cb671-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb671-4"><a href="#cb671-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb672"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb672-1"><a href="#cb672-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb672-2"><a href="#cb672-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb672-3"><a href="#cb672-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb672-4"><a href="#cb672-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>One of the most powerful <span class="hl-yellow"><strong>functions</strong></span> to combine with the actions seen is <code>group_by()</code>, which will allow us to <span class="hl-yellow"><strong>group our records</strong></span> beforehand.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb673"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb673-1"><a href="#cb673-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb673-2"><a href="#cb673-2"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb673-3"><a href="#cb673-3"></a>  <span class="fu">count</span>() <span class="sc">|&gt;</span></span>
<span id="cb673-4"><a href="#cb673-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</section>
<section id="group_by-1" class="slide level2">
<h2>group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb675"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb675-1"><a href="#cb675-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb675-2"><a href="#cb675-2"></a>  <span class="fu">group</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb675-3"><a href="#cb675-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb675-4"><a href="#cb675-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb676"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb676-1"><a href="#cb676-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb676-2"><a href="#cb676-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb676-3"><a href="#cb676-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb676-4"><a href="#cb676-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>When applying <code>group_by()</code> it is important to understand that it <span class="hl-yellow"><strong>DOES NOT MODIFY the data</strong></span>, but creates a <span class="hl-yellow"><strong>group variable</strong></span> (sub-tables for each group) that will modify future actions: the <span class="hl-purple"><strong>operations will be applied to each sub-table separately</strong></span></p>
<div class="fragment">
<p>For example, imagine that we want to extract the highest character with <code>slice_max()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb677"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yarael P…    264    NA none       white      yellow            NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="group_by-2" class="slide level2">
<h2>group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb679"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb679-2"><a href="#cb679-2"></a>  <span class="fu">group</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb679-3"><a href="#cb679-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb679-4"><a href="#cb679-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb680"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb680-1"><a href="#cb680-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb680-2"><a href="#cb680-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb680-3"><a href="#cb680-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb680-4"><a href="#cb680-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>What if we want to <span class="hl-yellow"><strong>extract the tallest character but…of each of the sexes</strong></span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb681"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb681-2"><a href="#cb681-2"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> </span>
<span id="cb681-3"><a href="#cb681-3"></a>  <span class="fu">slice_max</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb681-4"><a href="#cb681-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Taun We      213    NA none       grey       black             NA fema… femin…
2 Jabba De…    175  1358 &lt;NA&gt;       green-tan… orange           600 herm… mascu…
3 Yarael P…    264    NA none       white      yellow            NA male  mascu…
4 IG-88        200   140 none       metal      red               15 none  mascu…
5 Gregar T…    185    85 black      dark       brown             NA &lt;NA&gt;  &lt;NA&gt;  
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</div>
</section>
<section id="group_by-3" class="slide level2">
<h2>group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb683"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb683-1"><a href="#cb683-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb683-2"><a href="#cb683-2"></a>  <span class="fu">group</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb683-3"><a href="#cb683-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb683-4"><a href="#cb683-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb684"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb684-1"><a href="#cb684-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb684-2"><a href="#cb684-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb684-3"><a href="#cb684-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb684-4"><a href="#cb684-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/tidydatatutor_1.jpg"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/tidydatatutor_2.jpg"></p>
</div>
</div>
<p>The web <a href="https://tidydatatutor.com/" class="uri">https://tidydatatutor.com/</a> allows to visualize the operations of <code>{tidyverse}</code> (doing with the old pipe <code>%&gt;%</code>)</p>
</section>
<section id="group_by-4" class="slide level2">
<h2>group_by()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb685"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb685-1"><a href="#cb685-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb685-2"><a href="#cb685-2"></a>  <span class="fu">group</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb685-3"><a href="#cb685-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span> </span>
<span id="cb685-4"><a href="#cb685-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb686"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb686-1"><a href="#cb686-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb686-2"><a href="#cb686-2"></a>  <span class="fu">group_by</span>(var1, var2) <span class="sc">|&gt;</span> </span>
<span id="cb686-3"><a href="#cb686-3"></a>  <span class="fu">some_action</span>() <span class="sc">|&gt;</span></span>
<span id="cb686-4"><a href="#cb686-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>You should always remember to <span class="hl-red"><strong>make ungroup</strong></span> to remove the created group variable.</p>
</div>
</div>
</div>
<div class="fragment">
<p>The “new” version of <code>{dplyr}</code> now <span class="hl-yellow"><strong>allows to include the group variable</strong></span> in the call to many functions with the argument <code>by = ...</code> or <code>.by = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb687"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb687-1"><a href="#cb687-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(height, <span class="at">by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  name                  height  mass hair_color skin_color       eye_color
  &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;    
1 Yarael Poof              264    NA none       white            yellow   
2 IG-88                    200   140 none       metal            red      
3 Taun We                  213    NA none       grey             black    
4 Jabba Desilijic Tiure    175  1358 &lt;NA&gt;       green-tan, brown orange   
5 Gregar Typho             185    85 black      dark             brown    </code></pre>
</div>
</div>
</div>
</section>
<section id="row-by-row-rowwise" class="slide level2">
<h2>Row-by-row: rowwise()</h2>
<p>A very useful option used before an operation is also <code>rowwise()</code>: every <span class="hl-yellow"><strong>operation that comes afterwards will be applied on each row separately</strong></span>. For example, let’s define a dummy set of grades.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb689"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb689-1"><a href="#cb689-1"></a>grades <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"maths"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">8</span>, <span class="fl">9.1</span>, <span class="dv">3</span>),</span>
<span id="cb689-2"><a href="#cb689-2"></a>                 <span class="st">"language"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">6</span>, <span class="fl">6.5</span>, <span class="fl">9.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>If we apply the average directly the value will be identical since it has done the global average, but we would like to get an <span class="hl-yellow"><strong>average per record</strong></span>. For that we will use <code>rowwise()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb690"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1"></a>grades <span class="sc">|&gt;</span> </span>
<span id="cb690-2"><a href="#cb690-2"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb690-3"><a href="#cb690-3"></a>  <span class="fu">mutate</span>(<span class="at">ave_grades =</span> <span class="fu">mean</span>(<span class="fu">c</span>(maths, language)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Rowwise: 
  maths language ave_grades
  &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1   7.5      8         7.75
2   8        6         7   
3   9.1      6.5       7.8 
4   3        9.2       6.1 </code></pre>
</div>
</div>
</div>
</section>
<section id="summary-summarise" class="slide level2">
<h2>Summary: summarise()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb692"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1"></a>data <span class="sc">|&gt;</span> <span class="fu">simple_summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb693"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb693-1"><a href="#cb693-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Finally we have <code>summarise()</code>, which will allow us to get statistical summaries. For example, let’s <span class="hl-yellow"><strong>calculate the average of the heights</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb694"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb694-2"><a href="#cb694-2"></a>  <span class="fu">drop_na</span>(height) <span class="sc">|&gt;</span> </span>
<span id="cb694-3"><a href="#cb694-3"></a>  <span class="fu">summarise</span>(<span class="at">ave_height =</span> <span class="fu">mean</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  ave_height
       &lt;dbl&gt;
1       175.</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful</strong></p>
</div>
<div class="callout-content">
<p>Notice that <code>mutate()</code> returns <span class="hl-yellow"><strong>as many rows as original records</strong></span>, while with <code>summarise()</code> it calculates a <span class="hl-purple"><strong>new summary dataset</strong></span>, only including what is indicated.</p>
</div>
</div>
</div>
</div>
</section>
<section id="summary-summarise-1" class="slide level2">
<h2>Summary: summarise()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb696"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb696-1"><a href="#cb696-1"></a>data <span class="sc">|&gt;</span> <span class="fu">simple_summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb697"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb697-1"><a href="#cb697-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>If we also <span class="hl-yellow"><strong>combine this with the grouping</strong></span> of <code>group_by()</code> or <code>.by = ...</code>, in a few lines of code you can get <span class="hl-purple"><strong>disaggregated statistics</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb698"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb698-1"><a href="#cb698-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb698-2"><a href="#cb698-2"></a>  <span class="fu">drop_na</span>(sex, height, mass) <span class="sc">|&gt;</span> </span>
<span id="cb698-3"><a href="#cb698-3"></a>  <span class="fu">summarise</span>(<span class="at">ave_height =</span> <span class="fu">mean</span>(height),</span>
<span id="cb698-4"><a href="#cb698-4"></a>            <span class="at">ave_mass =</span> <span class="fu">mean</span>(mass),</span>
<span id="cb698-5"><a href="#cb698-5"></a>            <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  sex            ave_height ave_mass
  &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
1 male                 178.     80.2
2 none                 140      69.8
3 female               172.     54.7
4 hermaphroditic       175    1358  </code></pre>
</div>
</div>
</section>
<section id="summary-reframe" class="slide level2">
<h2>Summary: reframe()</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb700"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb700-1"><a href="#cb700-1"></a>data <span class="sc">|&gt;</span> <span class="fu">complex_summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb701"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb701-1"><a href="#cb701-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">reframe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>In the new <code>{dplyr}</code> they have included <code>reframe()</code> to avoid <code>summarise()</code> problems when <span class="hl-yellow"><strong>we return more than one value per variable</strong></span> in more complex summaries.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb702"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb702-1"><a href="#cb702-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb702-2"><a href="#cb702-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span></span>
<span id="cb702-3"><a href="#cb702-3"></a>  <span class="fu">summarise</span>(<span class="fu">quantile</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  `quantile(mass)`
             &lt;dbl&gt;
1             15  
2             55.6
3             79  
4             84.5
5           1358  </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb705"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb705-1"><a href="#cb705-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb705-2"><a href="#cb705-2"></a>  <span class="fu">drop_na</span>(mass) <span class="sc">|&gt;</span></span>
<span id="cb705-3"><a href="#cb705-3"></a>  <span class="fu">reframe</span>(<span class="fu">quantile</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 1
  `quantile(mass)`
             &lt;dbl&gt;
1             15  
2             55.6
3             79  
4             84.5
5           1358  </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="across" class="slide level2">
<h2>across()</h2>
<p>One trick is to <span class="hl-yellow"><strong>make use of selectors</strong></span> <code>across()</code> and <code>where()</code>. The former allows us to <span class="hl-purple"><strong>act on several columns by name</strong></span> (with <code>mutate()</code> or <code>summarise()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb707"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb707-1"><a href="#cb707-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">ave =</span> <span class="fu">across</span>(height<span class="sc">:</span>mass, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex            ave$height  $mass
  &lt;chr&gt;               &lt;dbl&gt;  &lt;dbl&gt;
1 male                 179.   80.2
2 none                 131.   69.8
3 female               172.   54.7
4 hermaphroditic       175  1358  
5 &lt;NA&gt;                 175    81  </code></pre>
</div>
</div>
<div class="fragment">
<p>The second, <code>where()</code>, allows us to do the same but <span class="hl-yellow"><strong>selecting by type</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb709"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb709-1"><a href="#cb709-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb709-2"><a href="#cb709-2"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.by =</span> <span class="fu">c</span>(sex, gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  sex            gender    height   mass birth_year
  &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 male           masculine   179.   80.2       84.8
2 none           masculine   140    69.8       53.3
3 female         feminine    172.   54.7       47.2
4 hermaphroditic masculine   175  1358        600  
5 &lt;NA&gt;           &lt;NA&gt;        175    81        NaN  
6 none           feminine     96   NaN        NaN  </code></pre>
</div>
</div>
</div>
</section>
<section id="tu-turno-4-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-13" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-13-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-13-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-13-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-13-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-13-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1">
<p>📝 Calculate how many characters there are of each species, ordered from most to least frequent.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb711"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb711-1"><a href="#cb711-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(species, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-13-2">
<p>📝 After eliminating missing variables for weight and height, add a new variable to calculate the BMI of each character, and determine the average BMI of our characters disaggregated by gender.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb712"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb712-1"><a href="#cb712-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb712-2"><a href="#cb712-2"></a>  <span class="fu">drop_na</span>(mass, height) <span class="sc">|&gt;</span> </span>
<span id="cb712-3"><a href="#cb712-3"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> mass <span class="sc">/</span> ((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb712-4"><a href="#cb712-4"></a>  <span class="fu">summarise</span>(<span class="at">ave_BMI =</span> <span class="fu">mean</span>(BMI), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-13-3">
<p>📝 Obtain the youngest character for each gender.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb713"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb713-1"><a href="#cb713-1"></a>starwars <span class="sc">|&gt;</span> <span class="co"># reminder that birth_year is in fact the age</span></span>
<span id="cb713-2"><a href="#cb713-2"></a>  <span class="fu">slice_min</span>(birth_year, <span class="at">by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-13-4">
<p>📝 Get the age of the youngest and oldest character of each sex.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb714"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb714-1"><a href="#cb714-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb714-2"><a href="#cb714-2"></a>  <span class="fu">drop_na</span>(birth_year) <span class="sc">|&gt;</span></span>
<span id="cb714-3"><a href="#cb714-3"></a>  <span class="fu">summarise</span>(<span class="fu">min</span>(birth_year), <span class="fu">max</span>(birth_year), <span class="at">.by =</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-13-5">
<p>📝 Determine the number of characters in each decade (take a look at <code>round()</code>, first without disaggregating and then disaggregated by sex.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb715"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb715-1"><a href="#cb715-1"></a>starwars <span class="sc">|&gt;</span></span>
<span id="cb715-2"><a href="#cb715-2"></a>  <span class="fu">count</span>(<span class="at">birth_decade =</span> <span class="fu">round</span>(birth_year, <span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-4-1" class="slide level2">
<h2>🐣 Case study I: billboard</h2>
<p>We are going to do a <strong>summary of what we learned</strong> in <code>{tidyverse}</code> with the billboard table of the <code>{tidyr}</code> package. The dataset represents something similar to the top 40 (but American version and a top 100 instead of 40): for each artist and song we store the date when it entered the ranking, and the position it occupied in the ranking in each of the weeks (<code>wk1</code>, <code>wk2</code>, …).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb716"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb716-1"><a href="#cb716-1"></a>billboard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 317 × 8
   artist         track               date.entered   wk1   wk2   wk3   wk4   wk5
   &lt;chr&gt;          &lt;chr&gt;               &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2 Pac          Baby Don't Cry (Ke… 2000-02-26      87    82    72    77    87
 2 2Ge+her        The Hardest Part O… 2000-09-02      91    87    92    NA    NA
 3 3 Doors Down   Kryptonite          2000-04-08      81    70    68    67    66
 4 3 Doors Down   Loser               2000-10-21      76    76    72    69    67
 5 504 Boyz       Wobble Wobble       2000-04-15      57    34    25    17    17
 6 98^0           Give Me Just One N… 2000-08-19      51    39    34    26    26
 7 A*Teens        Dancing Queen       2000-07-08      97    97    96    95   100
 8 Aaliyah        I Don't Wanna       2000-01-29      84    62    51    41    38
 9 Aaliyah        Try Again           2000-03-18      59    53    38    28    21
10 Adams, Yolanda Open My Heart       2000-08-26      76    76    74    69    68
# ℹ 307 more rows</code></pre>
</div>
</div>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/tidyverse-mucss/"><strong>workbook</strong></a>.</p>
</section>
<section id="caso-practico-4-2" class="slide level2">
<h2>🐣 Case study II: soccer</h2>
<p>Let’s continue <strong>practicing what we learned</strong> in <code>{tidyverse}</code> with the file <code>futbol.csv</code>, where we have <strong>data of the players of the 5 main men’s soccer leagues</strong>, from 2005 to 2019, compiling different statistics. The data has been extracted directly using the <code>{worldfootballR}</code> package, which allows us to extract data from <a href="https://www.fbref.com" class="uri">https://www.fbref.com</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb718"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb718-1"><a href="#cb718-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/futbol.csv"</span>)</span>
<span id="cb718-2"><a href="#cb718-2"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40,393 × 16
   season team    league  player     country position date_birth minutes_playing
    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;
 1   2005 Ajaccio Ligue 1 Djamel Ab… ALG     MF             1986              30
 2   2005 Ajaccio Ligue 1 Gaspar Az… POR     DF             1975            1224
 3   2005 Ajaccio Ligue 1 Yacine Be… ALG     MF             1981             140
 4   2005 Ajaccio Ligue 1 Nicolas B… FRA     MF             1976             892
 5   2005 Ajaccio Ligue 1 Marcelinh… BRA     MF             1971             704
 6   2005 Ajaccio Ligue 1 Cyril Cha… FRA     FW             1979            1308
 7   2005 Ajaccio Ligue 1 Xavier Co… FRA     DF             1974            2734
 8   2005 Ajaccio Ligue 1 Renaud Co… FRA     MF             1980             896
 9   2005 Ajaccio Ligue 1 Yohan Dem… FRA     DF,MF          1978            2658
10   2005 Ajaccio Ligue 1 Christoph… FRA     DF             1973              74
# ℹ 40,383 more rows
# ℹ 8 more variables: minutes_per_match_playing &lt;dbl&gt;, goals &lt;dbl&gt;,
#   assist &lt;dbl&gt;, goals_minus_pk &lt;dbl&gt;, pk &lt;dbl&gt;, pk_attemp &lt;dbl&gt;,
#   yellow_card &lt;dbl&gt;, red_card &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="case-study-ii-soccer" class="slide level2">
<h2>🐣 Case study II: soccer</h2>
<p>The variables capture the following information:</p>
<ul>
<li><code>season</code>, <code>team</code>, <code>league</code>: season, team and league.</li>
<li><code>player</code>, <code>country</code>, <code>position</code>, <code>date_birth</code>: name, country, position and birth of year of each player.</li>
<li><code>minutes_playing</code>, <code>matches</code>: total minutes playing and 90’ matches played</li>
<li><code>goals</code>, <code>assist</code>: goals and assists.</li>
<li><code>pk</code>, <code>pk_attemp</code>, <code>goals_minus_pk</code>: penalties, penalties attempted and goals excluding penalties.</li>
<li><code>yellow_card</code>, <code>red_card</code>: yellow/red cards.</li>
</ul>
</section>
<section id="case-study-ii-soccer-1" class="slide level2">
<h2>🐣 Case study II: soccer</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb720"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb720-1"><a href="#cb720-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40,393 × 16
   season team    league  player     country position date_birth minutes_playing
    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;
 1   2005 Ajaccio Ligue 1 Djamel Ab… ALG     MF             1986              30
 2   2005 Ajaccio Ligue 1 Gaspar Az… POR     DF             1975            1224
 3   2005 Ajaccio Ligue 1 Yacine Be… ALG     MF             1981             140
 4   2005 Ajaccio Ligue 1 Nicolas B… FRA     MF             1976             892
 5   2005 Ajaccio Ligue 1 Marcelinh… BRA     MF             1971             704
 6   2005 Ajaccio Ligue 1 Cyril Cha… FRA     FW             1979            1308
 7   2005 Ajaccio Ligue 1 Xavier Co… FRA     DF             1974            2734
 8   2005 Ajaccio Ligue 1 Renaud Co… FRA     MF             1980             896
 9   2005 Ajaccio Ligue 1 Yohan Dem… FRA     DF,MF          1978            2658
10   2005 Ajaccio Ligue 1 Christoph… FRA     DF             1973              74
# ℹ 40,383 more rows
# ℹ 8 more variables: minutes_per_match_playing &lt;dbl&gt;, goals &lt;dbl&gt;,
#   assist &lt;dbl&gt;, goals_minus_pk &lt;dbl&gt;, pk &lt;dbl&gt;, pk_attemp &lt;dbl&gt;,
#   yellow_card &lt;dbl&gt;, red_card &lt;dbl&gt;</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/tidyverse-mucss/"><strong>workbook</strong></a>.</p>
</section>
<section id="case-study-iii-speechs" class="slide level2">
<h2>🐣 Case study III: speechs</h2>
<p>Although we cannot do arithmetic operations with them, some <span class="hl-yellow"><strong>operations we can do with the text strings</strong></span> will be important. For that we will use the <code>{stringr}</code> package (within the same <code>{lubridate}</code> “universe of packages”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb722"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb722-1"><a href="#cb722-1"></a><span class="fu">library</span>(stringr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataset will be <code>discursos</code> (speeches, extracted from <a href="https://github.com/lirondos/discursos-de-navidad" class="uri">https://github.com/lirondos/discursos-de-navidad</a>) where are stored the christmas speeches of the heads of state of Spain from 1946 to 2021 (in dictatorship and in democracy)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb723"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"./data/discursos.RData"</span>)</span>
<span id="cb723-2"><a href="#cb723-2"></a><span class="co"># discursos = speeches in spanish</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/tidyverse-mucss/"><strong>workbook</strong></a>.</p>
</section></section>
<section>
<section id="clase-5" class="title-slide slide level1 center">
<h1>L5: <span class="flow">loops</span></h1>
<p><span style="color:#444442;"><strong>Coming back to R base: loops</strong></span></p>
<ul>
<li><p><a href="#/tu-turno-5-1">💻 Solved exercises</a></p></li>
<li><p><a href="#/caso-practico-5-1">🐣 Workbook/case study I</a></p></li>
<li><p><a href="#/caso-practico-5-2">🐣 Workbook/case study II</a></p></li>
</ul>
</section>
<section id="loops" class="slide level2">
<h2>Loops</h2>
<p>Although in most occasions they can be replaced by other more efficient and readable structures, it is important to know one of the most famous control expressions: the <span class="hl-yellow"><strong>loops</strong></span>.</p>
<ul>
<li><p><code>for { }</code>: allows [<strong>repeating the same code</strong>]{. hl-yellow} in a <span class="hl-purple"><strong>prefixed and known number</strong></span> of times.</p></li>
<li><p><code>while { }</code>: allows <span class="hl-yellow"><strong>repeating the same code</strong></span> but in an <span class="hl-purple"><strong>undetermined number of times</strong></span> (until a <strong>condition</strong> is no longer fulfilled).</p></li>
</ul>
</section>
<section id="for-loop" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">For loop</h2>
<p>A <span class="hl-yellow"><strong>for</strong></span> loop is a structure that allows to <span class="hl-yellow"><strong>repeat</strong></span> a set of commands a <span class="hl-purple"><strong>finite, prefixed and known number of times</strong></span> given a set of indices.</p>
<p>Let’s define a vector <code>x &lt;- c(0, -7, 1, 4)</code> and another empty variable <code>y</code>. After that we will define a for loop with <code>for () { }</code>: inside the brackets we will indicate an index and some values to traverse, inside the braces the code to execute in each iteration (in this case, fill <code>y</code> as <code>x + 1</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb724"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb724-1" class="hljs-ln-code"><a href="#cb724-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb724-2" class="hljs-ln-code"><a href="#cb724-2"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="for-loop-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">For loop</h2>
<p>A <span class="hl-yellow"><strong>for</strong></span> loop is a structure that allows to <span class="hl-yellow"><strong>repeat</strong></span> a set of commands a <span class="hl-purple"><strong>finite, prefixed and known number of times</strong></span> given a set of indices.</p>
<p>Let’s define a vector <code>x &lt;- c(0, -7, 1, 4)</code> and another empty variable <code>y</code>. After that we will define a for loop with <code>for () { }</code>: inside the brackets we will indicate an index and some values to traverse, inside the braces the code to execute in each iteration (in this case, fill <code>y</code> as <code>x + 1</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb725"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb725-1" class="hljs-ln-code"><a href="#cb725-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb725-2" class="hljs-ln-code"><a href="#cb725-2"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb725-3" class="hljs-ln-code"><a href="#cb725-3"></a></span>
<span id="cb725-4" class="hljs-ln-code"><a href="#cb725-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb725-5" class="hljs-ln-code"><a href="#cb725-5"></a>  </span>
<span id="cb725-6" class="hljs-ln-code"><a href="#cb725-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="for-loop-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">For loop</h2>
<p>A <span class="hl-yellow"><strong>for</strong></span> loop is a structure that allows to <span class="hl-yellow"><strong>repeat</strong></span> a set of commands a <span class="hl-purple"><strong>finite, prefixed and known number of times</strong></span> given a set of indices.</p>
<p>Let’s define a vector <code>x &lt;- c(0, -7, 1, 4)</code> and another empty variable <code>y</code>. After that we will define a for loop with <code>for () { }</code>: inside the brackets we will indicate an index and some values to traverse, inside the braces the code to execute in each iteration (in this case, fill <code>y</code> as <code>x + 1</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb726"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb726-1" class="hljs-ln-code"><a href="#cb726-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb726-2" class="hljs-ln-code"><a href="#cb726-2"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb726-3" class="hljs-ln-code"><a href="#cb726-3"></a></span>
<span id="cb726-4" class="hljs-ln-code"><a href="#cb726-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb726-5" class="hljs-ln-code"><a href="#cb726-5"></a>  y[i] <span class="ot">&lt;-</span> x[i] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb726-6" class="hljs-ln-code"><a href="#cb726-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="for-loop-3" class="slide level2">
<h2>For loop</h2>
<p>Note that because <code>R</code> works in a <span class="hl-yellow"><strong>default vector</strong></span> manner, the loop is the same as doing <code>x + 1</code> directly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb727"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb727-1"><a href="#cb727-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb727-2"><a href="#cb727-2"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb727-3"><a href="#cb727-3"></a></span>
<span id="cb727-4"><a href="#cb727-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb727-5"><a href="#cb727-5"></a>  y[i] <span class="ot">&lt;-</span> x[i] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb727-6"><a href="#cb727-6"></a>}</span>
<span id="cb727-7"><a href="#cb727-7"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1 -6  2  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb729"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb729-1"><a href="#cb729-1"></a>y2 <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb729-2"><a href="#cb729-2"></a>y2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1 -6  2  5</code></pre>
</div>
</div>
</section>
<section id="for-loop-4" class="slide level2">
<h2>For loop</h2>
<p>Another common option is to indicate the indexes “automatically”: from the first <code>1</code> to the last (corresponding to the length of x <code>length(x)</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb731"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb731-1"><a href="#cb731-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb731-2"><a href="#cb731-2"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb731-3"><a href="#cb731-3"></a></span>
<span id="cb731-4"><a href="#cb731-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb731-5"><a href="#cb731-5"></a>  y[i] <span class="ot">&lt;-</span> x[i] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb731-6"><a href="#cb731-6"></a>}</span>
<span id="cb731-7"><a href="#cb731-7"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1 -6  2  5</code></pre>
</div>
</div>
</section>
<section id="for-loop-5" class="slide level2">
<h2>For loop</h2>
<p>Thus the <span class="hl-yellow"><strong>general structure of a for-loop</strong></span> will always be as follows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb733"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb733-1"><a href="#cb733-1"></a><span class="cf">for</span> (index <span class="cf">in</span> set) { </span>
<span id="cb733-2"><a href="#cb733-2"></a>  código (usually depending on index)</span>
<span id="cb733-3"><a href="#cb733-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the case of for loops <span class="hl-green"><strong>ALWAYS</strong></span> we know how many iterations we have (as many as there are elements in the set to be indexed).</p>
</section>
<section id="avoiding-loop" class="slide level2">
<h2>Avoiding loop</h2>
<p>As we have already learned with the <code>{microbenchmark}</code> package, we can check how <span class="hl-yellow"><strong>loops are usually very inefficient</strong></span> (hence we should avoid them in most occasions)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb734"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb734-1"><a href="#cb734-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb734-2"><a href="#cb734-2"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb734-3"><a href="#cb734-3"></a><span class="fu">microbenchmark</span>(y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb734-4"><a href="#cb734-4"></a>               <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) { y[i] <span class="ot">&lt;-</span> x[i]<span class="sc">^</span><span class="dv">2</span> },</span>
<span id="cb734-5"><a href="#cb734-5"></a>               <span class="at">times =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: nanoseconds
                                    expr    min     lq      mean   median
                                y &lt;- x^2    984   1107   1204.58   1148.0
 for (i in 1:100) {     y[i] &lt;- x[i]^2 } 819508 832792 880888.77 844825.5
     uq     max neval
   1230    2911   500
 850094 3565483   500</code></pre>
</div>
</div>
</section>
<section id="for-loop-6" class="slide level2">
<h2>For loop</h2>
<p>We can see another example of a <span class="hl-yellow"><strong>combining numbers and text</strong></span> loop: we define a vector of ages and names, and print the i-th name and age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb736"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb736-1"><a href="#cb736-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Javi"</span>, <span class="st">"Sandra"</span>, <span class="st">"Carlos"</span>, <span class="st">"Marcos"</span>, <span class="st">"Marta"</span>)</span>
<span id="cb736-2"><a href="#cb736-2"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">27</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">29</span>)</span>
<span id="cb736-3"><a href="#cb736-3"></a></span>
<span id="cb736-4"><a href="#cb736-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) { </span>
<span id="cb736-5"><a href="#cb736-5"></a>  </span>
<span id="cb736-6"><a href="#cb736-6"></a>  <span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"{names[i]} are {ages[i]} old"</span>)) </span>
<span id="cb736-7"><a href="#cb736-7"></a>  </span>
<span id="cb736-8"><a href="#cb736-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Javi are 33 old
Sandra are 27 old
Carlos are 18 old
Marcos are 43 old
Marta are 29 old</code></pre>
</div>
</div>
</section>
<section id="for-loop-7" class="slide level2">
<h2>For loop</h2>
<p>Although they are usually indexed with numeric vectors, loops can be <span class="hl-yellow"><strong>indexed on any vector structure</strong></span>, regardless of the type of the set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb738"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb738-1"><a href="#cb738-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb738-2"><a href="#cb738-2"></a>week_days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"monday"</span>, <span class="st">"tuesday"</span>, <span class="st">"wednesday"</span>, <span class="st">"thursday"</span>,</span>
<span id="cb738-3"><a href="#cb738-3"></a>               <span class="st">"friday"</span>, <span class="st">"saturday"</span>, <span class="st">"sunday"</span>)</span>
<span id="cb738-4"><a href="#cb738-4"></a></span>
<span id="cb738-5"><a href="#cb738-5"></a><span class="cf">for</span> (days <span class="cf">in</span> week_days) {</span>
<span id="cb738-6"><a href="#cb738-6"></a>  </span>
<span id="cb738-7"><a href="#cb738-7"></a>  <span class="fu">print</span>(days)</span>
<span id="cb738-8"><a href="#cb738-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "monday"
[1] "tuesday"
[1] "wednesday"
[1] "thursday"
[1] "friday"
[1] "saturday"
[1] "sunday"</code></pre>
</div>
</div>
</section>
<section id="for-if-else" class="slide level2">
<h2>For + if-else</h2>
<p>Let’s <strong>combine conditional structures and loops</strong>: using the <code>swiss</code> set of the <code>{datasets}</code> package, let’s assign <code>NA</code> if the fertility values are greater than 80.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb740"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb740-1"><a href="#cb740-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(swiss)) {</span>
<span id="cb740-2"><a href="#cb740-2"></a>  </span>
<span id="cb740-3"><a href="#cb740-3"></a>  <span class="cf">if</span> (swiss<span class="sc">$</span>Fertility[i] <span class="sc">&gt;</span> <span class="dv">80</span>) { </span>
<span id="cb740-4"><a href="#cb740-4"></a>    </span>
<span id="cb740-5"><a href="#cb740-5"></a>    swiss<span class="sc">$</span>Fertility[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb740-6"><a href="#cb740-6"></a>    </span>
<span id="cb740-7"><a href="#cb740-7"></a>  }</span>
<span id="cb740-8"><a href="#cb740-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>This is «the same» as a vectorized <code>if_else()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb741"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb741-1"><a href="#cb741-1"></a><span class="fu">data</span>(<span class="st">"swiss"</span>)</span>
<span id="cb741-2"><a href="#cb741-2"></a>swiss<span class="sc">$</span>Fertility <span class="ot">&lt;-</span> <span class="fu">if_else</span>(swiss<span class="sc">$</span>Fertility <span class="sc">&gt;</span> <span class="dv">80</span>, <span class="cn">NA</span>, swiss<span class="sc">$</span>Fertility)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="while-loop" class="slide level2">
<h2>While loop</h2>
<p>Another way to create a loop is with the <code>while { }</code> structure, which will loop <span class="hl-yellow"><strong>an unknown number of times</strong></span>, until a condition <span class="hl-yellow"><strong>stops being met</strong></span> (in fact it may never end). For example, we will inialize a variable <code>times &lt;- 1</code>, which we will increment at each step, and we will not exit the loop until <code>times &gt; 3</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb742"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb742-1"><a href="#cb742-1"></a>times <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb742-2"><a href="#cb742-2"></a><span class="cf">while</span>(times <span class="sc">&lt;=</span> <span class="dv">3</span>) {</span>
<span id="cb742-3"><a href="#cb742-3"></a>  </span>
<span id="cb742-4"><a href="#cb742-4"></a>  <span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"Not yet, we are in the {times}-th iteration"</span>)) </span>
<span id="cb742-5"><a href="#cb742-5"></a>  times <span class="ot">&lt;-</span> times <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb742-6"><a href="#cb742-6"></a>  </span>
<span id="cb742-7"><a href="#cb742-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Not yet, we are in the 1-th iteration
Not yet, we are in the 2-th iteration
Not yet, we are in the 3-th iteration</code></pre>
</div>
<div class="sourceCode cell-code" id="cb744"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb744-1"><a href="#cb744-1"></a><span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"Now! We are in the {times}-th iteration"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Now! We are in the 4-th iteration</code></pre>
</div>
</div>
</section>
<section id="while-loop-1" class="slide level2">
<h2>While loop</h2>
<p>A <code>while</code> loop will always look like this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb746"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb746-1"><a href="#cb746-1"></a><span class="cf">while</span>(condition) {</span>
<span id="cb746-2"><a href="#cb746-2"></a>  </span>
<span id="cb746-3"><a href="#cb746-3"></a>  code to be executed <span class="cf">while</span> condition is <span class="cn">TRUE</span></span>
<span id="cb746-4"><a href="#cb746-4"></a>  <span class="co"># usually some variable is updated here</span></span>
<span id="cb746-5"><a href="#cb746-5"></a>  </span>
<span id="cb746-6"><a href="#cb746-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="while-loop-2" class="slide level2">
<h2>While loop</h2>
<p>What happens when the <span class="hl-yellow"><strong>condition is never FALSE</strong></span>? Try it yourself</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb747"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb747-1"><a href="#cb747-1"></a><span class="cf">while</span> (<span class="dv">1</span> <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb747-2"><a href="#cb747-2"></a>  </span>
<span id="cb747-3"><a href="#cb747-3"></a>  <span class="fu">print</span>(<span class="st">"Press ESC to exit"</span>)</span>
<span id="cb747-4"><a href="#cb747-4"></a>  </span>
<span id="cb747-5"><a href="#cb747-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;</p>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>A <code>while { }</code> loop can be quite “dangerous” if we do not control well how to stop it.</p>
</div>
</div>
</div>
</section>
<section id="while-loop-3" class="slide level2">
<h2>While loop</h2>
<p>We have two reserved commands to <span class="hl-yellow"><strong>abort a loop or force it forward</strong></span>:</p>
<ul>
<li><code>break</code>: allows <span class="hl-yellow"><strong>abort a loop</strong></span> even if its end has not been reached</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb748"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb748-1"><a href="#cb748-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb748-2"><a href="#cb748-2"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb748-3"><a href="#cb748-3"></a>    </span>
<span id="cb748-4"><a href="#cb748-4"></a>    <span class="cf">break</span> <span class="co"># if i = 3, we abort</span></span>
<span id="cb748-5"><a href="#cb748-5"></a>    </span>
<span id="cb748-6"><a href="#cb748-6"></a>  }</span>
<span id="cb748-7"><a href="#cb748-7"></a>  <span class="fu">print</span>(i)</span>
<span id="cb748-8"><a href="#cb748-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1
[1] 2</code></pre>
</div>
</div>
</section>
<section id="while-loop-4" class="slide level2">
<h2>While loop</h2>
<p>We have two reserved commands to <span class="hl-yellow"><strong>abort a loop or force it forward</strong></span>:</p>
<ul>
<li><code>next</code>: <span class="hl-yellow"><strong>forces a loop to advance to the next iteration</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb750"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb750-1"><a href="#cb750-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb750-2"><a href="#cb750-2"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb750-3"><a href="#cb750-3"></a>    </span>
<span id="cb750-4"><a href="#cb750-4"></a>    <span class="cf">next</span> <span class="co"># if i = 3, we advance to the next iteration</span></span>
<span id="cb750-5"><a href="#cb750-5"></a>    </span>
<span id="cb750-6"><a href="#cb750-6"></a>  }</span>
<span id="cb750-7"><a href="#cb750-7"></a>  <span class="fu">print</span>(i)</span>
<span id="cb750-8"><a href="#cb750-8"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1
[1] 2
[1] 4
[1] 5</code></pre>
</div>
</div>
</section>
<section id="tu-turno-5-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-14" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-14-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-14-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-14-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-14-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1">
<p>📝 Modify the code below to print a message on the screen if and only if all the data in <code>airquality</code> is for a month other than January.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb752"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb752-1"><a href="#cb752-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb752-2"><a href="#cb752-2"></a>months <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Month</span>
<span id="cb752-3"><a href="#cb752-3"></a></span>
<span id="cb752-4"><a href="#cb752-4"></a><span class="cf">if</span> (months <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb752-5"><a href="#cb752-5"></a>  <span class="fu">print</span>(<span class="st">"No data in January"</span>)</span>
<span id="cb752-6"><a href="#cb752-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb753"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb753-1"><a href="#cb753-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb753-2"><a href="#cb753-2"></a>months <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Month</span>
<span id="cb753-3"><a href="#cb753-3"></a></span>
<span id="cb753-4"><a href="#cb753-4"></a><span class="cf">if</span> (<span class="fu">all</span>(months <span class="sc">!=</span> <span class="dv">1</span>)) {</span>
<span id="cb753-5"><a href="#cb753-5"></a>  <span class="fu">print</span>(<span class="st">"No data in January"</span>)</span>
<span id="cb753-6"><a href="#cb753-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-2">
<p>📝 Modify the code below to store in a variable called <code>temp_high</code> a <code>TRUE</code> if any of the records has a temperature above 90 degrees Fahrenheit and <code>FALSE</code> in any other case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb754"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb754-1"><a href="#cb754-1"></a>temp <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Temp</span>
<span id="cb754-2"><a href="#cb754-2"></a></span>
<span id="cb754-3"><a href="#cb754-3"></a><span class="cf">if</span> (temp <span class="sc">==</span> <span class="dv">100</span>) {</span>
<span id="cb754-4"><a href="#cb754-4"></a>  <span class="fu">print</span>(<span class="st">"Some of the records have temperatures in excess of 90 degrees Fahrenheit"</span>)</span>
<span id="cb754-5"><a href="#cb754-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb755"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb755-1"><a href="#cb755-1"></a><span class="co"># Option 1</span></span>
<span id="cb755-2"><a href="#cb755-2"></a>temp <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Temp</span>
<span id="cb755-3"><a href="#cb755-3"></a>temp_high <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb755-4"><a href="#cb755-4"></a><span class="cf">if</span> (<span class="fu">any</span>(temp <span class="sc">&gt;</span> <span class="dv">90</span>)) {</span>
<span id="cb755-5"><a href="#cb755-5"></a>   temp_high <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb755-6"><a href="#cb755-6"></a>}</span>
<span id="cb755-7"><a href="#cb755-7"></a></span>
<span id="cb755-8"><a href="#cb755-8"></a><span class="co"># Option 2</span></span>
<span id="cb755-9"><a href="#cb755-9"></a>temp_high <span class="ot">&lt;-</span> <span class="fu">any</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-3">
<p>📝 Modify the code below to design a <code>for</code> loop of 5 iterations that only loops through the first 5 odd (and at each step of the loop prints them)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb756"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb756-1"><a href="#cb756-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb756-2"><a href="#cb756-2"></a>  </span>
<span id="cb756-3"><a href="#cb756-3"></a>  <span class="fu">print</span>(i)</span>
<span id="cb756-4"><a href="#cb756-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb757"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb757-1"><a href="#cb757-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)) {</span>
<span id="cb757-2"><a href="#cb757-2"></a>  </span>
<span id="cb757-3"><a href="#cb757-3"></a>  <span class="fu">print</span>(i)</span>
<span id="cb757-4"><a href="#cb757-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-14-4">
<p>📝 Modify the code below to design a <code>while</code> loop that starts with a counter <code>count &lt;- 1</code> and stops when it reaches 6</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb758"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb758-1"><a href="#cb758-1"></a>count <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb758-2"><a href="#cb758-2"></a><span class="cf">while</span> (count <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb758-3"><a href="#cb758-3"></a>  </span>
<span id="cb758-4"><a href="#cb758-4"></a>  <span class="fu">print</span>(count)</span>
<span id="cb758-5"><a href="#cb758-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb759"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb759-1"><a href="#cb759-1"></a>count <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb759-2"><a href="#cb759-2"></a><span class="cf">while</span> (count <span class="sc">&lt;</span> <span class="dv">6</span>) {</span>
<span id="cb759-3"><a href="#cb759-3"></a>  </span>
<span id="cb759-4"><a href="#cb759-4"></a>  <span class="fu">print</span>(count)</span>
<span id="cb759-5"><a href="#cb759-5"></a>  count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb759-6"><a href="#cb759-6"></a>  </span>
<span id="cb759-7"><a href="#cb759-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-5-1" class="slide level2">
<h2>🐣 Case study I: simulations</h2>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/flow-structures-functions/"><strong>workbook</strong></a>. On it you will have to design some simulation studies using <strong>conditional loops and structures</strong>.</p>
</section>
<section id="caso-practico-5-2" class="slide level2">
<h2>🐣 Case study II: Monty Hall problem</h2>
<p>Imagine you are in a TV contest where you are given a choice of 3 doors: in one there is a millionaire prize and in the other 2 there is an oreo cookie.</p>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/flow-structures-functions/"><strong>workbook</strong></a>. On it you will have to design some simulation studies using <strong>conditional loops and structures</strong>.</p>
</section></section>
<section>
<section id="clase-6" class="title-slide slide level1 center">
<h1>L6: <span class="flow">functions and joins</span></h1>
<p><span style="color:#444442;"><strong>Coming back to R base: functions. Joins</strong></span></p>
<ul>
<li><p><a href="#/tu-turno-6-1">💻 Solved exercises</a></p></li>
<li><p><a href="#/tu-turno-6-2">💻 Solved exercises</a></p></li>
<li><p><a href="#/caso-practico-6-1">🐣 Workbook/case study I</a></p></li>
<li><p><a href="#/caso-practico-6-2">🐣 Workbook/case study II</a></p></li>
<li><p><a href="#/planificacion-curso">📆 Planning</a></p></li>
</ul>
</section>
<section id="own-functions" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Own functions</h2>
<p>Not only can we use <strong>default functions</strong> that come already loaded in packages, we can also <span class="hl-yellow"><strong>create our own functions</strong></span> to <strong>automate tasks</strong>. How to <span class="hl-purple"><strong>create our own function</strong></span>? Let’s look at its <strong>basic scheme</strong>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Name</strong></span>: for example <code>name_fun</code> (no spaces or strange characters). To the name we <span class="hl-yellow"><strong>assign the reserved word</strong></span> <code>function()</code>.</p></li>
<li><p>Define <span class="hl-yellow"><strong>input arguments</strong></span> (inside <code>function()</code>).</p></li>
<li><p><span class="hl-yellow"><strong>Body</strong></span> of the function inside <code>{ }</code>.</p></li>
<li><p>We end the function with the <span class="hl-yellow"><strong>output arguments</strong></span> with <code>return()</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb760"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb760-1" class="hljs-ln-code"><a href="#cb760-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb760-2" class="hljs-ln-code"><a href="#cb760-2"></a>  </span>
<span id="cb760-3" class="hljs-ln-code"><a href="#cb760-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="own-functions-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Own functions</h2>
<p>Not only can we use <strong>default functions</strong> that come already loaded in packages, we can also <span class="hl-yellow"><strong>create our own functions</strong></span> to <strong>automate tasks</strong>. How to <span class="hl-purple"><strong>create our own function</strong></span>? Let’s look at its <strong>basic scheme</strong>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Name</strong></span>: for example <code>name_fun</code> (no spaces or strange characters). To the name we <span class="hl-yellow"><strong>assign the reserved word</strong></span> <code>function()</code>.</p></li>
<li><p>Define <span class="hl-yellow"><strong>input arguments</strong></span> (inside <code>function()</code>).</p></li>
<li><p><span class="hl-yellow"><strong>Body</strong></span> of the function inside <code>{ }</code>.</p></li>
<li><p>We end the function with the <span class="hl-yellow"><strong>output arguments</strong></span> with <code>return()</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb761"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb761-1" class="hljs-ln-code"><a href="#cb761-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(arg1, arg2, ...) {</span>
<span id="cb761-2" class="hljs-ln-code"><a href="#cb761-2"></a>  </span>
<span id="cb761-3" class="hljs-ln-code"><a href="#cb761-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="own-functions-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Own functions</h2>
<p>Not only can we use <strong>default functions</strong> that come already loaded in packages, we can also <span class="hl-yellow"><strong>create our own functions</strong></span> to <strong>automate tasks</strong>. How to <span class="hl-purple"><strong>create our own function</strong></span>? Let’s look at its <strong>basic scheme</strong>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Name</strong></span>: for example <code>name_fun</code> (no spaces or strange characters). To the name we <span class="hl-yellow"><strong>assign the reserved word</strong></span> <code>function()</code>.</p></li>
<li><p>Define <span class="hl-yellow"><strong>input arguments</strong></span> (inside <code>function()</code>).</p></li>
<li><p><span class="hl-yellow"><strong>Body</strong></span> of the function inside <code>{ }</code>.</p></li>
<li><p>We end the function with the <span class="hl-yellow"><strong>output arguments</strong></span> with <code>return()</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb762"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb762-1" class="hljs-ln-code"><a href="#cb762-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(arg1, arg2, ...) {</span>
<span id="cb762-2" class="hljs-ln-code"><a href="#cb762-2"></a>  </span>
<span id="cb762-3" class="hljs-ln-code"><a href="#cb762-3"></a>  code to be executed</span>
<span id="cb762-4" class="hljs-ln-code"><a href="#cb762-4"></a>  </span>
<span id="cb762-5" class="hljs-ln-code"><a href="#cb762-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="own-functions-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Own functions</h2>
<p>Not only can we use <strong>default functions</strong> that come already loaded in packages, we can also <span class="hl-yellow"><strong>create our own functions</strong></span> to <strong>automate tasks</strong>. How to <span class="hl-purple"><strong>create our own function</strong></span>? Let’s look at its <strong>basic scheme</strong>:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Name</strong></span>: for example <code>name_fun</code> (no spaces or strange characters). To the name we <span class="hl-yellow"><strong>assign the reserved word</strong></span> <code>function()</code>.</p></li>
<li><p>Define <span class="hl-yellow"><strong>input arguments</strong></span> (inside <code>function()</code>).</p></li>
<li><p><span class="hl-yellow"><strong>Body</strong></span> of the function inside <code>{ }</code>.</p></li>
<li><p>We end the function with the <span class="hl-yellow"><strong>output arguments</strong></span> with <code>return()</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb763"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb763-1" class="hljs-ln-code"><a href="#cb763-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(arg1, arg2, ...) {</span>
<span id="cb763-2" class="hljs-ln-code"><a href="#cb763-2"></a>  </span>
<span id="cb763-3" class="hljs-ln-code"><a href="#cb763-3"></a>  code to be executed</span>
<span id="cb763-4" class="hljs-ln-code"><a href="#cb763-4"></a>  </span>
<span id="cb763-5" class="hljs-ln-code"><a href="#cb763-5"></a>  <span class="fu">return</span>(var_output)</span>
<span id="cb763-6" class="hljs-ln-code"><a href="#cb763-6"></a>  </span>
<span id="cb763-7" class="hljs-ln-code"><a href="#cb763-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="own-functions-4" class="slide level2">
<h2>Own functions</h2>
<ul>
<li><p><code>arg1, arg2, ...</code>: will be the <span class="hl-yellow"><strong>input arguments</strong></span>, the arguments that the function takes to execute the code inside.</p></li>
<li><p><code>code</code>: lines of code that we want to <span class="hl-yellow"><strong>execute the function</strong></span>.</p></li>
<li><p><code>return(var_output)</code>: the <span class="hl-yellow"><strong>output arguments</strong></span> will be entered.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb764"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb764-1"><a href="#cb764-1"></a>name_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(arg1, arg2, ...) {</span>
<span id="cb764-2"><a href="#cb764-2"></a>  </span>
<span id="cb764-3"><a href="#cb764-3"></a>  <span class="co"># Code to be executed</span></span>
<span id="cb764-4"><a href="#cb764-4"></a>  code</span>
<span id="cb764-5"><a href="#cb764-5"></a>  </span>
<span id="cb764-6"><a href="#cb764-6"></a>  <span class="co"># Output</span></span>
<span id="cb764-7"><a href="#cb764-7"></a>  <span class="fu">return</span>(var_output)</span>
<span id="cb764-8"><a href="#cb764-8"></a>  </span>
<span id="cb764-9"><a href="#cb764-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>All variables that we define inside the function are <span class="hl-yellow"><strong>LOCAL variables: they will only exist inside the function</strong></span> unless we specify otherwise.</p>
</div>
</div>
</div>
</section>
<section id="own-functions-5" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Own functions</h2>
<p>Let’s look at a very simple example of a function for <span class="hl-yellow"><strong>calculating the area of a rectangle</strong></span>.</p>
<p>Since the area of a rectangle is calculated as the <strong>product of its sides</strong>, we will need just that, its sides: those will be the <span class="hl-yellow"><strong>input arguments</strong></span> and the <span class="hl-purple"><strong>value to return</strong></span> will be just its <strong>area</strong> (<span class="math inline">\(side_1 * side_2\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb765"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb765-1" class="hljs-ln-code"><a href="#cb765-1"></a><span class="co"># We define the name of function and input arguments</span></span>
<span id="cb765-2" class="hljs-ln-code"><a href="#cb765-2"></a>compute_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, side_2) {</span>
<span id="cb765-3" class="hljs-ln-code"><a href="#cb765-3"></a>  </span>
<span id="cb765-4" class="hljs-ln-code"><a href="#cb765-4"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="own-functions-6" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Own functions</h2>
<p>Let’s look at a very simple example of a function for <span class="hl-yellow"><strong>calculating the area of a rectangle</strong></span>.</p>
<p>Since the area of a rectangle is calculated as the <strong>product of its sides</strong>, we will need just that, its sides: those will be the <span class="hl-yellow"><strong>input arguments</strong></span> and the <span class="hl-purple"><strong>value to return</strong></span> will be just its <strong>area</strong> (<span class="math inline">\(side_1 * side_2\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb766"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb766-1" class="hljs-ln-code"><a href="#cb766-1"></a><span class="co"># We define the name of function and input arguments</span></span>
<span id="cb766-2" class="hljs-ln-code"><a href="#cb766-2"></a>compute_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, side_2) {</span>
<span id="cb766-3" class="hljs-ln-code"><a href="#cb766-3"></a>  </span>
<span id="cb766-4" class="hljs-ln-code"><a href="#cb766-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb766-5" class="hljs-ln-code"><a href="#cb766-5"></a>  </span>
<span id="cb766-6" class="hljs-ln-code"><a href="#cb766-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="own-functions-7" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Own functions</h2>
<p>Let’s look at a very simple example of a function for <span class="hl-yellow"><strong>calculating the area of a rectangle</strong></span>.</p>
<p>Since the area of a rectangle is calculated as the <strong>product of its sides</strong>, we will need just that, its sides: those will be the <span class="hl-yellow"><strong>input arguments</strong></span> and the <span class="hl-purple"><strong>value to return</strong></span> will be just its <strong>area</strong> (<span class="math inline">\(side_1 * side_2\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb767"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb767-1" class="hljs-ln-code"><a href="#cb767-1"></a><span class="co"># We define the name of function and input arguments</span></span>
<span id="cb767-2" class="hljs-ln-code"><a href="#cb767-2"></a>compute_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, side_2) {</span>
<span id="cb767-3" class="hljs-ln-code"><a href="#cb767-3"></a>  </span>
<span id="cb767-4" class="hljs-ln-code"><a href="#cb767-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb767-5" class="hljs-ln-code"><a href="#cb767-5"></a>  <span class="fu">return</span>(area)</span>
<span id="cb767-6" class="hljs-ln-code"><a href="#cb767-6"></a>  </span>
<span id="cb767-7" class="hljs-ln-code"><a href="#cb767-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="own-functions-8" class="slide level2">
<h2>Own functions</h2>
<p>We can also make a direct definition of variables <strong>without storing along the way</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb768"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb768-1"><a href="#cb768-1"></a><span class="co"># We define the name of function and input arguments</span></span>
<span id="cb768-2"><a href="#cb768-2"></a>compute_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, side_2) {</span>
<span id="cb768-3"><a href="#cb768-3"></a>  </span>
<span id="cb768-4"><a href="#cb768-4"></a>  <span class="fu">return</span>(side_1 <span class="sc">*</span> side_2)</span>
<span id="cb768-5"><a href="#cb768-5"></a>  </span>
<span id="cb768-6"><a href="#cb768-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p><span class="hl-yellow"><strong>How to apply our function?</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb769"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb769-1"><a href="#cb769-1"></a><span class="fu">compute_area</span>(<span class="dv">5</span>, <span class="dv">3</span>) <span class="co"># area of 5 x 3 rectangle</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb771"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb771-1"><a href="#cb771-1"></a><span class="fu">compute_area</span>(<span class="dv">1</span>, <span class="dv">5</span>) <span class="co"># area of 1 x 5 rectangle</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
</div>
</section>
<section id="own-functions-9" class="slide level2">
<h2>Own functions</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Consejo</strong></p>
</div>
<div class="callout-content">
<p>Although it is not necessary, it is <span class="hl-green"><strong>recommendable to make explicit the calling of the arguments</strong></span>, specifying in the code what value is for each argument so that it does not depend on its order, making the code more readable.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb773"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb773-1"><a href="#cb773-1"></a><span class="fu">compute_area</span>(<span class="at">side_1 =</span> <span class="dv">5</span>, <span class="at">side_2 =</span> <span class="dv">3</span>) <span class="co"># area of 5 x 3 rectangle</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb775"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb775-1"><a href="#cb775-1"></a><span class="fu">compute_area</span>(<span class="at">side_2 =</span> <span class="dv">3</span>, <span class="at">side_1 =</span> <span class="dv">5</span>) <span class="co"># area of 5 x 3 rectangle</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
</div>
</section>
<section id="default-arguments" class="slide level2">
<h2>Default arguments</h2>
<p>Imagine now that we realize that 90% of the time we use such a function to <span class="hl-yellow"><strong>default calculate the area of a square</strong></span> (i.e., we only need one side). To do this, we can define <span class="hl-yellow"><strong>default arguments</strong></span> in the function: they will take that value unless we assign another one.</p>
<p>Why not assign <code>side_2 = side_1</code> <strong>default</strong>, to save lines of code and time?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb777"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb777-1"><a href="#cb777-1"></a>compute_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, <span class="at">side_2 =</span> side_1) {</span>
<span id="cb777-2"><a href="#cb777-2"></a>  </span>
<span id="cb777-3"><a href="#cb777-3"></a>  <span class="co"># Code to be executed</span></span>
<span id="cb777-4"><a href="#cb777-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb777-5"><a href="#cb777-5"></a>  </span>
<span id="cb777-6"><a href="#cb777-6"></a>  <span class="co"># Output</span></span>
<span id="cb777-7"><a href="#cb777-7"></a>  <span class="fu">return</span>(area)</span>
<span id="cb777-8"><a href="#cb777-8"></a>  </span>
<span id="cb777-9"><a href="#cb777-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="default-arguments-1" class="slide level2">
<h2>Default arguments</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb778"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb778-1"><a href="#cb778-1"></a>compute_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, <span class="at">side_2 =</span> side_1) {</span>
<span id="cb778-2"><a href="#cb778-2"></a>  </span>
<span id="cb778-3"><a href="#cb778-3"></a>  <span class="co"># Code to be executed</span></span>
<span id="cb778-4"><a href="#cb778-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb778-5"><a href="#cb778-5"></a>  </span>
<span id="cb778-6"><a href="#cb778-6"></a>  <span class="co"># Output</span></span>
<span id="cb778-7"><a href="#cb778-7"></a>  <span class="fu">return</span>(area)</span>
<span id="cb778-8"><a href="#cb778-8"></a>  </span>
<span id="cb778-9"><a href="#cb778-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now <span class="hl-yellow"><strong>default</strong></span> the second side will be equal to the first (if added it will use both).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb779"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb779-1"><a href="#cb779-1"></a><span class="fu">compute_area</span>(<span class="at">side_1 =</span> <span class="dv">5</span>) <span class="co"># square</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb781"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb781-1"><a href="#cb781-1"></a><span class="fu">compute_area</span>(<span class="at">side_1 =</span> <span class="dv">5</span>, <span class="at">side_2 =</span> <span class="dv">7</span>) <span class="co"># rectangle</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35</code></pre>
</div>
</div>
</section>
<section id="multiple-outputs" class="slide level2">
<h2>Multiple outputs</h2>
<p>Let’s complicate the function a bit and add in the output the values of each side, labeled <code>side_1</code> and <code>side_2</code>, <span class="hl-yellow"><strong>packing the output in a vector</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb783" data-code-line-numbers="7-8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb783-1"><a href="#cb783-1"></a>compute_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, <span class="at">side_2 =</span> side_1) {</span>
<span id="cb783-2"><a href="#cb783-2"></a>  </span>
<span id="cb783-3"><a href="#cb783-3"></a>  <span class="co"># Code</span></span>
<span id="cb783-4"><a href="#cb783-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb783-5"><a href="#cb783-5"></a>  </span>
<span id="cb783-6"><a href="#cb783-6"></a>  <span class="co"># Output</span></span>
<span id="cb783-7"><a href="#cb783-7"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">"area"</span> <span class="ot">=</span> area, <span class="st">"side_1"</span> <span class="ot">=</span> side_1, <span class="st">"side_2"</span> <span class="ot">=</span> side_2))</span>
<span id="cb783-8"><a href="#cb783-8"></a>  </span>
<span id="cb783-9"><a href="#cb783-9"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multiple-outputs-1" class="slide level2">
<h2>Multiple outputs</h2>
<p>We can complicate the output a little more by adding a fourth variable that tells us, depending on the arguments, <span class="hl-yellow"><strong>whether rectangle or square</strong></span>, having to add a character (or logic) variable in the output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb784" data-code-line-numbers="7-9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb784-1"><a href="#cb784-1"></a>compute_area <span class="ot">&lt;-</span> <span class="cf">function</span>(side_1, <span class="at">side_2 =</span> side_1) {</span>
<span id="cb784-2"><a href="#cb784-2"></a>  </span>
<span id="cb784-3"><a href="#cb784-3"></a>  <span class="co"># Code</span></span>
<span id="cb784-4"><a href="#cb784-4"></a>  area <span class="ot">&lt;-</span> side_1 <span class="sc">*</span> side_2</span>
<span id="cb784-5"><a href="#cb784-5"></a>  </span>
<span id="cb784-6"><a href="#cb784-6"></a>  <span class="co"># Output</span></span>
<span id="cb784-7"><a href="#cb784-7"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">"area"</span> <span class="ot">=</span> area, <span class="st">"side_1"</span> <span class="ot">=</span> side_1, <span class="st">"side_2"</span> <span class="ot">=</span> side_2,</span>
<span id="cb784-8"><a href="#cb784-8"></a>           <span class="st">"type"</span> <span class="ot">=</span> <span class="fu">if_else</span>(side_1 <span class="sc">==</span> side_2, <span class="st">"square"</span>, <span class="st">"rectangle"</span>)))</span>
<span id="cb784-9"><a href="#cb784-9"></a>  </span>
<span id="cb784-10"><a href="#cb784-10"></a>}</span>
<span id="cb784-11"><a href="#cb784-11"></a><span class="fu">compute_area</span>(<span class="dv">5</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       area      side_1      side_2        type 
       "15"         "5"         "3" "rectangle" </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="hl-red"><strong>Problem</strong></span>: when trying to put numbers and text together, it converts everything to numbers. We could store it all in a <code>tibble()</code> as we have learned or in an object known in <code>R</code> as <span class="hl-yellow"><strong>lists</strong></span> (we will see it later).</p>
</div>
</section>
<section id="order-of-arguments" class="slide level2">
<h2>Order of arguments</h2>
<p>Before we did not care about the order of the arguments, but now the <span class="hl-yellow"><strong>order of the input arguments matters</strong></span>, since we include <code>side_1</code> and <code>side_2</code> in the output.</p>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>As mentioned, it is highly recommended to make the function call <span class="hl-yellow"><strong>explicitly setting the arguments</strong></span> to improve <strong>legibility and interpretability</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb786"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb786-1"><a href="#cb786-1"></a><span class="co"># Equivalent to compute_area(5, 3)</span></span>
<span id="cb786-2"><a href="#cb786-2"></a><span class="fu">compute_area</span>(<span class="at">side_1 =</span> <span class="dv">5</span>, <span class="at">side_2 =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       area      side_1      side_2        type 
       "15"         "5"         "3" "rectangle" </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="generating-knowledge" class="slide level2">
<h2>Generating knowledge</h2>
<p>It seems silly what we have done but we have crossed an important frontier: we have gone from <span class="hl-yellow"><strong>consuming knowledge</strong></span> (code from other packages, elaborated by others), to <span class="hl-purple"><strong>generating knowledge</strong></span>, creating our own functions.</p>
<div class="fragment">
<p>Functions are going to be key in your day-to-day work because they will allow you to automate code that you are going to repeat over and over again: by packaging that code under an alias (function name) you will <span class="hl-yellow"><strong>be able to use it over and over again without programming it (so doing twice as much work will not imply working twice as much)</strong></span></p>
</div>
</section>
<section id="local-vs-global-variables" class="slide level2">
<h2>Local vs global variables</h2>
<p>An important aspect to think about with functions: what happens if we <span class="hl-yellow"><strong>name a variable inside</strong></span> a function to which we have <strong>forgotten to assign</strong> a value inside the function.</p>
<div class="fragment">
<p>We must be cautious when using functions in <code>R</code>, since due to the <span class="hl-yellow"><strong>“lexicographic rule”</strong></span>, if a variable is not defined inside the function, <code>R</code> will <span class="hl-purple"><strong>look for that variable in the environment</strong></span> of variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb788"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb788-1"><a href="#cb788-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb788-2"><a href="#cb788-2"></a>fun_example <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb788-3"><a href="#cb788-3"></a>    </span>
<span id="cb788-4"><a href="#cb788-4"></a>  <span class="fu">print</span>(x) <span class="co"># No output, just doing an action</span></span>
<span id="cb788-5"><a href="#cb788-5"></a>}</span>
<span id="cb788-6"><a href="#cb788-6"></a><span class="fu">fun_example</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</div>
</section>
<section id="local-vs-global-variables-1" class="slide level2">
<h2>Local vs global variables</h2>
<p>If a variable <span class="hl-yellow"><strong>is already defined outside the function (global environment)</strong></span>, and is also used inside changing its value, the value <span class="hl-yellow"><strong>only changes inside</strong></span> but <span class="hl-red"><strong>not in the global environment</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb790"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb790-1"><a href="#cb790-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb790-2"><a href="#cb790-2"></a>fun_example <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb790-3"><a href="#cb790-3"></a>    </span>
<span id="cb790-4"><a href="#cb790-4"></a>  x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb790-5"><a href="#cb790-5"></a>  <span class="fu">print</span>(x) <span class="co"># value inside of function</span></span>
<span id="cb790-6"><a href="#cb790-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb791"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb791-1"><a href="#cb791-1"></a><span class="co"># value inside of function (local)</span></span>
<span id="cb791-2"><a href="#cb791-2"></a><span class="fu">fun_example</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb793"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb793-1"><a href="#cb793-1"></a><span class="co"># value output of function (global)</span></span>
<span id="cb793-2"><a href="#cb793-2"></a><span class="fu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="local-vs-global-variables-2" class="slide level2">
<h2>Local vs global variables</h2>
<p>If we want it to change locally as well as <span class="hl-yellow"><strong>globally</strong></span> we must use the <span class="hl-yellow"><strong>double assignment</strong></span> (<code>&lt;&lt;-</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb795"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb795-1"><a href="#cb795-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb795-2"><a href="#cb795-2"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb795-3"><a href="#cb795-3"></a>fun_example <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb795-4"><a href="#cb795-4"></a>  </span>
<span id="cb795-5"><a href="#cb795-5"></a>  <span class="co"># no change in a global way, just locally</span></span>
<span id="cb795-6"><a href="#cb795-6"></a>  x <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb795-7"><a href="#cb795-7"></a>  <span class="co"># change in a global way</span></span>
<span id="cb795-8"><a href="#cb795-8"></a>  y <span class="ot">&lt;&lt;-</span> <span class="dv">0</span> <span class="co">#&lt;&lt;</span></span>
<span id="cb795-9"><a href="#cb795-9"></a>  </span>
<span id="cb795-10"><a href="#cb795-10"></a>  <span class="fu">print</span>(x)</span>
<span id="cb795-11"><a href="#cb795-11"></a>  <span class="fu">print</span>(y)</span>
<span id="cb795-12"><a href="#cb795-12"></a>}</span>
<span id="cb795-13"><a href="#cb795-13"></a></span>
<span id="cb795-14"><a href="#cb795-14"></a><span class="fu">fun_example</span>() <span class="co"># value inside function (local)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3
[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb797"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb797-1"><a href="#cb797-1"></a>x <span class="co"># global value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb799"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb799-1"><a href="#cb799-1"></a>y <span class="co"># global value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="tu-turno-6-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<p><span style="color:#444442;"><strong>Try to perform the following exercises without looking at the solutions</strong></span></p>
<div class="panel-tabset">
<ul id="tabset-15" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-15-1"><span class="hl-yellow"><strong>Ex 1</strong></span></a></li><li><a href="#tabset-15-2"><span class="hl-yellow"><strong>Ex 2</strong></span></a></li><li><a href="#tabset-15-3"><span class="hl-yellow"><strong>Ex 3</strong></span></a></li><li><a href="#tabset-15-4"><span class="hl-yellow"><strong>Ex 4</strong></span></a></li><li><a href="#tabset-15-5"><span class="hl-yellow"><strong>Ex 5</strong></span></a></li><li><a href="#tabset-15-6"><span class="hl-yellow"><strong>Ex 6</strong></span></a></li><li><a href="#tabset-15-7"><span class="hl-yellow"><strong>Ex 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-15-1">
<p>📝 Modify the code below to define a function called <code>sum_function</code>, so that given two elements, it returns their sum.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb801"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb801-1"><a href="#cb801-1"></a>name <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb801-2"><a href="#cb801-2"></a>  sum_output <span class="ot">&lt;-</span> <span class="co"># code</span></span>
<span id="cb801-3"><a href="#cb801-3"></a>  <span class="fu">return</span>()</span>
<span id="cb801-4"><a href="#cb801-4"></a>}</span>
<span id="cb801-5"><a href="#cb801-5"></a><span class="co"># we apply the function</span></span>
<span id="cb801-6"><a href="#cb801-6"></a><span class="fu">sum_function</span>(<span class="dv">3</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb802"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb802-1"><a href="#cb802-1"></a>sum_function<span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb802-2"><a href="#cb802-2"></a>  sum_output <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb802-3"><a href="#cb802-3"></a>  <span class="fu">return</span>(sum_output)</span>
<span id="cb802-4"><a href="#cb802-4"></a>}</span>
<span id="cb802-5"><a href="#cb802-5"></a><span class="fu">sum_function</span>(<span class="dv">3</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-2">
<p>📝 Modify the code below to define a function called <code>product_function</code>, so that given two elements, it returns their product, but by default it calculates the square</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb803"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb803-1"><a href="#cb803-1"></a>name <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb803-2"><a href="#cb803-2"></a>  prod_output <span class="ot">&lt;-</span> <span class="co"># code</span></span>
<span id="cb803-3"><a href="#cb803-3"></a>  <span class="fu">return</span>()</span>
<span id="cb803-4"><a href="#cb803-4"></a>}</span>
<span id="cb803-5"><a href="#cb803-5"></a><span class="fu">product_function</span>(<span class="dv">3</span>)</span>
<span id="cb803-6"><a href="#cb803-6"></a><span class="fu">product_function</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb804"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb804-1"><a href="#cb804-1"></a>product_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">y =</span> x) {</span>
<span id="cb804-2"><a href="#cb804-2"></a>  </span>
<span id="cb804-3"><a href="#cb804-3"></a>  prod_output <span class="ot">&lt;-</span> x <span class="sc">*</span> y</span>
<span id="cb804-4"><a href="#cb804-4"></a>  <span class="fu">return</span>(prod_output)</span>
<span id="cb804-5"><a href="#cb804-5"></a>  </span>
<span id="cb804-6"><a href="#cb804-6"></a>}</span>
<span id="cb804-7"><a href="#cb804-7"></a><span class="fu">product_function</span>(<span class="dv">3</span>)</span>
<span id="cb804-8"><a href="#cb804-8"></a><span class="fu">product_function</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-3">
<p>📝 Define a function called <code>equal_names</code> that, given two names, tells us if they are equal or not. Do this by considering case-sensitive, and case-insensitive. Use the <code>{stringr}</code> package.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb805"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb805-1"><a href="#cb805-1"></a><span class="co"># Case-sensitive</span></span>
<span id="cb805-2"><a href="#cb805-2"></a>equal_names <span class="ot">&lt;-</span> <span class="cf">function</span>(person_1, person_2) {</span>
<span id="cb805-3"><a href="#cb805-3"></a>  </span>
<span id="cb805-4"><a href="#cb805-4"></a>  <span class="fu">return</span>(person_1 <span class="sc">==</span> person_2)</span>
<span id="cb805-5"><a href="#cb805-5"></a>  </span>
<span id="cb805-6"><a href="#cb805-6"></a>}</span>
<span id="cb805-7"><a href="#cb805-7"></a><span class="fu">equal_names</span>(<span class="st">"Javi"</span>, <span class="st">"javi"</span>)</span>
<span id="cb805-8"><a href="#cb805-8"></a><span class="fu">equal_names</span>(<span class="st">"Javi"</span>, <span class="st">"Lucía"</span>)</span>
<span id="cb805-9"><a href="#cb805-9"></a></span>
<span id="cb805-10"><a href="#cb805-10"></a><span class="co"># Case-insensitive</span></span>
<span id="cb805-11"><a href="#cb805-11"></a><span class="fu">library</span>(stringr)</span>
<span id="cb805-12"><a href="#cb805-12"></a>equal_names <span class="ot">&lt;-</span> <span class="cf">function</span>(person_1, person_2) {</span>
<span id="cb805-13"><a href="#cb805-13"></a>  </span>
<span id="cb805-14"><a href="#cb805-14"></a>  <span class="fu">return</span>(<span class="fu">str_equal</span>(person_1, person_2, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb805-15"><a href="#cb805-15"></a>  </span>
<span id="cb805-16"><a href="#cb805-16"></a>  <span class="co"># other option</span></span>
<span id="cb805-17"><a href="#cb805-17"></a>  <span class="co"># return(str_to_lower(person_1) == str_to_lower(person_2))</span></span>
<span id="cb805-18"><a href="#cb805-18"></a>  </span>
<span id="cb805-19"><a href="#cb805-19"></a>  <span class="co"># other option</span></span>
<span id="cb805-20"><a href="#cb805-20"></a>  <span class="co"># return(str_to_upper(person_1) == str_to_upper(person_2))</span></span>
<span id="cb805-21"><a href="#cb805-21"></a>  </span>
<span id="cb805-22"><a href="#cb805-22"></a>}</span>
<span id="cb805-23"><a href="#cb805-23"></a><span class="fu">equal_names</span>(<span class="st">"Javi"</span>, <span class="st">"javi"</span>)</span>
<span id="cb805-24"><a href="#cb805-24"></a><span class="fu">equal_names</span>(<span class="st">"Javi"</span>, <span class="st">"Lucía"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-4">
<p>📝 Create a function called <code>compute_BMI</code> that, given two arguments (weight and height in meters) and a name, returns a list with the BMI (<span class="math inline">\(weight/(height^2)\)</span>) and the name.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb806"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb806-1"><a href="#cb806-1"></a>compute_BMI <span class="ot">&lt;-</span> <span class="cf">function</span>(name, weight, height) {</span>
<span id="cb806-2"><a href="#cb806-2"></a>  </span>
<span id="cb806-3"><a href="#cb806-3"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">"name"</span> <span class="ot">=</span> name, <span class="st">"BMI"</span> <span class="ot">=</span> weight<span class="sc">/</span>(height<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb806-4"><a href="#cb806-4"></a>  </span>
<span id="cb806-5"><a href="#cb806-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-5">
<p>📝 Repeat the previous exercise but with another optional argument called units (by default, <code>units = “meters”</code>). Develop the function so that it does the right thing if <code>units = “meters”</code> and if <code>units = “centimeters”</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb807"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb807-1"><a href="#cb807-1"></a>compute_BMI <span class="ot">&lt;-</span> <span class="cf">function</span>(name, weight, height, <span class="at">units =</span> <span class="st">"meters"</span>) {</span>
<span id="cb807-2"><a href="#cb807-2"></a>  </span>
<span id="cb807-3"><a href="#cb807-3"></a>  <span class="cf">if</span> (units <span class="sc">==</span> <span class="st">"meters"</span>) {</span>
<span id="cb807-4"><a href="#cb807-4"></a>    </span>
<span id="cb807-5"><a href="#cb807-5"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">"name"</span> <span class="ot">=</span> name, <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb807-6"><a href="#cb807-6"></a>  } <span class="cf">else</span> <span class="cf">if</span> (units <span class="sc">==</span> <span class="st">"centimeters"</span>) {</span>
<span id="cb807-7"><a href="#cb807-7"></a>    </span>
<span id="cb807-8"><a href="#cb807-8"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">"name"</span> <span class="ot">=</span> name, <span class="st">"BMI"</span> <span class="ot">=</span> weight <span class="sc">/</span> ((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb807-9"><a href="#cb807-9"></a>  }</span>
<span id="cb807-10"><a href="#cb807-10"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-6">
<p>📝 Create a fictitious tibble of 7 persons, with three variables (invent name, and simulate weight, height in centimeters), and apply the defined function so that we obtain a fourth column with their BMI.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb808"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb808-1"><a href="#cb808-1"></a>data <span class="ot">&lt;-</span></span>
<span id="cb808-2"><a href="#cb808-2"></a>  <span class="fu">tibble</span>(<span class="st">"name"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"sandra"</span>, <span class="st">"laura"</span>,</span>
<span id="cb808-3"><a href="#cb808-3"></a>                       <span class="st">"ana"</span>, <span class="st">"carlos"</span>, <span class="st">"leo"</span>, <span class="cn">NA</span>),</span>
<span id="cb808-4"><a href="#cb808-4"></a>         <span class="st">"weight"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb808-5"><a href="#cb808-5"></a>         <span class="st">"height"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">168</span>, <span class="at">sd =</span> <span class="dv">5</span>))</span>
<span id="cb808-6"><a href="#cb808-6"></a></span>
<span id="cb808-7"><a href="#cb808-7"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb808-8"><a href="#cb808-8"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> <span class="fu">compute_BMI</span>(name, weight, height, <span class="at">units =</span> <span class="st">"centimeters"</span>)<span class="sc">$</span>BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-15-7">
<p>📝 Create a function called <code>shortcut</code> that has two numeric arguments <code>x</code> and <code>y</code>. If both are equal, you should return <code>equal</code> and have the function terminate automatically (think about when a function exits). WARNING: <code>x</code> and <code>y</code> could be vectors. If they are different (of equal length) calculate the proportion of different elements. If they are different (being of different length), it returns the elements that are not common.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb809"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb809-1"><a href="#cb809-1"></a>shortcut <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb809-2"><a href="#cb809-2"></a>  </span>
<span id="cb809-3"><a href="#cb809-3"></a>  <span class="cf">if</span> (<span class="fu">all</span>(x <span class="sc">==</span> y) <span class="sc">&amp;</span> <span class="fu">length</span>(x) <span class="sc">==</span> <span class="fu">length</span>(y)) { <span class="fu">return</span>(<span class="st">"equal"</span>) }</span>
<span id="cb809-4"><a href="#cb809-4"></a>  <span class="cf">else</span> {</span>
<span id="cb809-5"><a href="#cb809-5"></a>   </span>
<span id="cb809-6"><a href="#cb809-6"></a>    <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">==</span> <span class="fu">length</span>(y)) {</span>
<span id="cb809-7"><a href="#cb809-7"></a>      </span>
<span id="cb809-8"><a href="#cb809-8"></a>      n_diff <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">!=</span> y) <span class="sc">/</span> <span class="fu">length</span>(x)</span>
<span id="cb809-9"><a href="#cb809-9"></a>      <span class="fu">return</span>(n_diff)</span>
<span id="cb809-10"><a href="#cb809-10"></a>      </span>
<span id="cb809-11"><a href="#cb809-11"></a>    } <span class="cf">else</span> {</span>
<span id="cb809-12"><a href="#cb809-12"></a>      </span>
<span id="cb809-13"><a href="#cb809-13"></a>      diff_elem <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">setdiff</span>(x, y), <span class="fu">setdiff</span>(y, x)))</span>
<span id="cb809-14"><a href="#cb809-14"></a>      <span class="fu">return</span>(diff_elem)</span>
<span id="cb809-15"><a href="#cb809-15"></a>    }</span>
<span id="cb809-16"><a href="#cb809-16"></a>    </span>
<span id="cb809-17"><a href="#cb809-17"></a>  }</span>
<span id="cb809-18"><a href="#cb809-18"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-6-1" class="slide level2">
<h2>🐣 Case study I: converter</h2>
<p>To practice with functions we are going to create a complete <strong>temperature converter</strong> that, given a temperature in Fahrenheit, Celsius or Kelvin, converts it to any of the others.</p>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/flow-structures-functions/"><strong>workbook</strong></a></p>
</section>
<section id="joins" class="slide level2">
<h2>Joins</h2>
<p>When working with data we will not always have the information in a single table, and sometimes, we will be interested in <span class="hl-yellow"><strong>cross-referencing</strong></span> information from different sources.</p>
<div class="fragment">
<p>For this we will use a classic of every language that handles data: the famous <span class="hl-yellow"><strong>join</strong></span>, a tool that will allow us to <span class="hl-yellow"><strong>cross one or several tables</strong></span>, making use of a <span class="hl-yellow"><strong>identifying column</strong></span> of each one of them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb810"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb810-1"><a href="#cb810-1"></a>table_1 <span class="sc">|&gt;</span></span>
<span id="cb810-2"><a href="#cb810-2"></a>  <span class="fu">xxx_join</span>(table_2, <span class="at">by =</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="joins-1" class="slide level2">
<h2>Joins</h2>
<ul>
<li><p><code>inner_join()</code>: only <span class="hl-yellow"><strong>records with id in both</strong></span> tables survive.</p></li>
<li><p><code>full_join()</code>: keeps <span class="hl-yellow"><strong>all records in both</strong></span> tables.</p></li>
<li><p><code>left_join()</code>: keeps <span class="hl-yellow"><strong>all the records of the first table</strong></span>, and looks for which ones have id also in the second one (in case of <span class="hl-yellow"><strong>not having it, it fills with NA</strong></span> the fields of the 2nd table).</p></li>
<li><p><code>right_join()</code>: keeps <span class="hl-yellow"><strong>all records in the second table</strong></span>, and searches which ones have id also in the first one.</p></li>
</ul>

<img data-src="img/sql-joins.jpg" class="r-stretch"></section>
<section id="joins-2" class="slide level2">
<h2>Joins</h2>
<p>Let’s test the various joins with a simple example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb811"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb811-1"><a href="#cb811-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb811-2"><a href="#cb811-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb812"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb812-1"><a href="#cb812-1"></a>tb_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_x
  &lt;int&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   
3     3 x3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb814"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb814-1"><a href="#cb814-1"></a>tb_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_y
  &lt;dbl&gt; &lt;chr&gt;
1     1 y1   
2     2 y2   
3     4 y3   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="left_join" class="slide level2">
<h2>left_join()</h2>
<p>Imagine that we want to <span class="hl-yellow"><strong>incorporate</strong></span> to <code>tb_1</code> the <span class="hl-yellow"><strong>information from table_2</strong></span>, identifying the records by the key column (<code>by = "key"</code>, the column it has to cross): we want to keep all the records of the first table and look for which ones have the same value in <code>key</code> also in the second one.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb816"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb816-1"><a href="#cb816-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb816-2"><a href="#cb816-2"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/left_join.jpg"></p>
</div>
</div>
</div>
</section>
<section id="left_join-1" class="slide level2">
<h2>left_join()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb818"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb818-1"><a href="#cb818-1"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb818-2"><a href="#cb818-2"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
<p>Notice that the <span class="hl-yellow"><strong>records in the first one whose key was not found in the second one</strong></span> has given them the value of <span class="hl-yellow"><strong>absent</strong></span>.</p>
</section>
<section id="right_join" class="slide level2">
<h2>right_join()</h2>
<p>The <code>right_join()</code> will perform the opposite operation: we will now <span class="hl-yellow"><strong>incorporate</strong></span> to <code>tb_2</code> the <span class="hl-yellow"><strong>information from table_2</strong></span>, identifying the records by the <code>key</code> column: we want to keep all the records of the second one and look for which ones have id (same value in <code>key</code>) also in the first table.</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb820"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb820-1"><a href="#cb820-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb820-2"><a href="#cb820-2"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/right_join.jpg"></p>
</div>
</div>
</div>
</section>
<section id="right_join-1" class="slide level2">
<h2>right_join()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb822"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb822-1"><a href="#cb822-1"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb822-2"><a href="#cb822-2"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
<p>Notice that now the <span class="hl-yellow"><strong>records of the second one whose key was not found in the first one</strong></span> are the ones given the value of <span class="hl-yellow"><strong>absent</strong></span>.</p>
</section>
<section id="keys-and-suffixes" class="slide level2">
<h2>keys and suffixes</h2>
<p>The key columns we will use for the crossover <span class="hl-yellow"><strong>will not always be named the same</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb824"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb824-1"><a href="#cb824-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb824-2"><a href="#cb824-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<ul>
<li><code>by = c("key_2" = "key_2")</code>: we will indicate in which column of each table are the keys that we are going to cross.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb825"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb825-1"><a href="#cb825-1"></a><span class="co"># Left</span></span>
<span id="cb825-2"><a href="#cb825-2"></a>tb_1  <span class="sc">|&gt;</span> </span>
<span id="cb825-3"><a href="#cb825-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb827"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb827-1"><a href="#cb827-1"></a><span class="co"># Right</span></span>
<span id="cb827-2"><a href="#cb827-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb827-3"><a href="#cb827-3"></a>  <span class="fu">right_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="keys-and-suffixes-1" class="slide level2">
<h2>keys and suffixes</h2>
<p>We can also <span class="hl-yellow"><strong>cross over several columns at the same time</strong></span> (it will interpret as equal record the one that has the same set of keys), with <code>by = c("var1_t1" = "var1_t2", "var2_t1" = "var2_t2", ...)</code>. Let’s modify the previous example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb829"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb829-1"><a href="#cb829-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),  <span class="st">"val_x"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb829-2"><a href="#cb829-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"k_21"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"k_22"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"e"</span>), <span class="st">"val_y"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb830"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb830-1"><a href="#cb830-1"></a><span class="co"># Left</span></span>
<span id="cb830-2"><a href="#cb830-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb830-3"><a href="#cb830-3"></a>  <span class="fu">left_join</span>(tb_2,</span>
<span id="cb830-4"><a href="#cb830-4"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="st">"k_21"</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="st">"k_22"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
   k_11 k_12  val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1     1 a     x1    y1   
2     2 b     x2    y2   
3     3 c     x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb832"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb832-1"><a href="#cb832-1"></a><span class="co"># Right</span></span>
<span id="cb832-2"><a href="#cb832-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb832-3"><a href="#cb832-3"></a>  <span class="fu">right_join</span>(tb_2,</span>
<span id="cb832-4"><a href="#cb832-4"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"k_11"</span> <span class="ot">=</span> <span class="st">"k_21"</span>, <span class="st">"k_12"</span> <span class="ot">=</span> <span class="st">"k_22"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
   k_11 k_12  val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1     1 a     x1    y1   
2     2 b     x2    y2   
3     4 e     &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="keys-and-suffixes-2" class="slide level2">
<h2>keys and suffixes</h2>
<p>It could also happen that when crossing two tables, there are <span class="hl-yellow"><strong>columns of values named the same</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb834"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb834-1"><a href="#cb834-1"></a>tb_1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"val"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb834-2"><a href="#cb834-2"></a>tb_2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="st">"val"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb835"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb835-1"><a href="#cb835-1"></a><span class="co"># Left</span></span>
<span id="cb835-2"><a href="#cb835-2"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb835-3"><a href="#cb835-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
<p>Notice that <span class="hl-yellow"><strong>default adds the suffixes</strong></span> <code>.x</code> and <code>.y</code> to tell us which table they come from.</p>
</div>
</section>
<section id="keys-and-suffixes-3" class="slide level2">
<h2>keys and suffixes</h2>
<p>This <span class="hl-yellow"><strong>suffix can be specified</strong></span> in the optional argument <code>suffix = ...</code>, which allows us to <span class="hl-yellow"><strong>distinguish the variables</strong></span> of one table from another.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb837"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb837-1"><a href="#cb837-1"></a><span class="co"># Left</span></span>
<span id="cb837-2"><a href="#cb837-2"></a>tb_1 <span class="sc">|&gt;</span></span>
<span id="cb837-3"><a href="#cb837-3"></a>  <span class="fu">left_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>),</span>
<span id="cb837-4"><a href="#cb837-4"></a>            <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_table1"</span>, <span class="st">"_table2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  key_1 val_table1 val_table2
  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;     
1     1 x1         y1        
2     2 x2         y2        
3     3 x3         &lt;NA&gt;      </code></pre>
</div>
</div>
</section>
<section id="full_join" class="slide level2">
<h2>full_join()</h2>
<p>The two previous cases form what is known as <span class="hl-yellow"><strong>outer joins</strong></span>: crosses where observations are kept that appear in at least one table. The third outer join is known as <code>full_join()</code> which will <span class="hl-yellow"><strong>keep observations from both</strong></span> tables, <span class="hl-yellow"><strong>adding rows</strong></span> that do not match the other table.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb839"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb839-1"><a href="#cb839-1"></a>tb_1  <span class="sc">|&gt;</span> </span>
<span id="cb839-2"><a href="#cb839-2"></a>  <span class="fu">full_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; 
4     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/full_join.jpg"></p>
</div>
</div>
</section>
<section id="inner_join" class="slide level2">
<h2>inner_join()</h2>
<p>Opposite the outer join is what is known as <span class="hl-yellow"><strong>inner join</strong></span>, with <code>inner_join()</code>: a join in which only the <span class="hl-yellow"><strong>observations that appear in both tables</strong></span> are kept, only those records that are patched are kept.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb841"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb841-1"><a href="#cb841-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb841-2"><a href="#cb841-2"></a>  <span class="fu">inner_join</span>(tb_2,  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/inner_join.png"></p>
</div>
</div>
</section>
<section id="inner_join-1" class="slide level2">
<h2>inner_join()</h2>
<p>Note that in terms of records, <code>inner_join</code> if it is commutative, <strong>we don’t care about the order of the tables</strong>: the only thing that changes is the order of the columns it adds.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb843"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb843-1"><a href="#cb843-1"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb843-2"><a href="#cb843-2"></a>  <span class="fu">inner_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_1 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb845"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb845-1"><a href="#cb845-1"></a>tb_2 <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(tb_1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_2"</span> <span class="ot">=</span> <span class="st">"key_1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key_2 val.x val.y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 y1    x1   
2     2 y2    x2   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="semianti_join" class="slide level2">
<h2>semi/anti_join()</h2>
<p>Finally we have two interesting tools to <span class="hl-yellow"><strong>filter (not cross) records</strong></span>: <code>semi_join()</code> and <code>anti_join()</code>. The <span class="hl-yellow"><strong>semi join</strong></span> leaves us in the <span class="hl-yellow"><strong>first table the records whose key is also in the second table</strong></span> (like an inner join but without adding the info from the second table). And the second one, the anti join, does just the opposite (those that are not).</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb847"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb847-1"><a href="#cb847-1"></a><span class="co"># semijoin</span></span>
<span id="cb847-2"><a href="#cb847-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb847-3"><a href="#cb847-3"></a>  <span class="fu">semi_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  key_1 val  
  &lt;int&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb849"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb849-1"><a href="#cb849-1"></a><span class="co"># antijoin</span></span>
<span id="cb849-2"><a href="#cb849-2"></a>tb_1 <span class="sc">|&gt;</span> </span>
<span id="cb849-3"><a href="#cb849-3"></a>  <span class="fu">anti_join</span>(tb_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"key_1"</span> <span class="ot">=</span> <span class="st">"key_2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  key_1 val  
  &lt;int&gt; &lt;chr&gt;
1     3 x3   </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-6-2" class="slide level2">
<h2>💻 It’s your turn</h2>
<p>For the exercises we will use the tables available in the package <code>{nycflights13}</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb851"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb851-1"><a href="#cb851-1"></a><span class="fu">library</span>(nycflights13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><strong>airlines</strong>: name of airlines (with their abbreviation).</li>
<li><strong>airports</strong>: airport data (names, longitude, latitude, altitude, etc).</li>
<li><strong>flights</strong>, <strong>planes</strong>: flight and aircraft data.</li>
<li><strong>weather</strong>: hourly weather data.</li>
</ul>
</section>
<section id="its-your-turn" class="slide level2">
<h2>💻 It’s your turn</h2>
<div class="panel-tabset">
<ul id="tabset-16" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-16-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-16-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-16-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-16-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-16-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-16-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-16-1">
<p>📝 From package <code>{nycflights13}</code> incorporates into the <code>flights</code> table the airline data in <code>airlines</code>. We want to maintain all flight records, adding the airline information to the airlines table.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb852"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb852-1"><a href="#cb852-1"></a>flights_airlines <span class="ot">&lt;-</span></span>
<span id="cb852-2"><a href="#cb852-2"></a>  flights <span class="sc">|&gt;</span> </span>
<span id="cb852-3"><a href="#cb852-3"></a>  <span class="fu">left_join</span>(airlines, <span class="at">by =</span> <span class="st">"carrier"</span>)</span>
<span id="cb852-4"><a href="#cb852-4"></a>flights_airlines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-2">
<p>📝 To the table obtained from the crossing of the previous section, include the data of the aircraft in <code>planes</code>, but including only those flights for which we have information on their aircraft (and vice versa).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb853"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb853-1"><a href="#cb853-1"></a>flights_airlines_planes <span class="ot">&lt;-</span> </span>
<span id="cb853-2"><a href="#cb853-2"></a>  flights_airlines <span class="sc">|&gt;</span> </span>
<span id="cb853-3"><a href="#cb853-3"></a>  <span class="fu">inner_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>)</span>
<span id="cb853-4"><a href="#cb853-4"></a>flights_airlines_planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-3">
<p>📝 Repeat the previous exercise but keeping both <code>year</code> variables (in one is the year of flight, in the other is the year of construction of the aircraft), and distinguishing them from each other</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb854"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb854-1"><a href="#cb854-1"></a>flights_airlines_planes <span class="ot">&lt;-</span> </span>
<span id="cb854-2"><a href="#cb854-2"></a>  flights_airlines <span class="sc">|&gt;</span></span>
<span id="cb854-3"><a href="#cb854-3"></a>  <span class="fu">inner_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>,</span>
<span id="cb854-4"><a href="#cb854-4"></a>             <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_flight"</span>, <span class="st">"_build_aircraft"</span>))</span>
<span id="cb854-5"><a href="#cb854-5"></a>flights_airlines_planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-4">
<p>📝 To the table obtained from the previous exercise includes the longitude and latitude of the airports in <code>airports</code>, distinguishing between the latitude/longitude of the airport at destination and at origin.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb855"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb855-1"><a href="#cb855-1"></a>flights_airlines_planes <span class="sc">|&gt;</span> </span>
<span id="cb855-2"><a href="#cb855-2"></a>  <span class="fu">left_join</span>(airports <span class="sc">|&gt;</span> <span class="fu">select</span>(faa, lat, lon),</span>
<span id="cb855-3"><a href="#cb855-3"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"origin"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb855-4"><a href="#cb855-4"></a>  <span class="fu">rename</span>(<span class="at">lat_origin =</span> lat, <span class="at">lon_origin =</span> lon) <span class="sc">|&gt;</span> </span>
<span id="cb855-5"><a href="#cb855-5"></a>  <span class="fu">left_join</span>(airports <span class="sc">|&gt;</span> <span class="fu">select</span>(faa, lat, lon),</span>
<span id="cb855-6"><a href="#cb855-6"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span> <span class="ot">=</span> <span class="st">"faa"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb855-7"><a href="#cb855-7"></a>  <span class="fu">rename</span>(<span class="at">lat_dest =</span> lat, <span class="at">lon_dest =</span> lon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-5">
<p>📝 Filter from <code>airports</code> only those airports from which flights depart. Repeat the process filtering only those airports where flights arrive.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb856"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb856-1"><a href="#cb856-1"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb856-2"><a href="#cb856-2"></a>  <span class="fu">semi_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"origin"</span>))</span>
<span id="cb856-3"><a href="#cb856-3"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb856-4"><a href="#cb856-4"></a>  <span class="fu">semi_join</span>(flights, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"faa"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-16-6">
<p>📝 How many flights do we not have information about the aircraft? Eliminate flights that do not have an aircraft ID (other than NA) beforehand.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb857"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb857-1"><a href="#cb857-1"></a>flights <span class="sc">|&gt;</span></span>
<span id="cb857-2"><a href="#cb857-2"></a>  <span class="fu">drop_na</span>(tailnum) <span class="sc">|&gt;</span></span>
<span id="cb857-3"><a href="#cb857-3"></a>  <span class="fu">anti_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>) <span class="sc">|&gt;</span></span>
<span id="cb857-4"><a href="#cb857-4"></a>  <span class="fu">count</span>(tailnum, <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-6-2" class="slide level2">
<h2>🐣 Case study II: Beatles</h2>
<p>We will use to practice simple joins the <code>band_members</code> and <code>band_instruments</code> datasets already included in the <code>{dplyr}</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb858"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb858-1"><a href="#cb858-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb858-2"><a href="#cb858-2"></a>band_members</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  band   
  &lt;chr&gt; &lt;chr&gt;  
1 Mick  Stones 
2 John  Beatles
3 Paul  Beatles</code></pre>
</div>
<div class="sourceCode cell-code" id="cb860"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb860-1"><a href="#cb860-1"></a>band_instruments</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  name  plays 
  &lt;chr&gt; &lt;chr&gt; 
1 John  guitar
2 Paul  bass  
3 Keith guitar</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/joins-import-mucss/#case-study-i-beatles-and-rolling-stones"><strong>workbook</strong></a></p>
</section>
<section id="caso-practico-6-3" class="slide level2">
<h2>🐣 Case study III: income by municipalities</h2>
<p>In the file <code>municipios.csv</code> we have stored the information of the municipalities of Spain as of 2019.</p>
<ul>
<li><p>The variable <code>LAU_code</code> represents the code as local administrative unit in the EU (see more at <a href="https://ec.europa.eu/eurostat/web/nuts/local-administrative-units" class="uri">https://ec.europa.eu/eurostat/web/nuts/local-administrative-units</a>).</p></li>
<li><p>The variable <code>codigo_ine</code> is formed by joining the province code and the community code (each province has a code from 1 to 52, it does not depend on the ccaa).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb862"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb862-1"><a href="#cb862-1"></a><span class="co"># 2019 data</span></span>
<span id="cb862-2"><a href="#cb862-2"></a>mun_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/municipios.csv"</span>)</span>
<span id="cb862-3"><a href="#cb862-3"></a>mun_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8,212 × 8
   codauto ine.ccaa.name cpro  ine.prov.name cmun  name      LAU_CODE codigo_ine
   &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;     
 1 01      Andalucía     04    Almería       001   Abla      04001    04001     
 2 01      Andalucía     04    Almería       002   Abrucena  04002    04002     
 3 01      Andalucía     04    Almería       003   Adra      04003    04003     
 4 01      Andalucía     04    Almería       004   Albanchez 04004    04004     
 5 01      Andalucía     04    Almería       005   Alboloduy 04005    04005     
 6 01      Andalucía     04    Almería       006   Albox     04006    04006     
 7 01      Andalucía     04    Almería       007   Alcolea   04007    04007     
 8 01      Andalucía     04    Almería       008   Alcóntar  04008    04008     
 9 01      Andalucía     04    Almería       009   Alcudia … 04009    04009     
10 01      Andalucía     04    Almería       010   Alhabia   04010    04010     
# ℹ 8,202 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-iii-income-by-municipalities" class="slide level2">
<h2>🐣 Case study III: income by municipalities</h2>
<p>On the other hand, in the file <code>renta_mun</code> we have the average per capita income of each administrative unit (municipalities, districts, provinces, autonomous communities,…) for different years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb864"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb864-1"><a href="#cb864-1"></a>renta_mun <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/renta_mun.csv"</span>)</span>
<span id="cb864-2"><a href="#cb864-2"></a>renta_mun</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55,273 × 7
   Unidad                          `2019` `2018` `2017` `2016` `2015` codigo_ine
   &lt;chr&gt;                            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     
 1 44001 Ababuj                        NA     NA     NA     NA     NA 44001     
 2 4400101 Ababuj distrito 01          NA     NA     NA     NA     NA 4400101   
 3 4400101001 Ababuj sección 01001     NA     NA     NA     NA     NA 4400101001
 4 40001 Abades                     11429  10731  10314   9816   9904 40001     
 5 4000101 Abades distrito 01       11429  10731  10314   9816   9904 4000101   
 6 4000101001 Abades sección 01001  11429  10731  10314   9816   9904 4000101001
 7 10001 Abadía                      8954   8589   8207   7671   8416 10001     
 8 1000101 Abadía distrito 01        8954   8589   8207   7671   8416 1000101   
 9 1000101001 Abadía sección 01001   8954   8589   8207   7671   8416 1000101001
10 27001 Abadín                     10791  10258   9762   9478   9116 27001     
# ℹ 55,263 more rows</code></pre>
</div>
</div>
</section>
<section id="case-study-iii-income-by-municipalities-1" class="slide level2">
<h2>🐣 Case study III: income by municipalities</h2>
<p>Before we start let’s <span class="hl-yellow"><strong>normalize variable names</strong></span> using <code>clean_names()</code> from the <code>{janitor}</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb866"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb866-1"><a href="#cb866-1"></a>mun_data <span class="ot">&lt;-</span></span>
<span id="cb866-2"><a href="#cb866-2"></a>  mun_data <span class="sc">|&gt;</span> </span>
<span id="cb866-3"><a href="#cb866-3"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb866-4"><a href="#cb866-4"></a>renta_mun <span class="ot">&lt;-</span></span>
<span id="cb866-5"><a href="#cb866-5"></a>  renta_mun <span class="sc">|&gt;</span> </span>
<span id="cb866-6"><a href="#cb866-6"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="https://javieralvarezliebana.quarto.pub/joins-import-mucss/#case-study-ii-income-by-municipalities"><strong>workbook</strong></a></p>
</section></section>
<section>
<section id="clase-7" class="title-slide slide level1 center">
<h1>L7: <span class="flow">import/exports</span></h1>
<p><span style="color:#444442;"><strong>Import and export data</strong></span></p>
<ul>
<li><p><a href="https://drive.google.com/drive/folders/18Ok6Epqcimszqguj_JTTLuSbs5Ot5Srd?usp=sharing">📊 Data</a></p></li>
<li><p><a href="#/tu-turno-7-1">💻 Solved exercises</a></p></li>
<li><p><a href="#/caso-practico-7-1">🐣 Workbook/case study I</a></p></li>
<li><p><a href="#/planificacion-curso">📆 Planning</a></p></li>
</ul>
</section>
<section id="importexport" class="slide level2">
<h2>Import/export</h2>
<p>So far we have only used data already loaded in packages but many times <span class="hl-yellow"><strong>we will need to import data externally</strong></span>. One of the main <span class="hl-yellow"><strong>strengths</strong></span> of <code>R</code> is that we can import data very easily in different formats:</p>
<ul>
<li><p><span class="hl-yellow"><strong>R native formats</strong></span>: <code>.rda</code>, <code>.RData</code> and <code>.rds</code> formats.</p></li>
<li><p><span class="hl-yellow"><strong>Rectangular (tabular) data</strong></span>: <code>.csv</code> and <code>.tsv</code> formats</p></li>
<li><p><span class="hl-yellow"><strong>Untabulated data</strong></span>: <code>.txt</code> format.</p></li>
<li><p><span class="hl-yellow"><strong>Data in excel</strong></span>: <code>.xls</code> and <code>.xlsx</code> formats</p></li>
<li><p><span class="hl-yellow"><strong>Data from SAS/Stata/SPSS</strong></span>: <code>.sas7bdat</code>, <code>.sav</code> and <code>.dat</code> formats</p></li>
<li><p><span class="hl-yellow"><strong>Data from Google Drive</strong></span></p></li>
<li><p><span class="hl-yellow"><strong>Data from API’s</strong></span>: aemet, catastro, twitter, spotify, etc.</p></li>
</ul>
</section>
<section id="r-native-formats" class="slide level2">
<h2>R native formats</h2>
<p>The <span class="hl-yellow"><strong>simplest</strong></span> files to import into <code>R</code> (and which usually take up less disk space) are its own <span class="hl-yellow"><strong>native extensions</strong></span>: files in <code>.RData</code>, <code>.rda</code> and <code>.rds</code> formats. To load the former we simply need to <span class="hl-yellow"><strong>use the native</strong></span> function <code>load()</code> by providing it the file path.</p>
<ul>
<li><code>RData</code> file: we are going to import the file <code>world_bank_pop.RData</code>, which includes the dataset <code>world_bank_pop</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb867"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb867-1"><a href="#cb867-1"></a><span class="fu">load</span>(<span class="st">"./data/world_bank_pop.RData"</span>)</span>
<span id="cb867-2"><a href="#cb867-2"></a>world_bank_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,064 × 20
   country indicator      `2000`  `2001`  `2002`  `2003`  `2004`  `2005`  `2006`
   &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 ABW     SP.URB.TOTL    4.16e4 4.20e+4 4.22e+4 4.23e+4 4.23e+4 4.24e+4 4.26e+4
 2 ABW     SP.URB.GROW    1.66e0 9.56e-1 4.01e-1 1.97e-1 9.46e-2 1.94e-1 3.67e-1
 3 ABW     SP.POP.TOTL    8.91e4 9.07e+4 9.18e+4 9.27e+4 9.35e+4 9.45e+4 9.56e+4
 4 ABW     SP.POP.GROW    2.54e0 1.77e+0 1.19e+0 9.97e-1 9.01e-1 1.00e+0 1.18e+0
 5 AFE     SP.URB.TOTL    1.16e8 1.20e+8 1.24e+8 1.29e+8 1.34e+8 1.39e+8 1.44e+8
 6 AFE     SP.URB.GROW    3.60e0 3.66e+0 3.72e+0 3.71e+0 3.74e+0 3.81e+0 3.81e+0
 7 AFE     SP.POP.TOTL    4.02e8 4.12e+8 4.23e+8 4.34e+8 4.45e+8 4.57e+8 4.70e+8
 8 AFE     SP.POP.GROW    2.58e0 2.59e+0 2.61e+0 2.62e+0 2.64e+0 2.67e+0 2.70e+0
 9 AFG     SP.URB.TOTL    4.31e6 4.36e+6 4.67e+6 5.06e+6 5.30e+6 5.54e+6 5.83e+6
10 AFG     SP.URB.GROW    1.86e0 1.15e+0 6.86e+0 7.95e+0 4.59e+0 4.47e+0 5.03e+0
# ℹ 1,054 more rows
# ℹ 11 more variables: `2007` &lt;dbl&gt;, `2008` &lt;dbl&gt;, `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;,
#   `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;,
#   `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="r-native-formats-1" class="slide level2">
<h2>R native formats</h2>
<ul>
<li><code>.rda</code> file: we will import the airquality dataset from <code>airquality.rda</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb869"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb869-1"><a href="#cb869-1"></a><span class="fu">load</span>(<span class="st">"./data/airquality.rda"</span>)</span>
<span id="cb869-2"><a href="#cb869-2"></a>airquality <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 153 × 6
   Ozone Solar.R  Wind  Temp Month   Day
   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1    41     190   7.4    67     5     1
 2    36     118   8      72     5     2
 3    12     149  12.6    74     5     3
 4    18     313  11.5    62     5     4
 5    NA      NA  14.3    56     5     5
 6    28      NA  14.9    66     5     6
 7    23     299   8.6    65     5     7
 8    19      99  13.8    59     5     8
 9     8      19  20.1    61     5     9
10    NA     194   8.6    69     5    10
# ℹ 143 more rows</code></pre>
</div>
</div>
</section>
<section id="r-native-formats-2" class="slide level2">
<h2>R native formats</h2>
<p>Note that files loaded with <code>load()</code> are <span class="hl-yellow"><strong>automatically loaded into the environment</strong></span> (with the originally saved name), and not only datasets can be loaded: <code>load()</code> allows us to load multiple objetcs (not only a tabular data)</p>
<p>Native <code>.rda</code> and <code>.RData</code> files are a properly way to save your environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb871"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb871-1"><a href="#cb871-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"./data/multiple_objects.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-native-formats-3" class="slide level2">
<h2>R native formats</h2>
<ul>
<li><code>.rds</code> files: for this type we must use <code>readRDS()</code>, and we need to incorporate a <span class="hl-yellow"><strong>argument <code>file</code></strong></span> with the path. In this case we are going to import <span class="hl-purple"><strong>lung cancer data</strong></span> from the North Central Cancer Treatment Group. Note that now <span class="hl-yellow"><strong>.rds import files are a unique database</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb872"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb872-1"><a href="#cb872-1"></a>lung_cancer <span class="ot">&lt;-</span></span>
<span id="cb872-2"><a href="#cb872-2"></a>  <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"./data/NCCTG_lung_cancer.rds"</span>) <span class="sc">|&gt;</span></span>
<span id="cb872-3"><a href="#cb872-3"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb872-4"><a href="#cb872-4"></a>lung_cancer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 228 × 10
    inst  time status   age   sex ph.ecog ph.karno pat.karno meal.cal wt.loss
   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1     3   306      2    74     1       1       90       100     1175      NA
 2     3   455      2    68     1       0       90        90     1225      15
 3     3  1010      1    56     1       0       90        90       NA      15
 4     5   210      2    57     1       1       90        60     1150      11
 5     1   883      2    60     1       0      100        90       NA       0
 6    12  1022      1    74     1       1       50        80      513       0
 7     7   310      2    68     2       2       70        60      384      10
 8    11   361      2    71     2       2       60        80      538       1
 9     1   218      2    53     1       1       70        80      825      16
10     7   166      2    61     1       2       70        70      271      34
# ℹ 218 more rows</code></pre>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>The <span class="hl-yellow"><strong>paths</strong></span> must always be <span class="hl-yellow"><strong>without spaces, ñ, or accents</strong></span>.</p>
</div>
</div>
</div>
</section>
<section id="tabular-data-readr" class="slide level2">
<h2>Tabular data: readr</h2>
<p>The <code>{readr}</code> package within the <code>{tidyverse}</code> environment contains several useful functions for <span class="hl-yellow"><strong>loading rectangular data (without formatting)</strong></span>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><code>read_csv()</code>: <code>.csv</code> files whose <span class="hl-purple"><strong>separator is comma</strong></span></li>
<li><code>read_csv2()</code>: <span class="hl-purple"><strong>semicolon</strong></span></li>
<li><code>read_tsv()</code>: <span class="hl-purple"><strong>tabulator</strong></span>.</li>
<li><code>read_table()</code>: <span class="hl-purple"><strong>space</strong></span>.</li>
<li><code>read_delim()</code>: generic function for <span class="hl-purple"><strong>character delimited files</strong></span>.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/data-import-readr.png"></p>
</div>
</div>
<p>All of them need as <strong>argument the file path</strong> plus <strong>other optional</strong> (skip header or not, decimals, etc). See more at <a href="https://readr.tidyverse.org/" class="uri">https://readr.tidyverse.org/</a></p>
</section>
<section id="tabular-data-.csv-.tsv" class="slide level2">
<h2>Tabular data (.csv, .tsv)</h2>
<p>The main advantage of <code>{readr}</code> is that it <span class="hl-yellow"><strong>automates formatting</strong></span> to go from a flat (unformatted) file to a tibble (in rows and columns, with formatting).</p>
<div class="fragment">
<ul>
<li>File <code>.csv</code>: with <code>read_csv()</code> we will load <span class="hl-purple"><strong>comma separated</strong></span> files, passing as <span class="hl-yellow"><strong>argument the path</strong></span> in <code>file = ...</code>. Let’s import the <code>chickens.csv</code> dataset (about cartoon chickens, why not). If you look at the output it gives us the type of variables.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb874"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb874-1"><a href="#cb874-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb874-2"><a href="#cb874-2"></a>chickens <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/chickens.csv"</span>)</span>
<span id="cb874-3"><a href="#cb874-3"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  chicken                 sex     eggs_laid motto                               
  &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                               
1 Foghorn Leghorn         rooster         0 That's a joke, ah say, that's a jok…
2 Chicken Little          hen             3 The sky is falling!                 
3 Ginger                  hen            12 Listen. We'll either die free chick…
4 Camilla the Chicken     hen             7 Bawk, buck, ba-gawk.                
5 Ernie The Giant Chicken rooster         0 Put Captain Solo in the cargo hold. </code></pre>
</div>
</div>
</div>
</section>
<section id="tabular-data-.csv-.tsv-1" class="slide level2">
<h2>Tabular data (.csv, .tsv)</h2>
<p>The <span class="hl-yellow"><strong>variable format</strong></span> will normally be done <span class="hl-yellow"><strong>automatically</strong></span> by <code>read_csv()</code>, and we can query it with <code>spec()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb876"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb876-1"><a href="#cb876-1"></a><span class="fu">spec</span>(chickens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  chicken = col_character(),
  sex = col_character(),
  eggs_laid = col_double(),
  motto = col_character()
)</code></pre>
</div>
</div>
</section>
<section id="tabular-data-.csv-.tsv-2" class="slide level2">
<h2>Tabular data (.csv, .tsv)</h2>
<p>Although it usually does it well automatically we can <span class="hl-yellow"><strong>specify the format explicitly</strong></span> in <code>col_types = list()</code> (in list format, with <code>col_xxx()</code> for each type of variable, for example <code>eggs_laid</code> will be imported as character).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb878"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb878-1"><a href="#cb878-1"></a>chickens <span class="ot">&lt;-</span></span>
<span id="cb878-2"><a href="#cb878-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/chickens.csv"</span>,</span>
<span id="cb878-3"><a href="#cb878-3"></a>           <span class="at">col_types =</span> <span class="fu">list</span>(<span class="fu">col_character</span>(), <span class="fu">col_character</span>(),</span>
<span id="cb878-4"><a href="#cb878-4"></a>                            <span class="fu">col_character</span>(), <span class="fu">col_character</span>()))</span>
<span id="cb878-5"><a href="#cb878-5"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  chicken                 sex     eggs_laid motto                               
  &lt;chr&gt;                   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;                               
1 Foghorn Leghorn         rooster 0         That's a joke, ah say, that's a jok…
2 Chicken Little          hen     3         The sky is falling!                 
3 Ginger                  hen     12        Listen. We'll either die free chick…
4 Camilla the Chicken     hen     7         Bawk, buck, ba-gawk.                
5 Ernie The Giant Chicken rooster 0         Put Captain Solo in the cargo hold. </code></pre>
</div>
</div>
</section>
<section id="tabular-data-.csv-.tsv-3" class="slide level2">
<h2>Tabular data (.csv, .tsv)</h2>
<p>We can even indicate that <span class="hl-yellow"><strong>variables we want to select</strong></span> (without occupying memory), by indicating it in <code>col_select = ...</code> (in list format, with <code>col_select = ...</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb880"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb880-1"><a href="#cb880-1"></a>chickens <span class="ot">&lt;-</span></span>
<span id="cb880-2"><a href="#cb880-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/chickens.csv"</span>,</span>
<span id="cb880-3"><a href="#cb880-3"></a>           <span class="at">col_select =</span> <span class="fu">c</span>(chicken, sex, eggs_laid))</span>
<span id="cb880-4"><a href="#cb880-4"></a>chickens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  chicken                 sex     eggs_laid
  &lt;chr&gt;                   &lt;chr&gt;       &lt;dbl&gt;
1 Foghorn Leghorn         rooster         0
2 Chicken Little          hen             3
3 Ginger                  hen            12
4 Camilla the Chicken     hen             7
5 Ernie The Giant Chicken rooster         0</code></pre>
</div>
</div>
</section>
<section id="untabulated-data-.txt" class="slide level2">
<h2>Untabulated data (.txt)</h2>
<p>What happens when the <span class="hl-red"><strong>separator is not correct</strong></span>?</p>
<div class="fragment">
<p>If we use <code>read_csv()</code> it expects the separator between columns to be a comma but, as you can see with the following <code>.txt</code>, it interprets everything as a single column: <span class="hl-yellow"><strong>has no comma and does not know where to separate</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb882"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb882-1"><a href="#cb882-1"></a>datos_txt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/massey-rating.txt"</span>)</span>
<span id="cb882-2"><a href="#cb882-2"></a><span class="fu">dim</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb884"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb884-1"><a href="#cb884-1"></a><span class="fu">as_tibble</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
   `UCC PAY LAZ KPK  RT   COF BIH DII ENG ACU Rank Team            Conf`
   &lt;chr&gt;                                                                
 1 1   1   1   1   1     1   1   1   1   1    1 Ohio St          B10    
 2 2   2   2   2   2     2   2   2   4   2    2 Oregon           P12    
 3 3   4   3   4   3     4   3   4   2   3    3 Alabama          SEC    
 4 4   3   4   3   4     3   5   3   3   4    4 TCU              B12    
 5 6   6   6   5   5     7   6   5   6  11    5 Michigan St      B10    
 6 7   7   7   6   7     6  11   8   7   8    6 Georgia          SEC    
 7 5   5   5   7   6     8   4   6   5   5    7 Florida St       ACC    
 8 8   8   9   9  10     5   7   7  10   7    8 Baylor           B12    
 9 9  11   8  13  11    11  12   9  14   9    9 Georgia Tech     ACC    
10 13  10  13  11   8     9  10  11   9  10   10 Mississippi      SEC   </code></pre>
</div>
</div>
</div>
</section>
<section id="untabulated-data-.txt-1" class="slide level2">
<h2>Untabulated data (.txt)</h2>
<p>To do this we have.</p>
<ul>
<li><p><code>read_csv2()</code> when the <span class="hl-yellow"><strong>separator is semicolon</strong></span>, <code>read_tsv()</code> when the <span class="hl-yellow"><strong>is a tab</strong></span> and <code>read_table()</code> when the <span class="hl-yellow"><strong>is a space</strong></span>.</p></li>
<li><p><code>read_delim()</code> in general.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb886"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb886-1"><a href="#cb886-1"></a>datos_txt <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="at">file =</span> <span class="st">"./data/massey-rating.txt"</span>)</span>
<span id="cb886-2"><a href="#cb886-2"></a><span class="fu">as_tibble</span>(datos_txt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 13
     UCC   PAY   LAZ   KPK    RT   COF   BIH   DII   ENG   ACU  Rank Team  Conf 
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
 1     1     1     1     1     1     1     1     1     1     1     1 Ohio  St   
 2     2     2     2     2     2     2     2     2     4     2     2 Oreg… P12  
 3     3     4     3     4     3     4     3     4     2     3     3 Alab… SEC  
 4     4     3     4     3     4     3     5     3     3     4     4 TCU   B12  
 5     6     6     6     5     5     7     6     5     6    11     5 Mich… St   
 6     7     7     7     6     7     6    11     8     7     8     6 Geor… SEC  
 7     5     5     5     7     6     8     4     6     5     5     7 Flor… St   
 8     8     8     9     9    10     5     7     7    10     7     8 Bayl… B12  
 9     9    11     8    13    11    11    12     9    14     9     9 Geor… Tech 
10    13    10    13    11     8     9    10    11     9    10    10 Miss… SEC  </code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>Another key import package will be the <code>{readxl}</code> package for <span class="hl-yellow"><strong>importing data from Excel</strong></span>. Three functions will be key:</p>
<ul>
<li><code>read_xls()</code> specific to <code>.xls</code>, <code>read_xlsx()</code> specific to <code>.xlsx</code>.</li>
<li><code>read_excel()</code>: for both <code>.xls</code> and <code>.xlsx</code>.</li>
</ul>
<div class="fragment">
<p>We are going to import <code>deaths.xlsx</code> with celebrity death records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb888"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb888-1"><a href="#cb888-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb888-2"><a href="#cb888-2"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/deaths.xlsx"</span>)</span>
<span id="cb888-3"><a href="#cb888-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 6
   `Lots of people`             ...2                     ...3  ...4  ...5  ...6 
   &lt;chr&gt;                        &lt;chr&gt;                    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 simply cannot resist writing &lt;NA&gt;                     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  some…
 2 at                           the                      top   &lt;NA&gt;  of    thei…
 3 or                           merging                  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  cells
 4 Name                         Profession               Age   Has … Date… Date…
 5 David Bowie                  musician                 69    TRUE  17175 42379
 6 Carrie Fisher                actor                    60    TRUE  20749 42731
 7 Chuck Berry                  musician                 90    TRUE  9788  42812
 8 Bill Paxton                  actor                    61    TRUE  20226 42791
 9 Prince                       musician                 57    TRUE  21343 42481
10 Alan Rickman                 actor                    69    FALSE 16854 42383
11 Florence Henderson           actor                    82    TRUE  12464 42698
12 Harper Lee                   author                   89    FALSE 9615  42419
13 Zsa Zsa Gábor                actor                    99    TRUE  6247  42722
14 George Michael               musician                 53    FALSE 23187 42729
15 Some                         &lt;NA&gt;                     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
16 &lt;NA&gt;                         also like to write stuff &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
17 &lt;NA&gt;                         &lt;NA&gt;                     at t… bott… &lt;NA&gt;  &lt;NA&gt; 
18 &lt;NA&gt;                         &lt;NA&gt;                     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  too! </code></pre>
</div>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-1" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb890"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb890-1"><a href="#cb890-1"></a>deaths <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  `Lots of people`             ...2       ...3  ...4     ...5          ...6     
  &lt;chr&gt;                        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;         &lt;chr&gt;    
1 simply cannot resist writing &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          some not…
2 at                           the        top   &lt;NA&gt;     of            their sp…
3 or                           merging    &lt;NA&gt;  &lt;NA&gt;     &lt;NA&gt;          cells    
4 Name                         Profession Age   Has kids Date of birth Date of …
5 David Bowie                  musician   69    TRUE     17175         42379    
6 Carrie Fisher                actor      60    TRUE     20749         42731    </code></pre>
</div>
</div>
<p>One thing that is <span class="hl-yellow"><strong>very common misfortune</strong></span> is that there is some kind of comment or text at the beginning of the file, having to <span class="hl-yellow"><strong>skip those rows</strong></span>.</p>
</section>
<section id="excel-data-.xls-.xlsx-2" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>We can <span class="hl-yellow"><strong>skip these rows</strong></span> directly in the load with <code>skip = ...</code> (indicating the number of rows to skip).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb892"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb892-1"><a href="#cb892-1"></a>deaths <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/deaths.xlsx"</span>, <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb892-2"><a href="#cb892-2"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   Name          Profession Age   `Has kids` `Date of birth`     `Date of death`
   &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;      &lt;dttm&gt;              &lt;chr&gt;          
 1 David Bowie   musician   69    TRUE       1947-01-08 00:00:00 42379          
 2 Carrie Fisher actor      60    TRUE       1956-10-21 00:00:00 42731          
 3 Chuck Berry   musician   90    TRUE       1926-10-18 00:00:00 42812          
 4 Bill Paxton   actor      61    TRUE       1955-05-17 00:00:00 42791          
 5 Prince        musician   57    TRUE       1958-06-07 00:00:00 42481          
 6 Alan Rickman  actor      69    FALSE      1946-02-21 00:00:00 42383          
 7 Florence Hen… actor      82    TRUE       1934-02-14 00:00:00 42698          
 8 Harper Lee    author     89    FALSE      1926-04-28 00:00:00 42419          
 9 Zsa Zsa Gábor actor      99    TRUE       1917-02-06 00:00:00 42722          
10 George Micha… musician   53    FALSE      1963-06-25 00:00:00 42729          
11 Some          &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;       NA                  &lt;NA&gt;           
12 &lt;NA&gt;          also like… &lt;NA&gt;  &lt;NA&gt;       NA                  &lt;NA&gt;           
13 &lt;NA&gt;          &lt;NA&gt;       at t… bottom,    NA                  &lt;NA&gt;           
14 &lt;NA&gt;          &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;       NA                  too!           </code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-3" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>In addition with <code>col_names = ...</code> we can already rename the columns in the import (if <span class="hl-yellow"><strong>provide names assumes 1st line already as a data</strong></span>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb894" data-code-line-numbers="2-3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb894-1"><a href="#cb894-1"></a>deaths <span class="ot">&lt;-</span></span>
<span id="cb894-2"><a href="#cb894-2"></a>  <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/deaths.xlsx"</span>, <span class="at">skip =</span> <span class="dv">5</span>,</span>
<span id="cb894-3"><a href="#cb894-3"></a>            <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"profession"</span>, <span class="st">"age"</span>, <span class="st">"kids"</span>, <span class="st">"birth"</span>, <span class="st">"death"</span>))</span>
<span id="cb894-4"><a href="#cb894-4"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   name               profession           age   kids  birth               death
   &lt;chr&gt;              &lt;chr&gt;                &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;
 1 David Bowie        musician             69    TRUE  1947-01-08 00:00:00 42379
 2 Carrie Fisher      actor                60    TRUE  1956-10-21 00:00:00 42731
 3 Chuck Berry        musician             90    TRUE  1926-10-18 00:00:00 42812
 4 Bill Paxton        actor                61    TRUE  1955-05-17 00:00:00 42791
 5 Prince             musician             57    TRUE  1958-06-07 00:00:00 42481
 6 Alan Rickman       actor                69    FALSE 1946-02-21 00:00:00 42383
 7 Florence Henderson actor                82    TRUE  1934-02-14 00:00:00 42698
 8 Harper Lee         author               89    FALSE 1926-04-28 00:00:00 42419
 9 Zsa Zsa Gábor      actor                99    TRUE  1917-02-06 00:00:00 42722
10 George Michael     musician             53    FALSE 1963-06-25 00:00:00 42729
11 Some               &lt;NA&gt;                 &lt;NA&gt;  &lt;NA&gt;  NA                  &lt;NA&gt; 
12 &lt;NA&gt;               also like to write … &lt;NA&gt;  &lt;NA&gt;  NA                  &lt;NA&gt; 
13 &lt;NA&gt;               &lt;NA&gt;                 at t… bott… NA                  &lt;NA&gt; 
14 &lt;NA&gt;               &lt;NA&gt;                 &lt;NA&gt;  &lt;NA&gt;  NA                  too! </code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-4" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>Sometimes <span class="hl-red"><strong>Excel dates are incorrectly formatted</strong></span> (surprise): we can use <code>convertToDate()</code> from the <code>{openxlsx}</code> package to convert it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb896"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb896-1"><a href="#cb896-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb896-2"><a href="#cb896-2"></a>deaths<span class="sc">$</span>death <span class="ot">&lt;-</span> <span class="fu">convertToDate</span>(deaths<span class="sc">$</span>death)</span>
<span id="cb896-3"><a href="#cb896-3"></a>deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   name               profession      age   kids  birth               death     
   &lt;chr&gt;              &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;date&gt;    
 1 David Bowie        musician        69    TRUE  1947-01-08 00:00:00 2016-01-10
 2 Carrie Fisher      actor           60    TRUE  1956-10-21 00:00:00 2016-12-27
 3 Chuck Berry        musician        90    TRUE  1926-10-18 00:00:00 2017-03-18
 4 Bill Paxton        actor           61    TRUE  1955-05-17 00:00:00 2017-02-25
 5 Prince             musician        57    TRUE  1958-06-07 00:00:00 2016-04-21
 6 Alan Rickman       actor           69    FALSE 1946-02-21 00:00:00 2016-01-14
 7 Florence Henderson actor           82    TRUE  1934-02-14 00:00:00 2016-11-24
 8 Harper Lee         author          89    FALSE 1926-04-28 00:00:00 2016-02-19
 9 Zsa Zsa Gábor      actor           99    TRUE  1917-02-06 00:00:00 2016-12-18
10 George Michael     musician        53    FALSE 1963-06-25 00:00:00 2016-12-25
11 Some               &lt;NA&gt;            &lt;NA&gt;  &lt;NA&gt;  NA                  NA        
12 &lt;NA&gt;               also like to w… &lt;NA&gt;  &lt;NA&gt;  NA                  NA        
13 &lt;NA&gt;               &lt;NA&gt;            at t… bott… NA                  NA        
14 &lt;NA&gt;               &lt;NA&gt;            &lt;NA&gt;  &lt;NA&gt;  NA                  NA        </code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-5" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>We can also <span class="hl-yellow"><strong>load an Excel with several sheets</strong></span>: to <span class="hl-yellow"><strong>indicate the sheet</strong></span> (either by its name or by its number) we will use the argument <code>sheet = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb898"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb898-1"><a href="#cb898-1"></a>mtcars <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/datasets.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"mtcars"</span>)</span>
<span id="cb898-2"><a href="#cb898-2"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 11
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ℹ 22 more rows</code></pre>
</div>
</div>
</section>
<section id="excel-data-.xls-.xlsx-6" class="slide level2">
<h2>Excel data (.xls, .xlsx)</h2>
<p>We can even indicate the <span class="hl-yellow"><strong>range of cells</strong></span> to load with <code>range = ...</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb900"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb900-1"><a href="#cb900-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/datasets.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"iris"</span>, <span class="at">range =</span> <span class="st">"C1:E4"</span>)</span>
<span id="cb900-2"><a href="#cb900-2"></a>iris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Petal.Length Petal.Width Species
         &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
1          1.4         0.2 setosa 
2          1.4         0.2 setosa 
3          1.3         0.2 setosa </code></pre>
</div>
</div>
</section>
<section id="import-from-sasstataspss" class="slide level2">
<h2>Import from SAS/STATA/SPSS</h2>
<p>The <code>{haven}</code> package within the tidyverse orbit will allow us to <span class="hl-yellow"><strong>import files from the 3 most important payment software</strong></span>: SAS, SPSS and Stata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb902"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb902-1"><a href="#cb902-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb902-2"><a href="#cb902-2"></a></span>
<span id="cb902-3"><a href="#cb902-3"></a><span class="co"># SAS</span></span>
<span id="cb902-4"><a href="#cb902-4"></a>iris_sas <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="at">data_file =</span> <span class="st">"./data/iris.sas7bdat"</span>)</span>
<span id="cb902-5"><a href="#cb902-5"></a></span>
<span id="cb902-6"><a href="#cb902-6"></a><span class="co"># SPSS</span></span>
<span id="cb902-7"><a href="#cb902-7"></a>iris_spss <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="at">file =</span> <span class="st">"./data/iris.sav"</span>)</span>
<span id="cb902-8"><a href="#cb902-8"></a></span>
<span id="cb902-9"><a href="#cb902-9"></a><span class="co"># Stata</span></span>
<span id="cb902-10"><a href="#cb902-10"></a>iris_stata <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">file =</span> <span class="st">"./data/iris.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="export" class="slide level2">
<h2>Export</h2>
<p>In the same way that we can import we can also <span class="hl-yellow"><strong>export</strong></span></p>
<ul>
<li>exported in <code>.RData</code> (recommended option for variables stored in <code>R</code>). Remember that this extension <span class="hl-yellow"><strong>can only be used in <code>R</code></strong></span>. To do so, just use <code>save(object, file = path)</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb903"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb903-1"><a href="#cb903-1"></a>table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb903-2"><a href="#cb903-2"></a><span class="fu">save</span>(table, <span class="at">file =</span> <span class="st">"./data/table.RData"</span>)</span>
<span id="cb903-3"><a href="#cb903-3"></a><span class="fu">rm</span>(table) <span class="co"># eliminar</span></span>
<span id="cb903-4"><a href="#cb903-4"></a><span class="fu">load</span>(<span class="st">"./data/table.RData"</span>)</span>
<span id="cb903-5"><a href="#cb903-5"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;int&gt; &lt;int&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="export-1" class="slide level2">
<h2>Export</h2>
<p>In the same way that we can import we can also <span class="hl-yellow"><strong>export</strong></span></p>
<ul>
<li>exported in <code>.RData</code> multiple objects</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb905"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb905-1"><a href="#cb905-1"></a>table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb905-2"><a href="#cb905-2"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb905-3"><a href="#cb905-3"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"javi"</span>, <span class="st">"sandra"</span>)</span>
<span id="cb905-4"><a href="#cb905-4"></a><span class="fu">save</span>(table, a, b, <span class="at">file =</span> <span class="st">"./data/mult_obj.RData"</span>)</span>
<span id="cb905-5"><a href="#cb905-5"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"table"</span>))</span>
<span id="cb905-6"><a href="#cb905-6"></a><span class="fu">load</span>(<span class="st">"./data/mult_obj.RData"</span>)</span>
<span id="cb905-7"><a href="#cb905-7"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;int&gt; &lt;int&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="export-2" class="slide level2">
<h2>Export</h2>
<p>In the same way that we can import we can also <span class="hl-yellow"><strong>export</strong></span></p>
<ul>
<li>exported in <code>.csv</code>. To do this we simply use <code>write_csv(object, file = path)</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb907"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb907-1"><a href="#cb907-1"></a><span class="fu">write_csv</span>(table, <span class="at">file =</span> <span class="st">"./data/table.csv"</span>)</span>
<span id="cb907-2"><a href="#cb907-2"></a><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/table.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      a     b
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1
2     2     2
3     3     3
4     4     4</code></pre>
</div>
</div>
</section>
<section id="import-from-website" class="slide level2">
<h2>Import from website</h2>
<p>One of the main advantages of <code>R</code> is that we can make use of all the previous functions of <span class="hl-yellow"><strong>import but directly from a web</strong></span>, without the need to perform the manual download: instead of passing it the local path we will indicate the <span class="hl-yellow"><strong>link</strong></span>. For example, we are going to download the covid data from ISCIII (<a href="https://cnecovid.isciii.es/covid19/#documentaci%C3%B3n-y-datos" class="uri">https://cnecovid.isciii.es/covid19/#documentaci%C3%B3n-y-datos</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb909"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb909-1"><a href="#cb909-1"></a>covid_data <span class="ot">&lt;-</span></span>
<span id="cb909-2"><a href="#cb909-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://cnecovid.isciii.es/covid19/resources/casos_hosp_uci_def_sexo_edad_provres.csv"</span>)</span>
<span id="cb909-3"><a href="#cb909-3"></a>covid_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 500 × 8
   provincia_iso sexo  grupo_edad fecha      num_casos num_hosp num_uci num_def
   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;      &lt;date&gt;         &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 A             H     0-9        2020-01-01         0        0       0       0
 2 A             H     10-19      2020-01-01         0        0       0       0
 3 A             H     20-29      2020-01-01         0        0       0       0
 4 A             H     30-39      2020-01-01         0        0       0       0
 5 A             H     40-49      2020-01-01         0        0       0       0
 6 A             H     50-59      2020-01-01         0        0       0       0
 7 A             H     60-69      2020-01-01         0        0       0       0
 8 A             H     70-79      2020-01-01         0        0       0       0
 9 A             H     80+        2020-01-01         0        0       0       0
10 A             H     NC         2020-01-01         0        0       0       0
# ℹ 490 more rows</code></pre>
</div>
</div>
</section>
<section id="import-from-wikipedia" class="slide level2">
<h2>Import from wikipedia</h2>
<p>The <code>{rvest}</code> package, one of the most useful of <code>{tidyverse}</code> allows us to import directly from an <code>html</code>. For example, to export wikipedia tables just <code>read_html()</code> to import the html, <code>html_element("table")</code> to extract the table objects, and <code>html_table()</code> to convert the html table to <code>tibble</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb911"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb911-1"><a href="#cb911-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb911-2"><a href="#cb911-2"></a>wiki_jump <span class="ot">&lt;-</span> <span class="st">'https://en.wikipedia.org/wiki/Men%27s_long_jump_world_record_progression'</span></span>
<span id="cb911-3"><a href="#cb911-3"></a>wiki_jump <span class="sc">|&gt;</span> <span class="fu">read_html</span>() <span class="sc">|&gt;</span> </span>
<span id="cb911-4"><a href="#cb911-4"></a>  <span class="fu">html_element</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb911-5"><a href="#cb911-5"></a>  <span class="fu">html_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 5
   Mark                       Wind   Athlete                  Place        Date 
   &lt;chr&gt;                      &lt;chr&gt;  &lt;chr&gt;                    &lt;chr&gt;        &lt;chr&gt;
 1 7.61&nbsp;m (24&nbsp;ft 11+1⁄2&nbsp;in)   ""     Peter O'Connor&nbsp;(IRE)     Dublin, Ire… 5 Au…
 2 7.69&nbsp;m (25&nbsp;ft 2+3⁄4&nbsp;in)    ""     Edward Gourdin&nbsp;(USA)     Cambridge, … 23 J…
 3 7.76&nbsp;m (25&nbsp;ft 5+1⁄2&nbsp;in)    ""     Robert LeGendre&nbsp;(USA)    Paris, Fran… 7 Ju…
 4 7.89&nbsp;m (25&nbsp;ft 10+1⁄2&nbsp;in)   ""     DeHart Hubbard&nbsp;(USA)     Chicago, Un… 13 J…
 5 7.90&nbsp;m (25&nbsp;ft 11&nbsp;in)       ""     Edward Hamm&nbsp;(USA)        Cambridge, … 7 Ju…
 6 7.93&nbsp;m (26&nbsp;ft 0&nbsp;in)        "0.0"  Sylvio Cator&nbsp;(HAI)       Paris, Fran… 9 Se…
 7 7.98&nbsp;m (26&nbsp;ft 2&nbsp;in)        "0.5"  Chuhei Nambu&nbsp;(JPN)       Tokyo, Japan 27 O…
 8 8.13&nbsp;m (26&nbsp;ft 8&nbsp;in)        "1.5"  Jesse Owens&nbsp;(USA)        Ann Arbor, … 25 M…
 9 8.21&nbsp;m (26&nbsp;ft 11&nbsp;in)       "0.0"  Ralph Boston&nbsp;(USA)       Walnut, Uni… 12 A…
10 8.24&nbsp;m (27&nbsp;ft 1⁄4&nbsp;in)      "1.8"  Ralph Boston&nbsp;(USA)       Modesto, Un… 27 M…
11 8.28&nbsp;m (27&nbsp;ft 1+3⁄4&nbsp;in)    "1.2"  Ralph Boston&nbsp;(USA)       Moscow, Sov… 16 J…
12 8.31&nbsp;m (27&nbsp;ft 3&nbsp;in)&nbsp;A      "−0.1" Igor Ter-Ovanesyan&nbsp;(URS) Yerevan, So… 10 J…
13 8.33&nbsp;m (27&nbsp;ft 3+3⁄4&nbsp;in)[2] ""     Phil Shinnick&nbsp;(USA)      Modesto, Un… 25 M…
14 8.31&nbsp;m (27&nbsp;ft 3&nbsp;in)        "0.0"  Ralph Boston&nbsp;(USA)       Kingston, J… 15 A…
15 8.34&nbsp;m (27&nbsp;ft 4+1⁄4&nbsp;in)    "1.0"  Ralph Boston&nbsp;(USA)       Los Angeles… 12 S…
16 8.35&nbsp;m (27&nbsp;ft 4+1⁄2&nbsp;in)[5] "0.0"  Ralph Boston&nbsp;(USA)       Modesto, Un… 29 M…
17 8.35&nbsp;m (27&nbsp;ft 4+1⁄2&nbsp;in)&nbsp;A  "0.0"  Igor Ter-Ovanesyan&nbsp;(URS) Mexico City… 19 O…
18 8.90&nbsp;m (29&nbsp;ft 2+1⁄4&nbsp;in)&nbsp;A  "2.0"  Bob Beamon&nbsp;(USA)         Mexico City… 18 O…
19 8.95&nbsp;m (29&nbsp;ft 4+1⁄4&nbsp;in)    "0.3"  Mike Powell&nbsp;(USA)        Tokyo, Japan 30 A…</code></pre>
</div>
</div>
</section>
<section id="import-from-google-drive" class="slide level2">
<h2>Import from google drive</h2>
<p>Another option available (especially if we work with other people working) is to <span class="hl-yellow"><strong>import from a Google Drive spreadsheet</strong></span>, making use of <code>read_sheet()</code> from the <code>{googlesheets4}</code> package.</p>
<p>The first time you will be asked for a tidyverse permission to interact with your drive</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb913"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb913-1"><a href="#cb913-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb913-2"><a href="#cb913-2"></a>google_sheet <span class="ot">&lt;-</span></span>
<span id="cb913-3"><a href="#cb913-3"></a>  <span class="fu">read_sheet</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1Uz38nHjl3bmftxDpcXj--DYyPo1I39NHVf-xjeg1_wI/edit?usp=sharing"</span>)</span>
<span id="cb913-4"><a href="#cb913-4"></a>google_sheet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  a         b     c d     
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; 
1 d1      0.5     1 hombre
2 d2     -0.3     2 hombre
3 d3      1.1     3 mujer </code></pre>
</div>
</div>
</section>
<section id="import-from-api-owid" class="slide level2">
<h2>Import from API (owid)</h2>
<p>Another interesting option is the <span class="hl-yellow"><strong>data download from an API</strong></span>: an intermediary between an app or data provider and our <code>R</code>. For example, let’s load the <code>{owidR}</code> library, which allows us to download data from the web <a href="https://ourworldindata.org/" class="uri">https://ourworldindata.org/</a>. For example, the <code>owid_covid()</code> function loads without realizing it more than 400 000 records with more than 60 variables from 238 countries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb915"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb915-1"><a href="#cb915-1"></a><span class="fu">library</span>(owidR)</span>
<span id="cb915-2"><a href="#cb915-2"></a><span class="fu">owid_covid</span>() <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 67
  iso_code continent location    date       total_cases new_cases
  &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;       &lt;IDate&gt;          &lt;int&gt;     &lt;int&gt;
1 AFG      Asia      Afghanistan 2020-01-05           0         0
2 AFG      Asia      Afghanistan 2020-01-06           0         0
3 AFG      Asia      Afghanistan 2020-01-07           0         0
4 AFG      Asia      Afghanistan 2020-01-08           0         0
5 AFG      Asia      Afghanistan 2020-01-09           0         0
6 AFG      Asia      Afghanistan 2020-01-10           0         0
7 AFG      Asia      Afghanistan 2020-01-11           0         0
# ℹ 61 more variables: new_cases_smoothed &lt;dbl&gt;, total_deaths &lt;int&gt;,
#   new_deaths &lt;int&gt;, new_deaths_smoothed &lt;dbl&gt;, total_cases_per_million &lt;dbl&gt;,
#   new_cases_per_million &lt;dbl&gt;, new_cases_smoothed_per_million &lt;dbl&gt;,
#   total_deaths_per_million &lt;dbl&gt;, new_deaths_per_million &lt;dbl&gt;,
#   new_deaths_smoothed_per_million &lt;dbl&gt;, reproduction_rate &lt;dbl&gt;,
#   icu_patients &lt;int&gt;, icu_patients_per_million &lt;dbl&gt;, hosp_patients &lt;int&gt;,
#   hosp_patients_per_million &lt;dbl&gt;, weekly_icu_admissions &lt;int&gt;, …</code></pre>
</div>
</div>
</section>
<section id="import-from-api-aemet" class="slide level2">
<h2>Import from API (aemet)</h2>
<p>In many occasions to connect to the API we will first have to <span class="hl-yellow"><strong>register and obtain a key</strong></span>, this is the case of the <code>{climaemet}</code> package to access <span class="hl-yellow"><strong>Spanish meteorological data</strong></span> (<a href="https://opendata.aemet.es/centrodedescargas/inicio" class="uri">https://opendata.aemet.es/centrodedescargas/inicio</a>).</p>
<p>Once we have the API key we register it in our RStudio to be able to use it in the future.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb917"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb917-1"><a href="#cb917-1"></a><span class="fu">library</span>(climaemet)</span>
<span id="cb917-2"><a href="#cb917-2"></a></span>
<span id="cb917-3"><a href="#cb917-3"></a><span class="co"># Api key</span></span>
<span id="cb917-4"><a href="#cb917-4"></a>apikey <span class="ot">&lt;-</span> <span class="st">"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJqYXZhbHYwOUB1Y20uZXMiLCJqdGkiOiI4YTU1ODUxMS01MTE3LTQ4MTYtYmM4OS1hYmVkNDhiODBkYzkiLCJpc3MiOiJBRU1FVCIsImlhdCI6MTY2NjQ2OTcxNSwidXNlcklkIjoiOGE1NTg1MTEtNTExNy00ODE2LWJjODktYWJlZDQ4YjgwZGM5Iiwicm9sZSI6IiJ9.HEMR77lZy2ASjmOxJa8ppx2J8Za1IViurMX3p1reVBU"</span></span>
<span id="cb917-5"><a href="#cb917-5"></a></span>
<span id="cb917-6"><a href="#cb917-6"></a><span class="fu">aemet_api_key</span>(apikey, <span class="at">install =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-from-api-aemet-1" class="slide level2">
<h2>Import from API (aemet)</h2>
<p>With this package we can do a <span class="hl-yellow"><strong>search for stations</strong></span> to know both its postal code and its identifier code within the AEMET network</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb918"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb918-1"><a href="#cb918-1"></a>stations <span class="ot">&lt;-</span> <span class="fu">aemet_stations</span>()</span>
<span id="cb918-2"><a href="#cb918-2"></a>stations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 947 × 7
   indicativo indsinop nombre                 provincia altitud longitud latitud
   &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;                  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 B013X      "08304"  ESCORCA, LLUC          ILLES BA…     490     2.89    39.8
 2 B051A      "08316"  SÓLLER, PUERTO         ILLES BA…       5     2.69    39.8
 3 B087X      ""       BANYALBUFAR            ILLES BA…      60     2.51    39.7
 4 B103B      "99103"  ANDRATX - SANT ELM     ILLES BA…      52     2.37    39.6
 5 B158X      ""       CALVIÀ, ES CAPDELLÀ    ILLES BA…      50     2.47    39.6
 6 B228       "08301"  PALMA, PUERTO          ILLES BA…       3     2.63    39.6
 7 B236C      ""       PALMA, UNIVERSIDAD     ILLES BA…      95     2.64    39.6
 8 B248       "08303"  SIERRA DE ALFABIA, BU… ILLES BA…    1030     2.71    39.7
 9 B275E      "08302"  SON BONET, AEROPUERTO  BALEARES       49     2.71    39.6
10 B278       "08306"  PALMA DE MALLORCA, AE… ILLES BA…       8     2.74    39.6
# ℹ 937 more rows</code></pre>
</div>
</div>
</section>
<section id="import-from-api-aemet-2" class="slide level2">
<h2>Import from API (aemet)</h2>
<p>For example, to get data from the station of the airport of El Prat, Barcelona, the code to provide is <code>"0076"</code>, obtaining <strong>hourly data</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb920"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb920-1"><a href="#cb920-1"></a><span class="fu">aemet_last_obs</span>(<span class="st">"0076"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 23
   idema   lon fint                 prec   alt  vmax    vv    dv   lat  dmax
   &lt;chr&gt; &lt;dbl&gt; &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 0076   2.07 2024-11-02 08:00:00   0       4  10.3   4.2    10  41.3   340
 2 0076   2.07 2024-11-02 09:00:00   0       4  10.8   4.4    10  41.3    30
 3 0076   2.07 2024-11-02 10:00:00   0.2     4  12.4   4.7   360  41.3    10
 4 0076   2.07 2024-11-02 11:00:00   0       4  11.8   4.7    10  41.3    10
 5 0076   2.07 2024-11-02 12:00:00   0       4  14.9  10.7    70  41.3    70
 6 0076   2.07 2024-11-02 13:00:00   0.3     4  16    11.9    70  41.3    80
 7 0076   2.07 2024-11-02 14:00:00   0       4  18    14.1    80  41.3    80
 8 0076   2.07 2024-11-02 15:00:00   0       4  17    13.4    90  41.3    80
 9 0076   2.07 2024-11-02 16:00:00   0       4  14.9  11.4    90  41.3    80
10 0076   2.07 2024-11-02 17:00:00   0       4  13.4   9.9    90  41.3    80
11 0076   2.07 2024-11-02 18:00:00   0       4  11.8   7.3    80  41.3    80
12 0076   2.07 2024-11-02 19:00:00   0       4   9.8   6.4    80  41.3    80
# ℹ 13 more variables: ubi &lt;chr&gt;, pres &lt;dbl&gt;, hr &lt;dbl&gt;, stdvv &lt;dbl&gt;, ts &lt;dbl&gt;,
#   pres_nmar &lt;dbl&gt;, tamin &lt;dbl&gt;, ta &lt;dbl&gt;, tamax &lt;dbl&gt;, tpr &lt;dbl&gt;, vis &lt;dbl&gt;,
#   stddv &lt;dbl&gt;, inso &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="importar-from-api-us-census" class="slide level2">
<h2>Importar from API (US census)</h2>
<p>One of the most useful tools in recent years is known as <code>{tidycensus}</code>: a tool for <span class="hl-yellow"><strong>facilitating the process of downloading census data</strong></span> for the United States from <code>R</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb922"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb922-1"><a href="#cb922-1"></a><span class="fu">library</span>(tidycensus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><code>get_decennial()</code>: to access the <span class="hl-yellow"><strong>census data (US Decennial Census)</strong></span>, done every 10 years (years 2000, 2010 and 2020).</p></li>
<li><p><code>get_acs()</code>: to access the <span class="hl-yellow"><strong>annual and quinquennial (5 years) ACS (American Community Survey)</strong></span> (census != survey)</p></li>
<li><p><code>get_estimates()</code>: to access the <span class="hl-yellow"><strong>annual population, birth and death estimates</strong></span> (census != survey)</p></li>
<li><p><code>get_pums()</code>: to access the <span class="hl-yellow"><strong>microdata (unaggregated data) of the ACS (anonymized at the individual level)</strong></span></p></li>
<li><p><code>get_flows()</code>: to access the <span class="hl-yellow"><strong>migration flow</strong></span> data.</p></li>
</ul>
</section>
<section id="importar-from-api-us-census-1" class="slide level2">
<h2>Importar from API (US census)</h2>
<p>For example, we will download the <strong>census data</strong> (<code>get_decennial()</code>) at the state level (<code>geography = “state”</code>) for the population (variable <code>variables = “P001001”</code>) for the year 2010 (see variables in <code>tidycensus::load_variables()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb923"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb923-1"><a href="#cb923-1"></a>total_population_10 <span class="ot">&lt;-</span></span>
<span id="cb923-2"><a href="#cb923-2"></a>  <span class="fu">get_decennial</span>(<span class="at">geography =</span> <span class="st">"state"</span>, </span>
<span id="cb923-3"><a href="#cb923-3"></a>  <span class="at">variables =</span> <span class="st">"P001001"</span>,</span>
<span id="cb923-4"><a href="#cb923-4"></a>  <span class="at">year =</span> <span class="dv">2010</span>)</span>
<span id="cb923-5"><a href="#cb923-5"></a>total_population_10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 52 × 4
   GEOID NAME        variable    value
   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;
 1 01    Alabama     P001001   4779736
 2 02    Alaska      P001001    710231
 3 04    Arizona     P001001   6392017
 4 05    Arkansas    P001001   2915918
 5 06    California  P001001  37253956
 6 22    Louisiana   P001001   4533372
 7 21    Kentucky    P001001   4339367
 8 08    Colorado    P001001   5029196
 9 09    Connecticut P001001   3574097
10 10    Delaware    P001001    897934
# ℹ 42 more rows</code></pre>
</div>
</div>
</section>
<section id="import-from-api" class="slide level2">
<h2>Import from API</h2>
<p>Other options:</p>
<ul>
<li><p><code>{chessR}</code>: data from chess matches. See <a href="https://github.com/JaseZiv/chessR" class="uri">https://github.com/JaseZiv/chessR</a></p></li>
<li><p><code>{spotifyr}</code>: data from Spotify. See <a href="https://www.rcharlie.com/spotifyr/" class="uri">https://www.rcharlie.com/spotifyr/</a></p></li>
<li><p><code>{gtrendsR}</code>: data from Google Trends. See <a href="https://github.com/PMassicotte/gtrendsR" class="uri">https://github.com/PMassicotte/gtrendsR</a></p></li>
<li><p><code>{scholar}</code>: data from <a href="https://github.com/jkeirstead/scholar" class="uri">https://github.com/jkeirstead/scholar</a></p></li>
</ul>
</section>
<section id="tu-turno-7-1" class="slide level2">
<h2>💻 Your turn</h2>
<p><span style="color:#444442;"><strong>Try to solve the following exercises without looking at the solutions</strong></span></p>
<p><a href="https://drive.google.com/drive/folders/18Ok6Epqcimszqguj_JTTLuSbs5Ot5Srd?usp=sharing">📊 Data</a></p>
<div class="panel-tabset">
<ul id="tabset-17" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-17-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-17-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-17-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-17-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-17-1">
<p>📝 The <code>who</code> dataset we have used in previous exercises, export it to a native <code>R</code> format in the <code>data</code> folder of the project</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb925"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb925-1"><a href="#cb925-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb925-2"><a href="#cb925-2"></a><span class="fu">save</span>(who, <span class="at">file =</span> <span class="st">"./data/who.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-17-2">
<p>📝 Loads the <code>who</code> dataset but from the data folder (import the file created in the previous exercise)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb926"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb926-1"><a href="#cb926-1"></a><span class="fu">load</span>(<span class="st">"./data/who.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-17-3">
<p>📝 Repeats the same (export and import) in 4 formats: <code>.csv</code>, <code>.xlsx</code>, <code>.sav</code> (spss) and <code>.dta</code> (stata)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb927"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb927-1"><a href="#cb927-1"></a><span class="co"># csv</span></span>
<span id="cb927-2"><a href="#cb927-2"></a><span class="fu">library</span>(readr)</span>
<span id="cb927-3"><a href="#cb927-3"></a><span class="fu">write_csv</span>(who, <span class="at">file =</span> <span class="st">"./data/who.csv"</span>)</span>
<span id="cb927-4"><a href="#cb927-4"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/who.csv"</span>)</span>
<span id="cb927-5"><a href="#cb927-5"></a></span>
<span id="cb927-6"><a href="#cb927-6"></a><span class="co"># excel</span></span>
<span id="cb927-7"><a href="#cb927-7"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb927-8"><a href="#cb927-8"></a><span class="fu">write.xlsx</span>(who, <span class="at">file =</span> <span class="st">"./data/who.xlsx"</span>)</span>
<span id="cb927-9"><a href="#cb927-9"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="at">path =</span> <span class="st">"./data/who.xlsx"</span>)</span>
<span id="cb927-10"><a href="#cb927-10"></a></span>
<span id="cb927-11"><a href="#cb927-11"></a><span class="co"># sas y stata</span></span>
<span id="cb927-12"><a href="#cb927-12"></a><span class="fu">library</span>(haven)</span>
<span id="cb927-13"><a href="#cb927-13"></a><span class="fu">write_sav</span>(who, <span class="at">path =</span> <span class="st">"./data/who.sav"</span>)</span>
<span id="cb927-14"><a href="#cb927-14"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_spss</span>(<span class="at">path =</span> <span class="st">"./data/who.sav"</span>)</span>
<span id="cb927-15"><a href="#cb927-15"></a></span>
<span id="cb927-16"><a href="#cb927-16"></a><span class="fu">write_dta</span>(who, <span class="at">path =</span> <span class="st">"./data/who.dta"</span>)</span>
<span id="cb927-17"><a href="#cb927-17"></a>who_data <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="at">path =</span> <span class="st">"./data/who.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-17-4">
<p>📝 Repeat the loading of <code>who.csv</code> but only select the first 4 columns already in the load.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb928"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb928-1"><a href="#cb928-1"></a>who_select <span class="ot">&lt;-</span></span>
<span id="cb928-2"><a href="#cb928-2"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/who.csv"</span>,</span>
<span id="cb928-3"><a href="#cb928-3"></a>           <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"iso2"</span>, <span class="st">"iso3"</span>, <span class="st">"year"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-7-1" class="slide level2">
<h2>🐣 Case study I: CIS feminism</h2>
<p><a href="https://drive.google.com/drive/folders/18Ok6Epqcimszqguj_JTTLuSbs5Ot5Srd?usp=sharing">📊 Data</a></p>
<p>We are going to <strong>put into practice the loading and preprocessing of a file generated by one of the most used software (SPSS)</strong>. The file contains data from the <span class="hl-yellow"><strong>CIS (Centro de Investigaciones Sociológicas) barometer «Perceptions on equality between men and women and gender stereotypes»</strong></span> (file extension <code>.sav</code> that you have in the subfolder <code>CIS-feminism</code> inside the data folder) whose sample work was carried out from November 6 to 14 (4000 interviews of both sexes over 16 years old in 1174 municipalities and 50 provinces).</p>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="..."><strong>workbook</strong></a></p>
</section></section>
<section>
<section id="clase-8" class="title-slide slide level1 center">
<h1>L8: <span class="flow">factors and lists</span></h1>
<p><span style="color:#444442;"><strong>Handling with factors and lists</strong></span></p>
<ul>
<li><p><a href="#/tu-turno-8-1">💻 Solved exercises: lists</a></p></li>
<li><p><a href="#/tu-turno-8-2">💻 Solved exercises: factors</a></p></li>
<li><p><a href="#/caso-practico-8-1">🐣 Workbook/case study I</a></p></li>
<li><p><a href="#/planificacion-curso">📆 Planning</a></p></li>
</ul>
</section>
<section id="lists" class="slide level2">
<h2>Lists</h2>
<p>We have already seen that lists are an object in R that allows us to store <span class="hl-yellow"><strong>collections of variables of different type</strong></span> (as with <code>data.frame</code> and <code>tibble</code>) but also <span class="hl-purple"><strong>different lengths</strong></span>, with totally heterogeneous structures (even a list can have inside it another list).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb929"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb929-1"><a href="#cb929-1"></a>name <span class="ot">&lt;-</span> <span class="st">"Javi"</span></span>
<span id="cb929-2"><a href="#cb929-2"></a>age <span class="ot">&lt;-</span> <span class="dv">34</span></span>
<span id="cb929-3"><a href="#cb929-3"></a>marks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">9</span>)</span>
<span id="cb929-4"><a href="#cb929-4"></a>parents <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Paloma"</span>, <span class="st">"Goyo"</span>)</span>
<span id="cb929-5"><a href="#cb929-5"></a></span>
<span id="cb929-6"><a href="#cb929-6"></a>list_var <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"name"</span> <span class="ot">=</span> name, <span class="st">"age"</span> <span class="ot">=</span> age, <span class="st">"marks"</span> <span class="ot">=</span> marks, <span class="st">"parents"</span> <span class="ot">=</span> parents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb930"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb930-1"><a href="#cb930-1"></a>list_var<span class="sc">$</span>name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb932"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb932-1"><a href="#cb932-1"></a>list_var<span class="sc">$</span>marks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7  8  5  3 10  9</code></pre>
</div>
</div>
</section>
<section id="lists-1" class="slide level2">
<h2>Lists</h2>
<p>We can also make <span class="hl-yellow"><strong>lists with other lists inside</strong></span>, so that to access each level we must use the <code>[[]]</code> operator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb934"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb934-1"><a href="#cb934-1"></a>list_of_lists <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"list_1"</span> <span class="ot">=</span> list_var[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="st">"list_2"</span> <span class="ot">=</span> list_var[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb934-2"><a href="#cb934-2"></a><span class="fu">names</span>(list_of_lists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list_1" "list_2"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb936"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb936-1"><a href="#cb936-1"></a><span class="fu">names</span>(list_of_lists[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "name" "age" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb938"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb938-1"><a href="#cb938-1"></a>list_of_lists[[<span class="dv">1</span>]][[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Javi"</code></pre>
</div>
</div>
<div class="fragment">
<p>We are allowed to store <span class="hl-yellow"><strong>n-dimensional data</strong></span>!</p>
</div>
</section>
<section id="lists-2" class="slide level2">
<h2>Lists</h2>
<p>One of the disadvantages is that a list <span class="hl-yellow"><strong>cannot be vectorized</strong></span> immediately, so any arithmetic operation applied to a list will give <span class="hl-red"><strong>error</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb940"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb940-1"><a href="#cb940-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb940-2"><a href="#cb940-2"></a>data <span class="sc">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data/2: non-numeric argument to binary operator</code></pre>
</div>
</div>
<div class="fragment">
<p>For this purpose, one of the common (but outdated) options is to make use of the <code>lapply()</code> family.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb942"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb942-1"><a href="#cb942-1"></a><span class="fu">lapply</span>(data, <span class="at">FUN =</span> <span class="cf">function</span>(x) { x <span class="sc">/</span> <span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1] 0.5 1.0 1.5 2.0 2.5

$b
 [1]  5.0  5.5  6.0  6.5  7.0  7.5  8.0  8.5  9.0  9.5 10.0</code></pre>
</div>
</div>
<p>By default, the output of <code>lapply()</code>is always a <span class="hl-yellow"><strong>list of equal length</strong></span>.</p>
</div>
</section>
<section id="lists-3" class="slide level2">
<h2>Lists</h2>
<p>A more flexible and versatile option is to make use of the <code>{purrr}</code> package of the <code>{tidyverse}</code> environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb944"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb944-1"><a href="#cb944-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This package is intended to mimic the <span class="hl-yellow"><strong>functional programming</strong></span> of other languages such as Scala or Hadoop’s <span class="hl-yellow"><strong>map-reduce strategy</strong></span> (from Google).</p>

<img data-src="img/purrr.png" class="r-stretch"></section>
<section id="lists-4" class="slide level2">
<h2>Lists</h2>
<p>The simplest function of the <code>{purrr}</code> package is the <code>map()</code> function, which <span class="hl-yellow"><strong>applies a vectorized function</strong></span> to each of the elements of a list. Let’s see a first example applied to vectors</p>
<div class="fragment">
<p><code>map()</code> allows us to <span class="hl-yellow"><strong>“map” each list</strong></span> and apply the function element by element (if applicable).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb945"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb945-1"><a href="#cb945-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"x1"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">"x2"</span> <span class="ot">=</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb945-2"><a href="#cb945-2"></a><span class="fu">map</span>(x, sqrt) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x1
[1] 1.000000 1.414214 1.732051 2.000000

$x2
 [1] 3.316625 3.464102 3.605551 3.741657 3.872983 4.000000 4.123106 4.242641
 [9] 4.358899 4.472136</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Be careful</strong></p>
</div>
<div class="callout-content">
<p>With vectors we have a default vectorization because <code>R</code> performs element-by-element operations. Note that, by default, the <span class="hl-yellow"><strong>output of <code>map</code> is a list</strong></span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="lists-5" class="slide level2">
<h2>Lists</h2>
<p>Let’s look at another example. Define in a list two samples from 2 normal distributions, of different sample size and different mean. Compute the mean of each one.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb947"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb947-1"><a href="#cb947-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1500</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.7</span>),</span>
<span id="cb947-2"><a href="#cb947-2"></a>          <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">2800</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">1.5</span>))</span>
<span id="cb947-3"><a href="#cb947-3"></a><span class="fu">map</span>(x, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] -0.0001246631

[[2]]
[1] 2.005557</code></pre>
</div>
</div>
</section>
<section id="lists-6" class="slide level2">
<h2>Lists</h2>
<p>What if we want to calculate the mean of their squared values?</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb949"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb949-1"><a href="#cb949-1"></a><span class="fu">map</span>(x, <span class="cf">function</span>(x) { <span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span>) })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.4911131

[[2]]
[1] 6.327786</code></pre>
</div>
</div>
</section>
<section id="lists-7" class="slide level2">
<h2>Lists</h2>
<p>In addition to being <span class="hl-yellow"><strong>more readable and efficient</strong></span>, with <code>{purrr}</code> we can <span class="hl-yellow"><strong>decide the output format</strong></span> after the operation</p>
<ul>
<li>output as <span class="hl-purple"><strong>numeric (double) vector</strong></span> with <code>map_dbl()</code></li>
<li>output as <span class="hl-purple"><strong>numeric (int) vector</strong></span> with <code>map_int()</code></li>
<li>output as <span class="hl-purple"><strong>character vector</strong></span> with <code>map_chr()</code></li>
<li>output as <span class="hl-purple"><strong>logical vector</strong></span> with <code>map_lgl()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb951"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb951-1"><a href="#cb951-1"></a><span class="fu">map_dbl</span>(x, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.0001246631  2.0055569088</code></pre>
</div>
<div class="sourceCode cell-code" id="cb953"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb953-1"><a href="#cb953-1"></a><span class="fu">map_chr</span>(x, <span class="cf">function</span>(x) { <span class="fu">glue</span>(<span class="st">"Mean is {round(mean(x), 5)}"</span>) })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean is -0.00012" "Mean is 2.00556" </code></pre>
</div>
</div>
</section>
<section id="lists-8" class="slide level2">
<h2>Lists</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb955"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb955-1"><a href="#cb955-1"></a><span class="fu">c</span>(x[[<span class="dv">1</span>]][<span class="dv">3</span>], x[[<span class="dv">2</span>]][<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3591987  4.6233320</code></pre>
</div>
</div>
<p>Also, if you pass it a <span class="hl-yellow"><strong>number</strong></span> instead of a function, it will return the <span class="hl-yellow"><strong>ith element of each list</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb957"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb957-1"><a href="#cb957-1"></a><span class="fu">map_dbl</span>(x, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3591987  4.6233320</code></pre>
</div>
</div>
</section>
<section id="lists-9" class="slide level2">
<h2>Lists</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb959"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb959-1"><a href="#cb959-1"></a>list_dummy <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> dplyr<span class="sc">::</span>starwars, <span class="st">"b"</span> <span class="ot">=</span> tidyr<span class="sc">::</span>billboard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also use <code>pluck()</code> to <span class="hl-yellow"><strong>access to the i-th element of a list</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb960"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb960-1"><a href="#cb960-1"></a>list_dummy <span class="sc">|&gt;</span> </span>
<span id="cb960-2"><a href="#cb960-2"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Luke Sk…    172    77 blond      fair       blue            19   male  mascu…
 2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
 3 R2-D2        96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
 4 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
 5 Leia Or…    150    49 brown      light      brown           19   fema… femin…
 6 Owen La…    178   120 brown, gr… light      blue            52   male  mascu…
 7 Beru Wh…    165    75 brown      light      blue            47   fema… femin…
 8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu…
 9 Biggs D…    183    84 black      light      brown           24   male  mascu…
10 Obi-Wan…    182    77 auburn, w… fair       blue-gray       57   male  mascu…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="lists-10" class="slide level2">
<h2>Lists</h2>
<p>We also have the option of generalizing it to be able to use functions that <span class="hl-yellow"><strong>need two arguments in the form of a list</strong></span> (binary operations), with <code>map2()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb962"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb962-1"><a href="#cb962-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb962-2"><a href="#cb962-2"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"c"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">0</span>), <span class="st">"b"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb962-3"><a href="#cb962-3"></a><span class="fu">map2</span>(x, y, <span class="cf">function</span>(x, y) { x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
[1]  2 20  9

$b
[1] 41 41 37</code></pre>
</div>
</div>
</section>
<section id="lists-11" class="slide level2">
<h2>Lists</h2>
<p>We can obtain the output in the form of <code>data.frame</code> by adding <code>list_rbind()</code> or <code>list_cbind()</code>, which <span class="hl-yellow"><strong>converts a list into a table</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb964"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb964-1"><a href="#cb964-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</span>
<span id="cb964-2"><a href="#cb964-2"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb964-3"><a href="#cb964-3"></a><span class="fu">map2</span>(x, y, <span class="cf">function</span>(x, y) { <span class="fu">tibble</span>(x, y) }) <span class="sc">|&gt;</span> <span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  x         y
  &lt;chr&gt; &lt;int&gt;
1 a         1
2 b         2
3 c         3</code></pre>
</div>
</div>
</section>
<section id="lists-12" class="slide level2">
<h2>Lists</h2>
<p>We can generalize it further with <code>pmap_xxx()</code> which allows us to use <span class="hl-yellow"><strong>multiple arguments (multiple lists)</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb966"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb966-1"><a href="#cb966-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb966-2"><a href="#cb966-2"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb966-3"><a href="#cb966-3"></a>z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>)</span>
<span id="cb966-4"><a href="#cb966-4"></a><span class="fu">pmap_dbl</span>(<span class="fu">list</span>(x, y, z), sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 111 221 331</code></pre>
</div>
</div>
</section>
<section id="lists-13" class="slide level2">
<h2>Lists</h2>
<p>We have other types of iterators that, although they assume inputs, do not return anything, as <code>walk()</code> (just one input argument), <code>walk2()</code> (two arguments) and <code>pwalk()</code> (multiple arguments), all <span class="hl-yellow"><strong>invisibly return</strong></span>, just call a function for its <span class="hl-yellow"><strong>side effects</strong></span> rather than its return value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb968"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb968-1"><a href="#cb968-1"></a><span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb968-2"><a href="#cb968-2"></a>  <span class="fu">map2</span>(<span class="fu">list</span>(<span class="st">"a"</span> <span class="ot">=</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">13</span>, <span class="st">"b"</span> <span class="ot">=</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>),</span>
<span id="cb968-3"><a href="#cb968-3"></a>       <span class="cf">function</span>(x, y) { x <span class="sc">+</span> y }) <span class="sc">|&gt;</span> </span>
<span id="cb968-4"><a href="#cb968-4"></a>  <span class="fu">walk</span>(print)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12 14 16
[1] 18 20 22</code></pre>
</div>
</div>
</section>
<section id="tu-turno-8-1" class="slide level2">
<h2>💻 It’s your turn</h2>
<div class="panel-tabset">
<ul id="tabset-18" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-18-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-18-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-18-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-18-1">
<p>📝 Define a list of 4 elements of different types and access the second of them (I will include one that is a tibble so that you can see that in a list there is room for everything).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb970"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb970-1"><a href="#cb970-1"></a>list_example <span class="ot">&lt;-</span></span>
<span id="cb970-2"><a href="#cb970-2"></a>  <span class="fu">list</span>(<span class="st">"name"</span> <span class="ot">=</span> <span class="st">"Javier"</span>, <span class="st">"cp"</span> <span class="ot">=</span> <span class="dv">28019</span>,</span>
<span id="cb970-3"><a href="#cb970-3"></a>       <span class="st">"siblings"</span> <span class="ot">=</span> <span class="cn">TRUE</span>,</span>
<span id="cb970-4"><a href="#cb970-4"></a>       <span class="st">"marks"</span> <span class="ot">=</span> <span class="fu">tibble</span>(<span class="st">"maths"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">8</span>, <span class="dv">9</span>),</span>
<span id="cb970-5"><a href="#cb970-5"></a>                        <span class="st">"lang"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">6</span>)))</span>
<span id="cb970-6"><a href="#cb970-6"></a>list_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-18-2">
<p>📝 From the list above, access the elements that occupy places 1 and 4 of the list defined above.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb971"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb971-1"><a href="#cb971-1"></a>list_example[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb971-2"><a href="#cb971-2"></a></span>
<span id="cb971-3"><a href="#cb971-3"></a>list_example<span class="sc">$</span>name</span>
<span id="cb971-4"><a href="#cb971-4"></a>list_example<span class="sc">$</span>marks</span>
<span id="cb971-5"><a href="#cb971-5"></a></span>
<span id="cb971-6"><a href="#cb971-6"></a>list_example[<span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"marks"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-18-3">
<p>📝 Load the <code>starwars</code> dataset from the <code>{dplyr}</code> package and access the second movie that appears in <code>starwars$films</code> (for each character). Determine which ones do not appear in more than one movie.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb972"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb972-1"><a href="#cb972-1"></a>second_film <span class="ot">&lt;-</span> <span class="fu">map</span>(starwars<span class="sc">$</span>films, <span class="dv">2</span>)</span>
<span id="cb972-2"><a href="#cb972-2"></a><span class="fu">map_lgl</span>(second_film, is.null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
[13] FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE
[25]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE  TRUE
[37]  TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
[49]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE
[61]  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
[73]  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE
[85]  TRUE  TRUE  TRUE</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="quali-factors" class="slide level2">
<h2>Quali: factors</h2>
<p>In statistics, when we talk about <span class="hl-yellow"><strong>qualitative variables</strong></span>, we will call <strong>levels or modalities</strong> the <strong>different values</strong> that these data can take. For example, in the case of the <code>sex</code> variable of the <code>starwars</code> set, we have 4 allowed levels: <code>female</code>, <code>hermaphroditic</code>, <code>male</code> and <code>none</code> (in addition to missing data).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb974"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb974-1"><a href="#cb974-1"></a>starwars <span class="sc">|&gt;</span> <span class="fu">count</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex                n
  &lt;chr&gt;          &lt;int&gt;
1 female            16
2 hermaphroditic     1
3 male              60
4 none               6
5 &lt;NA&gt;               4</code></pre>
</div>
</div>
</section>
<section id="quali-factors-1" class="slide level2">
<h2>Quali: factors</h2>
<p>These kinds of variables are known in <code>R</code> as <span class="hl-yellow"><strong>factors</strong></span>, and the fundamental package to deal with them is <code>{forcats}</code> (from the <code>{tidyverse}</code> environment).</p>

<img data-src="img/factors.jpg" class="r-stretch"></section>
<section id="quali-factors-2" class="slide level2">
<h2>Quali: factors</h2>
<p>This package allows us to set the <span class="hl-yellow"><strong>levels</strong></span> (stored internally as <code>levels</code>) that a given categorical variable takes so that no mistakes, errors in data collection and generation can be generated. It also makes their analysis less computationally expensive when doing searches and comparisons, giving them a <span class="hl-yellow"><strong>different treatment than normal text strings</strong></span>.</p>
<div class="fragment">
<p>Let’s see a simple example simulating a <code>party</code> variable taking the values <code>"PP"</code>, <code>"PSOE"</code> and <code>"SUMAR"</code> (of size 15)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb976"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb976-1"><a href="#cb976-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb976-2"><a href="#cb976-2"></a>party <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"PP"</span>, <span class="st">"PSOE"</span>, <span class="st">"SUMAR"</span>), <span class="at">size =</span> <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb976-3"><a href="#cb976-3"></a>party</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "PP"    "PSOE"  "SUMAR" "PP"    "PP"    "SUMAR" "PSOE"  "SUMAR" "SUMAR"
[10] "SUMAR" "PP"    "PSOE"  "PP"    "PSOE"  "SUMAR"</code></pre>
</div>
</div>
<p>The <code>party</code> variable is currently of <span class="hl-yellow"><strong>type text</strong></span>, of type <code>chr</code>, something we can check with <code>class(state)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb978"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb978-1"><a href="#cb978-1"></a><span class="fu">class</span>(party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
</div>
</section>
<section id="quali-factors-3" class="slide level2">
<h2>Quali: factors</h2>
<p>From a statistical and computational point of view, for <code>R</code> this variable right now would be equivalent to a named variable. But statistically <span class="hl-yellow"><strong>a variable as a string</strong></span> is not the same as a categorical variable that <span class="hl-yellow"><strong>can only take those 3 levels</strong></span>. How to <span class="hl-yellow"><strong>convert to factor</strong></span>?</p>
<div class="fragment">
<p>By making use of the <code>as_factor()</code> function from the <code>{forcats}</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb980"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb980-1"><a href="#cb980-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb980-2"><a href="#cb980-2"></a>party_fct <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(party),</span>
<span id="cb980-3"><a href="#cb980-3"></a>                    <span class="st">"party"</span> <span class="ot">=</span> <span class="fu">as_factor</span>(party))</span>
<span id="cb980-4"><a href="#cb980-4"></a>party_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
      id party
   &lt;int&gt; &lt;fct&gt;
 1     1 PP   
 2     2 PSOE 
 3     3 SUMAR
 4     4 PP   
 5     5 PP   
 6     6 SUMAR
 7     7 PSOE 
 8     8 SUMAR
 9     9 SUMAR
10    10 SUMAR
11    11 PP   
12    12 PSOE 
13    13 PP   
14    14 PSOE 
15    15 SUMAR</code></pre>
</div>
</div>
</div>
</section>
<section id="quali-factors-4" class="slide level2">
<h2>Quali: factors</h2>
<p>Not only the class of the variable has changed, but now, below the saved value, the sentence <code>Levels: ...</code> appears: these are the <span class="hl-yellow"><strong>modalities or levels</strong></span> of our qualitative.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb982"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb982-1"><a href="#cb982-1"></a>party_fct <span class="sc">|&gt;</span> <span class="fu">pull</span>(party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] PP    PSOE  SUMAR PP    PP    SUMAR PSOE  SUMAR SUMAR SUMAR PP    PSOE 
[13] PP    PSOE  SUMAR
Levels: PP PSOE SUMAR</code></pre>
</div>
</div>
</section>
<section id="quali-factors-5" class="slide level2">
<h2>Quali: factors</h2>
<p>Imagine that we are defining the database of deputies of the Congress and that the deputies of the PP did not attend that day to the plenary session: although our variable does not take that value THAT DAY, the state <code>PSOE</code> is a <span class="hl-yellow"><strong>allowed level in the database</strong></span> (so even if we eliminate it, because it is a factor, the level remains, we do not have it now but it is an allowed level).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb984"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb984-1"><a href="#cb984-1"></a>party_fct <span class="sc">|&gt;</span> </span>
<span id="cb984-2"><a href="#cb984-2"></a>  <span class="fu">filter</span>(party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PP"</span>, <span class="st">"SUMAR"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb984-3"><a href="#cb984-3"></a>  <span class="fu">pull</span>(party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] PP    SUMAR PP    PP    SUMAR SUMAR SUMAR SUMAR PP    PP    SUMAR
Levels: PP PSOE SUMAR</code></pre>
</div>
</div>
</section>
<section id="quali-factors-6" class="slide level2">
<h2>Quali: factors</h2>
<p>With <code>factor()</code> function we can <span class="hl-yellow"><strong>explicitly specify</strong></span> the names of the modalities and using <code>levels = ...</code> we can explicitly tell it the <span class="hl-yellow"><strong>“order” of the modalities</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb986"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb986-1"><a href="#cb986-1"></a>party_fct <span class="ot">&lt;-</span></span>
<span id="cb986-2"><a href="#cb986-2"></a>  <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(party),</span>
<span id="cb986-3"><a href="#cb986-3"></a>         <span class="at">party =</span> <span class="fu">factor</span>(party, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SUMAR"</span>, <span class="st">"PP"</span>, <span class="st">"PSOE"</span>)))</span>
<span id="cb986-4"><a href="#cb986-4"></a>party_fct <span class="sc">|&gt;</span> <span class="fu">pull</span>(party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] PP    PSOE  SUMAR PP    PP    SUMAR PSOE  SUMAR SUMAR SUMAR PP    PSOE 
[13] PP    PSOE  SUMAR
Levels: SUMAR PP PSOE</code></pre>
</div>
</div>
</section>
<section id="quali-factors-7" class="slide level2">
<h2>Quali: factors</h2>
<p>The previous “order” is just in the sense which it will be counted/plotted first) but <span class="hl-purple"><strong>we don’t have (yet) an ordinal variable</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb988"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb988-1"><a href="#cb988-1"></a>party_fct<span class="sc">$</span>party <span class="sc">&lt;</span> <span class="st">"SUMAR"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
</div>
</div>
<div class="fragment">
<p>What if we want to <span class="hl-yellow"><strong>define a qualitative variable ORDINAL</strong></span>? Inside <code>factor()</code> we must indicate that <code>ordered = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb990"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb990-1"><a href="#cb990-1"></a>marks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"B"</span>, <span class="st">"A+"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"D"</span>, <span class="st">"A+"</span>)</span>
<span id="cb990-2"><a href="#cb990-2"></a>marks_database <span class="ot">&lt;-</span></span>
<span id="cb990-3"><a href="#cb990-3"></a>  <span class="fu">tibble</span>(<span class="st">"student"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(marks),</span>
<span id="cb990-4"><a href="#cb990-4"></a>         <span class="st">"marks"</span> <span class="ot">=</span></span>
<span id="cb990-5"><a href="#cb990-5"></a>           <span class="fu">factor</span>(marks, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A+"</span>),</span>
<span id="cb990-6"><a href="#cb990-6"></a>                  <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb990-7"><a href="#cb990-7"></a>marks_database <span class="sc">|&gt;</span> <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A  E  F  B  A+ A  C  C  D  B  A  C  C  E  F  D  A+
Levels: F &lt; E &lt; D &lt; C &lt; B &lt; A &lt; A+</code></pre>
</div>
</div>
</div>
</section>
<section id="quali-factors-8" class="slide level2">
<h2>Quali: factors</h2>
<p>What changes? If you notice now, although the variable is still qualitative, we can <span class="hl-yellow"><strong>make comparisons and order the records</strong></span> because there is a <span class="hl-purple"><strong>hierarchy</strong></span> between the modalities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb992"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb992-1"><a href="#cb992-1"></a>marks_database <span class="sc">|&gt;</span> <span class="fu">filter</span>(marks <span class="sc">&gt;=</span> <span class="st">"B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  student marks
    &lt;int&gt; &lt;ord&gt;
1       1 A    
2       4 B    
3       5 A+   
4       6 A    
5      10 B    
6      11 A    
7      17 A+   </code></pre>
</div>
</div>
</section>
<section id="quali-factors-9" class="slide level2">
<h2>Quali: factors</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>If we want to tell it to <span class="hl-yellow"><strong>drop an unused level</strong></span> at that moment (and that we want to <span class="hl-purple"><strong>exclude from the definition</strong></span>) we can do it with <code>fct_drop()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb994"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb994-1"><a href="#cb994-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb994-2"><a href="#cb994-2"></a>  <span class="fu">filter</span>(marks <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb994-3"><a href="#cb994-3"></a>  <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A E F B A C C D B A C C E F D
Levels: F &lt; E &lt; D &lt; C &lt; B &lt; A &lt; A+</code></pre>
</div>
</div>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="./img/drop_factor.jpg" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb996"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb996-1"><a href="#cb996-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb996-2"><a href="#cb996-2"></a>  <span class="fu">filter</span>(marks <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb996-3"><a href="#cb996-3"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_drop</span>(marks)) <span class="sc">|&gt;</span>  </span>
<span id="cb996-4"><a href="#cb996-4"></a>  <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A E F B A C C D B A C C E F D
Levels: F &lt; E &lt; D &lt; C &lt; B &lt; A</code></pre>
</div>
</div>
</section>
<section id="quali-factors-10" class="slide level2">
<h2>Quali: factors</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>Just as we can delete levels we can <span class="hl-yellow"><strong>expand existing levels</strong></span> (even if there is no data for that level at that time) with <code>fct_expand()</code>.</p>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="./img/factor_expand.jpg" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb998"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb998-1"><a href="#cb998-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb998-2"><a href="#cb998-2"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_expand</span>(marks, <span class="fu">c</span>(<span class="st">"F-"</span>, <span class="st">"A+"</span>, <span class="st">"A++"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb998-3"><a href="#cb998-3"></a>  <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A  E  F  B  A+ A  C  C  D  B  A  C  C  E  F  D  A+
Levels: F &lt; E &lt; D &lt; C &lt; B &lt; A &lt; A+ &lt; F- &lt; A++</code></pre>
</div>
</div>
</section>
<section id="quali-factors-11" class="slide level2">
<h2>Quali: factors</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>In addition with <code>fct_explicit_na()</code> we can <span class="hl-yellow"><strong>assign a level to the missing values</strong></span> to be included in the analysis and visualizations.</p>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="./img/factor_explicit.jpg" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1000"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1000-1"><a href="#cb1000-1"></a><span class="fu">fct_explicit_na</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="cn">NA</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] a         b         (Missing)
Levels: a b (Missing)</code></pre>
</div>
</div>
</section>
<section id="quali-factors-12" class="slide level2">
<h2>Quali: factors</h2>
<p>Even once defined we can <span class="hl-yellow"><strong>reorder the levels</strong></span> with <code>fct_relevel()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1002"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1002-1"><a href="#cb1002-1"></a>marks_database_expand <span class="ot">&lt;-</span> </span>
<span id="cb1002-2"><a href="#cb1002-2"></a>  marks_database <span class="sc">|&gt;</span>  </span>
<span id="cb1002-3"><a href="#cb1002-3"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_expand</span>(marks, <span class="fu">c</span>(<span class="st">"F-"</span>, <span class="st">"A+"</span>, <span class="st">"A++"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb1002-4"><a href="#cb1002-4"></a>  <span class="fu">pull</span>(marks)</span>
<span id="cb1002-5"><a href="#cb1002-5"></a></span>
<span id="cb1002-6"><a href="#cb1002-6"></a>marks_database_expand <span class="sc">|&gt;</span> </span>
<span id="cb1002-7"><a href="#cb1002-7"></a>  <span class="fu">fct_relevel</span>(<span class="fu">c</span>(<span class="st">"F-"</span>, <span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A+"</span>, <span class="st">"A++"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A  E  F  B  A+ A  C  C  D  B  A  C  C  E  F  D  A+
Levels: F- &lt; F &lt; E &lt; D &lt; C &lt; B &lt; A &lt; A+ &lt; A++</code></pre>
</div>
</div>
</section>
<section id="quali-factors-13" class="slide level2">
<h2>Quali: factors</h2>
<div class="columns">
<div class="column" style="width:55%;">
<p>This way of working with qualitative variables allows us to give a <span class="hl-yellow"><strong>theoretical definition</strong></span> of our database, and we can even count values that do not yet exist (but could), making use of <code>fct_count()</code>.</p>
</div><div class="column" style="width:45%;">
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure>
<p><img data-src="./img/fct_count.jpg" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1004"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1004-1"><a href="#cb1004-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb1004-2"><a href="#cb1004-2"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_expand</span>(marks, <span class="fu">c</span>(<span class="st">"F-"</span>, <span class="st">"A+"</span>, <span class="st">"A++"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb1004-3"><a href="#cb1004-3"></a>  <span class="fu">pull</span>(marks) <span class="sc">|&gt;</span> </span>
<span id="cb1004-4"><a href="#cb1004-4"></a>  <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  f         n
  &lt;ord&gt; &lt;int&gt;
1 F         2
2 E         2
3 D         2
4 C         4
5 B         2
6 A         3
7 A+        2
8 F-        0
9 A++       0</code></pre>
</div>
</div>
</section>
<section id="quali-factors-14" class="slide level2">
<h2>Quali: factors</h2>
<p>The levels can also be <span class="hl-yellow"><strong>sorted by frequency</strong></span> with <code>fct_infreq()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1006"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1006-1"><a href="#cb1006-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb1006-2"><a href="#cb1006-2"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_infreq</span>(marks)) <span class="sc">|&gt;</span> </span>
<span id="cb1006-3"><a href="#cb1006-3"></a>  <span class="fu">pull</span>(marks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A  E  F  B  A+ A  C  C  D  B  A  C  C  E  F  D  A+
Levels: C &lt; A &lt; F &lt; E &lt; D &lt; B &lt; A+</code></pre>
</div>
<div class="sourceCode cell-code" id="cb1008"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1008-1"><a href="#cb1008-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb1008-2"><a href="#cb1008-2"></a>  <span class="fu">mutate</span>(<span class="at">marks =</span> <span class="fu">fct_infreq</span>(marks)) <span class="sc">|&gt;</span> </span>
<span id="cb1008-3"><a href="#cb1008-3"></a>  <span class="fu">pull</span>(marks) <span class="sc">|&gt;</span> </span>
<span id="cb1008-4"><a href="#cb1008-4"></a>  <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  f         n
  &lt;ord&gt; &lt;int&gt;
1 C         4
2 A         3
3 F         2
4 E         2
5 D         2
6 B         2
7 A+        2</code></pre>
</div>
</div>
</section>
<section id="quali-factors-15" class="slide level2">
<h2>Quali: factors</h2>
<p>Sometimes we will want to <span class="hl-yellow"><strong>group levels</strong></span>, for example, not allowing levels that <span class="hl-yellow"><strong>do not happen a minimum number of times</strong></span> with <code>fct_lump_min(..., min = ..)</code> (observations that do not meet this will go to a <strong>generic level</strong> called <code>Other</code>, although this can be changed with the <code>other_level</code> argument).</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1010"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1010-1"><a href="#cb1010-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb1010-2"><a href="#cb1010-2"></a>  <span class="fu">pull</span>(marks) <span class="sc">%&gt;%</span> </span>
<span id="cb1010-3"><a href="#cb1010-3"></a>  <span class="fu">fct_lump_min</span>(<span class="at">min =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A     Other Other Other Other A     C     C     Other Other A     C    
[13] C     Other Other Other Other
Levels: C &lt; A &lt; Other</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1012"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1012-1"><a href="#cb1012-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb1012-2"><a href="#cb1012-2"></a>  <span class="fu">pull</span>(marks) <span class="sc">|&gt;</span></span>
<span id="cb1012-3"><a href="#cb1012-3"></a>  <span class="fu">fct_lump_min</span>(<span class="at">min =</span> <span class="dv">3</span>,</span>
<span id="cb1012-4"><a href="#cb1012-4"></a>               <span class="at">other_level =</span> <span class="st">"Less frequent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A             Less frequent Less frequent Less frequent Less frequent
 [6] A             C             C             Less frequent Less frequent
[11] A             C             C             Less frequent Less frequent
[16] Less frequent Less frequent
Levels: C &lt; A &lt; Less frequent</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="quali-factors-16" class="slide level2">
<h2>Quali: factors</h2>
<p>We can do something equivalent but based on its <span class="hl-yellow"><strong>relative frequency</strong></span> with <code>fct_lump_prop()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1014"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1014-1"><a href="#cb1014-1"></a>marks_database <span class="sc">|&gt;</span> </span>
<span id="cb1014-2"><a href="#cb1014-2"></a>  <span class="fu">pull</span>(marks) <span class="sc">|&gt;</span> </span>
<span id="cb1014-3"><a href="#cb1014-3"></a>  <span class="fu">fct_lump_prop</span>(<span class="at">prop =</span> <span class="fl">0.15</span>,</span>
<span id="cb1014-4"><a href="#cb1014-4"></a>                <span class="at">other_level =</span> <span class="st">"less frequent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A             less frequent less frequent less frequent less frequent
 [6] A             C             C             less frequent less frequent
[11] A             C             C             less frequent less frequent
[16] less frequent less frequent
Levels: C &lt; A &lt; less frequent</code></pre>
</div>
</div>
</section>
<section id="quali-factors-17" class="slide level2">
<h2>Quali: factors</h2>
<p>We can apply this to our datasets to <span class="hl-yellow"><strong>recategorize variables</strong></span> very quickly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1016"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1016-1"><a href="#cb1016-1"></a>starwars <span class="sc">|&gt;</span>  </span>
<span id="cb1016-2"><a href="#cb1016-2"></a>  <span class="fu">drop_na</span>(species) <span class="sc">|&gt;</span> </span>
<span id="cb1016-3"><a href="#cb1016-3"></a>  <span class="fu">mutate</span>(<span class="at">species =</span></span>
<span id="cb1016-4"><a href="#cb1016-4"></a>           <span class="fu">fct_lump_min</span>(species, <span class="at">min =</span> <span class="dv">3</span>,</span>
<span id="cb1016-5"><a href="#cb1016-5"></a>                        <span class="at">other_level =</span> <span class="st">"Others"</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb1016-6"><a href="#cb1016-6"></a>  <span class="fu">count</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  species     n
  &lt;fct&gt;   &lt;int&gt;
1 Droid       6
2 Gungan      3
3 Human      35
4 Others     39</code></pre>
</div>
</div>
</section>
<section id="quali-factors-18" class="slide level2">
<h2>Quali: factors</h2>
<p>With <code>fct_reorder()</code> we can also indicate that we want to <span class="hl-yellow"><strong>order the factors</strong></span> according to a function applied to another variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1018"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1018-1"><a href="#cb1018-1"></a>starwars_factor <span class="ot">&lt;-</span> </span>
<span id="cb1018-2"><a href="#cb1018-2"></a>  starwars <span class="sc">|&gt;</span>  </span>
<span id="cb1018-3"><a href="#cb1018-3"></a>  <span class="fu">drop_na</span>(height, species) <span class="sc">|&gt;</span> </span>
<span id="cb1018-4"><a href="#cb1018-4"></a>  <span class="fu">mutate</span>(<span class="at">species =</span></span>
<span id="cb1018-5"><a href="#cb1018-5"></a>           <span class="fu">fct_lump_min</span>(species, <span class="at">min =</span> <span class="dv">3</span>,</span>
<span id="cb1018-6"><a href="#cb1018-6"></a>                        <span class="at">other_level =</span> <span class="st">"Others"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1019"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1019-1"><a href="#cb1019-1"></a>starwars_factor <span class="sc">|&gt;</span>  <span class="fu">pull</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Human  Droid  Droid  Human  Human  Human  Human  Droid  Human  Human 
[11] Human  Human  Others Human  Others Others Human  Others Human  Human 
[21] Droid  Others Human  Human  Others Human  Others Others Human  Others
[31] Human  Human  Gungan Gungan Gungan Human  Others Others Human  Human 
[41] Others Others Others Others Others Others Others Human  Others Others
[51] Others Others Others Others Others Others Human  Others Others Others
[61] Human  Human  Human  Human  Others Others Others Others Human  Droid 
[71] Others Others Others Others Others Human  Others
Levels: Droid Gungan Human Others</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1021"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1021-1"><a href="#cb1021-1"></a>starwars_factor <span class="sc">|&gt;</span> </span>
<span id="cb1021-2"><a href="#cb1021-2"></a>  <span class="fu">mutate</span>(<span class="at">species =</span> <span class="fu">fct_reorder</span>(species, height, mean)) <span class="sc">|&gt;</span> </span>
<span id="cb1021-3"><a href="#cb1021-3"></a>  <span class="fu">pull</span>(species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Human  Droid  Droid  Human  Human  Human  Human  Droid  Human  Human 
[11] Human  Human  Others Human  Others Others Human  Others Human  Human 
[21] Droid  Others Human  Human  Others Human  Others Others Human  Others
[31] Human  Human  Gungan Gungan Gungan Human  Others Others Human  Human 
[41] Others Others Others Others Others Others Others Human  Others Others
[51] Others Others Others Others Others Others Human  Others Others Others
[61] Human  Human  Human  Human  Others Others Others Others Human  Droid 
[71] Others Others Others Others Others Human  Others
Levels: Droid Others Human Gungan</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tu-turno-8-2" class="slide level2">
<h2>💻 It’s your turn</h2>
<div class="panel-tabset">
<ul id="tabset-19" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-19-1"><span class="hl-yellow"><strong>Exercise 1</strong></span></a></li><li><a href="#tabset-19-2"><span class="hl-yellow"><strong>Exercise 2</strong></span></a></li><li><a href="#tabset-19-3"><span class="hl-yellow"><strong>Exercise 3</strong></span></a></li><li><a href="#tabset-19-4"><span class="hl-yellow"><strong>Exercise 4</strong></span></a></li><li><a href="#tabset-19-5"><span class="hl-yellow"><strong>Exercise 5</strong></span></a></li><li><a href="#tabset-19-6"><span class="hl-yellow"><strong>Exercise 6</strong></span></a></li><li><a href="#tabset-19-7"><span class="hl-yellow"><strong>Exercise 7</strong></span></a></li></ul>
<div class="tab-content">
<div id="tabset-19-1">
<p>📝 Given the variable <code>months</code> defined below (defined as a character vector), convert this variable to factor (just that)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1023"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1023-1"><a href="#cb1023-1"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1024"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1024-1"><a href="#cb1024-1"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>)</span>
<span id="cb1024-2"><a href="#cb1024-2"></a>months_fct <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(months)</span>
<span id="cb1024-3"><a href="#cb1024-3"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-19-2">
<p>📝 Given the variable <code>months</code> defined below converts this variable to a factor but indicating the levels correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1025"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1025-1"><a href="#cb1025-1"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"Apr"</span>, <span class="st">"Jan"</span>, <span class="st">"Oct"</span>, <span class="st">"Jul"</span>, <span class="st">"Jan"</span>, <span class="st">"Sep"</span>, <span class="cn">NA</span>, <span class="st">"Feb"</span>, <span class="st">"Dic"</span>,</span>
<span id="cb1025-2"><a href="#cb1025-2"></a>           <span class="st">"Jul"</span>, <span class="st">"Mar"</span>, <span class="st">"Jan"</span>, <span class="st">"Mar"</span>, <span class="st">"Feb"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Oct"</span>, <span class="st">"Sep"</span>,  <span class="cn">NA</span>,</span>
<span id="cb1025-3"><a href="#cb1025-3"></a>           <span class="st">"Dic"</span>, <span class="st">"Jul"</span>, <span class="st">"Nov"</span>, <span class="st">"Feb"</span>, <span class="st">"Oct"</span>, <span class="st">"Jun"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Oct"</span>, <span class="st">"Sep"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1026"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1026-1"><a href="#cb1026-1"></a>months_fct <span class="ot">&lt;-</span></span>
<span id="cb1026-2"><a href="#cb1026-2"></a>  <span class="fu">factor</span>(months,</span>
<span id="cb1026-3"><a href="#cb1026-3"></a>         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dic"</span>))</span>
<span id="cb1026-4"><a href="#cb1026-4"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-19-3">
<p>📝 Count how many values there are for each month but keep in mind that they are factors (maybe there are unused levels and you should get a 0 for them).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1027"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1027-1"><a href="#cb1027-1"></a>meses_fct <span class="sc">|&gt;</span>  <span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-19-4">
<p>📝 Since there are missing values, it indicates that the absentee is a thirteenth level labeled <code>"missing"</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1028"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1028-1"><a href="#cb1028-1"></a>months_fct <span class="ot">&lt;-</span> </span>
<span id="cb1028-2"><a href="#cb1028-2"></a>  months_fct <span class="sc">|&gt;</span> </span>
<span id="cb1028-3"><a href="#cb1028-3"></a>  <span class="fu">fct_explicit_na</span>(<span class="at">na_level =</span> <span class="st">"missing"</span>)</span>
<span id="cb1028-4"><a href="#cb1028-4"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-19-5">
<p>📝 Removes unused levels.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1029"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1029-1"><a href="#cb1029-1"></a>months_fct <span class="ot">&lt;-</span> </span>
<span id="cb1029-2"><a href="#cb1029-2"></a>  months_fct <span class="sc">%&gt;%</span></span>
<span id="cb1029-3"><a href="#cb1029-3"></a>  <span class="fu">fct_drop</span>()</span>
<span id="cb1029-4"><a href="#cb1029-4"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-19-6">
<p>📝 Sort the levels by frequency of occurrence.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1030"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1030-1"><a href="#cb1030-1"></a>months_fct <span class="sc">|&gt;</span> </span>
<span id="cb1030-2"><a href="#cb1030-2"></a>  <span class="fu">fct_infreq</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-19-7">
<p>📝 Group levels so that any level that does not appear at least 7% of the time is grouped in a level called <code>"other months"</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1031"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1031-1"><a href="#cb1031-1"></a>months_fct <span class="ot">&lt;-</span></span>
<span id="cb1031-2"><a href="#cb1031-2"></a>  months_fct <span class="sc">|&gt;</span> </span>
<span id="cb1031-3"><a href="#cb1031-3"></a>  <span class="fu">fct_lump_prop</span>(<span class="at">prop =</span> <span class="fl">0.07</span>, <span class="at">other_level =</span> <span class="st">"other months"</span>)</span>
<span id="cb1031-4"><a href="#cb1031-4"></a>months_fct </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="caso-practico-8-1" class="slide level2">
<h2>🐣 Case study I: CIS feminism</h2>
<p><a href="https://drive.google.com/drive/folders/18Ok6Epqcimszqguj_JTTLuSbs5Ot5Srd?usp=sharing">📊 Data</a></p>
<p>We are going to work again with file contains data from the CIS (Centro de Investigaciones Sociológicas) barometer «Perceptions on equality between men and women and gender stereotypes» whose sample work was carried out from November 6 to 14 (4000 interviews of both sexes over 16 years old in 1174 municipalities and 50 provinces).</p>
<p>&nbsp;</p>
<p>Try to answer the questions posed in the <a href="..."><strong>workbook</strong></a></p>
</section></section>
<section>
<section id="clase-9" class="title-slide slide level1 center">
<h1>L9: <span class="flow">dbplyr and github</span></h1>

</section>
<section id="dbplyr-sql-connection" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>We are going to introduce the <code>{dbplyr}</code> package, which will allow us to combine <code>SQL</code> code into <code>R</code> to perform <span class="hl-yellow"><strong>database queries</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1032"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1032-1"><a href="#cb1032-1"></a><span class="fu">install.packages</span>(<span class="st">"dbplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;</p>
<p>If you are using R to do data analysis, most of the data you need probably already lives in a database. We will learn how to <span class="hl-yellow"><strong>load data in to a local database</strong></span>.</p>
</section>
<section id="dbplyr-sql-connection-1" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1033"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1033-1"><a href="#cb1033-1"></a><span class="fu">install.packages</span>(<span class="st">"RSQLite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also need to install a <span class="hl-yellow"><strong>DBI backend package</strong></span> (an interface that allows <code>{dplyr}</code> to work with many different databases using the same code). Five commonly used backends are:</p>
<ul>
<li><p><code>RMariaDB</code> connects to MySQL and MariaDB</p></li>
<li><p><code>RPostgres</code> connects to Postgres and Redshift.</p></li>
<li><p><code>RSQLite</code> embeds a SQLite database.</p></li>
<li><p><code>odbc</code> connects to many commercial databases via the open database connectivity protocol.</p></li>
<li><p><code>bigrquery</code> connects to Google’s BigQuery.</p></li>
</ul>
<div class="fragment">
<p>In the following, we are going to use the <span class="hl-yellow"><strong>RSQLite backend</strong></span> (automatically installed when you install <code>{dbplyr}</code>).</p>
</div>
</section>
<section id="dbplyr-sql-connection-2" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>If we want to <span class="hl-yellow"><strong>work with a database adopting dplyr grammar</strong></span>, we must first connect to it. The connection will be done by using <code>DBI::dbConnect()</code>. The arguments to <code>DBI::dbConnect()</code> vary from database to database, but the first argument is always the database backend. SQLite only needs a path to the database.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1034"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1034-1"><a href="#cb1034-1"></a>connection <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="at">dbname =</span> <span class="st">":memory:"</span>)</span>
<span id="cb1034-2"><a href="#cb1034-2"></a>connection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQLiteConnection&gt;
  Path: :memory:
  Extensions: TRUE</code></pre>
</div>
</div>
<p>Here, the string <code>":memory:"</code> is a special path that creates <span class="hl-yellow"><strong>a temporary in-memory database</strong></span>.</p>
</section>
<section id="dbplyr-sql-connection-3" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>The temporary database previously created has no yet data in it. We will <span class="hl-yellow"><strong>copy an existing database</strong></span> (for example, <code>gapminder</code> from <code>{gapminder}</code> package) using <code>copy_to()</code>. Using <code>tbl()</code> we “obtain” the database (called as named in <code>copy_to()</code>).</p>
<p>The main difference is that not it is a <span class="hl-yellow"><strong>remote source in a SQLite database</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1036"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1036-1"><a href="#cb1036-1"></a><span class="fu">copy_to</span>(connection, gapminder<span class="sc">::</span>gapminder, <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">name =</span> <span class="st">"gapminder_database"</span>)</span>
<span id="cb1036-2"><a href="#cb1036-2"></a>gapminder_db <span class="ot">&lt;-</span> <span class="fu">tbl</span>(connection, <span class="st">"gapminder_database"</span>)</span>
<span id="cb1036-3"><a href="#cb1036-3"></a>gapminder_db</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   table&lt;`gapminder_database`&gt; [?? x 6]
# Database: sqlite 3.43.2 [:memory:]
   country     continent  year lifeExp      pop gdpPercap
   &lt;chr&gt;       &lt;chr&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ more rows</code></pre>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-4" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>The main goal of <code>{dbplyr}</code> is to <span class="hl-yellow"><strong>automatically generate SQL from <code>dplyr</code> grammar</strong></span> that we are already familiar with.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1038"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1038-1"><a href="#cb1038-1"></a>gapminder_db <span class="sc">|&gt;</span></span>
<span id="cb1038-2"><a href="#cb1038-2"></a>  <span class="fu">select</span>(country, year, lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 3]
# Database: sqlite 3.43.2 [:memory:]
   country      year lifeExp
   &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt;
 1 Afghanistan  1952    28.8
 2 Afghanistan  1957    30.3
 3 Afghanistan  1962    32.0
 4 Afghanistan  1967    34.0
 5 Afghanistan  1972    36.1
 6 Afghanistan  1977    38.4
 7 Afghanistan  1982    39.9
 8 Afghanistan  1987    40.8
 9 Afghanistan  1992    41.7
10 Afghanistan  1997    41.8
# ℹ more rows</code></pre>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-5" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>The most important difference between ordinary tibbles and remote database queries is that now <span class="hl-yellow"><strong>our <code>R</code> code is translated into SQL and executed in the database on the remote server</strong></span>, not in R on your local machine: it never pulls data into R unless you explicitly ask for it, <span class="hl-purple"><strong>delaying doing any work until the last possible moment</strong></span> (sends it to the database in one step).</p>
<div class="fragment">
<p>It is not <span class="hl-yellow"><strong>until we ask for the data</strong></span> (writing <code>gapminder_query</code> in console, for example), <code>dplyr</code> verbs generates the SQL and requests the results from the database.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1040"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1040-1"><a href="#cb1040-1"></a>gapminder_query <span class="ot">&lt;-</span> </span>
<span id="cb1040-2"><a href="#cb1040-2"></a>  gapminder_db <span class="sc">|&gt;</span></span>
<span id="cb1040-3"><a href="#cb1040-3"></a>  <span class="fu">select</span>(country, year, lifeExp)</span>
<span id="cb1040-4"><a href="#cb1040-4"></a>gapminder_query</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:   SQL [?? x 3]
# Database: sqlite 3.43.2 [:memory:]
   country      year lifeExp
   &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt;
 1 Afghanistan  1952    28.8
 2 Afghanistan  1957    30.3
 3 Afghanistan  1962    32.0
 4 Afghanistan  1967    34.0
 5 Afghanistan  1972    36.1
 6 Afghanistan  1977    38.4
 7 Afghanistan  1982    39.9
 8 Afghanistan  1987    40.8
 9 Afghanistan  1992    41.7
10 Afghanistan  1997    41.8
# ℹ more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-6" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p><strong>What is happening behind the scenes?</strong></p>
<div class="fragment">
<p><code>{dplyr}</code> is <span class="hl-yellow"><strong>translating our R code into SQL verbs</strong></span>, that we can check (without doing) by using <code>show_query()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1042"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1042-1"><a href="#cb1042-1"></a>gapminder_query <span class="sc">|&gt;</span> </span>
<span id="cb1042-2"><a href="#cb1042-2"></a>  <span class="fu">show_query</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt;
SELECT `country`, `year`, `lifeExp`
FROM `gapminder_database`</code></pre>
</div>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-7" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>As commented, our remote database queries is not in R on your local machine: it never pulls data into R unless you explicitly ask for it. To do it, you can iterate a few times before you figure out what data you need, and then we use <code>collect()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1044"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1044-1"><a href="#cb1044-1"></a>gapminder_tibble <span class="ot">&lt;-</span></span>
<span id="cb1044-2"><a href="#cb1044-2"></a>  gapminder_query <span class="sc">|&gt;</span> </span>
<span id="cb1044-3"><a href="#cb1044-3"></a>  <span class="fu">collect</span>()</span>
<span id="cb1044-4"><a href="#cb1044-4"></a>gapminder_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 3
   country      year lifeExp
   &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt;
 1 Afghanistan  1952    28.8
 2 Afghanistan  1957    30.3
 3 Afghanistan  1962    32.0
 4 Afghanistan  1967    34.0
 5 Afghanistan  1972    36.1
 6 Afghanistan  1977    38.4
 7 Afghanistan  1982    39.9
 8 Afghanistan  1987    40.8
 9 Afghanistan  1992    41.7
10 Afghanistan  1997    41.8
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="dbplyr-sql-connection-8" class="slide level2">
<h2>dbplyr: SQL connection</h2>
<p>You can also use <code>translate_sql()</code> to translate individual expressions from <code>dplyr</code> to SQL</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1046"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1046-1"><a href="#cb1046-1"></a>dbplyr<span class="sc">::</span><span class="fu">translate_sql</span>((x <span class="sc">+</span> y) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">con =</span> connection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt; (`x` + `y`) / 2.0</code></pre>
</div>
</div>
</section>
<section id="what-about-github" class="slide level2">
<h2>What about Github?</h2>
<p><span class="hl-yellow"><strong>GitHub</strong></span> is the most well-known collaborative platform based on the <span class="hl-yellow"><strong>Git version control system</strong></span></p>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>What is Git?</strong></span> Git is a <span class="hl-yellow"><strong>version control</strong></span> system: a kind of <span class="hl-yellow"><strong>Dropbox</strong></span> to facilitate <span class="hl-yellow"><strong>collaborative programming</strong></span> among a group of people, allowing to keep track of the <span class="hl-yellow"><strong>traceability of changes</strong></span> made.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>What is Github?</strong></span> Our <span class="hl-yellow"><strong>platform/interface</strong></span> for running version control: it will serve us not only to work collaboratively but to <span class="hl-yellow"><strong>make transparent</strong></span> the process of building our code projects.</li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>As of June 4, 2018 Github is owned by Microsoft (ergo the code you upload as well).</p>
</div>
</div>
</div>
</div>
</section>
<section id="overview" class="slide level2">
<h2>Overview</h2>
<p>After making an account in Github, <span class="hl-purple"><strong>up right</strong></span> we will have a circle, and clicking on <span class="hl-purple"><strong>Your Profile</strong></span>, we will see something like this</p>
<div class="columns">
<div class="column" style="width:55%;">
<p><img data-src="img/github_1.png"></p>
</div><div class="column" style="width:45%;">
<ul>
<li><p><span class="hl-purple"><strong>Edit profile</strong></span>: allows us to add a <span class="hl-yellow"><strong>description and profile picture</strong></span>.</p></li>
<li><p><span class="hl-purple"><strong>Overview</strong></span>: in that squares panel will <span class="hl-yellow"><strong>view our activity</strong></span> over time.</p></li>
<li><p><span class="hl-purple"><strong>Repositories</strong></span>: the code will be uploaded to <span class="hl-yellow"><strong>repositories</strong></span>, the equivalent of our shared folders in Dropbox.</p></li>
</ul>
</div>
</div>
</section>
<section id="first-use" class="slide level2">
<h2>First use</h2>
<p>Before learning how to create repositories, Github will also be useful to</p>
<ul>
<li><p><span class="hl-purple"><strong>Access code</strong></span> from others</p></li>
<li><p><span class="hl-purple"><strong>Propose improvements</strong></span> to other users, and even propose <span class="hl-yellow"><strong>bug fixes we detect</strong></span> for software we use.</p></li>
</ul>
<div class="fragment">
<ul>
<li><strong>Install R packages</strong>]{.hl-purple}. In many cases package developers upload updates to CRAN from time to time, and in other cases the software is not “wide” enough to be uploaded as a package.</li>
</ul>
<p>Package code that is not uploaded to CRAN can be <span class="hl-yellow"><strong>installed as code from Github</strong></span></p>
</div>
</section>
<section id="installing-from-github" class="slide level2">
<h2>Installing from Github</h2>
<p>For example, let’s install a package called <a href="https://github.com/jbgb13/peRReo"><code>{peRReo}</code></a>, whose only function is to give us <span class="hl-yellow"><strong>color palettes</strong></span> based on <span class="hl-yellow"><strong>urban music albums</strong></span> covers.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/perrreo.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rosalia.png" width="360"></p>
</div>
</div>
<div class="fragment">
<p>To do this we first need to install a <span class="hl-yellow"><strong>developer package set</strong></span> called <code>{devtools}</code>, which will allow us to install from Github</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1048"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1048-1"><a href="#cb1048-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="installing-from-github-1" class="slide level2">
<h2>Installing from Github</h2>
<p>The <span class="hl-yellow"><strong>installation instructions</strong></span> are usually detailed in the repository cover page (<code>README.md</code> file)</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/install_perreo.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rosalia.png" width="310"></p>
</div>
</div>
<div class="fragment">
<p>In most cases the <code>install_github()</code> function (from the package we just installed) will suffice, passing it the <span class="hl-yellow"><strong>repository path</strong></span> (without “github.com/”) as an argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1049"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1049-1"><a href="#cb1049-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"jbgb13/peRReo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="installing-from-github-2" class="slide level2">
<h2>Installing from Github</h2>
<p>Most of the time what we upload will not be an R package as such but <span class="hl-yellow"><strong>we will upload a more or less organized</strong></span> and commented code. In that case we can <span class="hl-yellow"><strong>download the whole repo</strong></span> by clicking <span class="hl-green"><strong>Code</strong></span> and then Download ZIP.</p>
<p>For example, let’s download the dataviz scripts that have been uploaded from the <a href="https://github.com/ceopinio/bop-grafics">Centre d’Estudis d’Opinió</a> (Catalan CIS).</p>

<img data-src="img/ceo_github.png" class="r-stretch"></section>
<section id="first-repo" class="slide level2">
<h2>First repo</h2>
<p>Let’s <span class="hl-yellow"><strong>create our first repository</strong></span> that will also serve as the <span class="hl-yellow"><strong>cover page</strong></span> of our Github profile.</p>
<ol type="1">
<li><p><span class="hl-purple"><strong>Repositories</strong></span>: click on the Repositories tab.</p></li>
<li><p><span class="hl-purple"><strong>New</strong></span>: click on the <span class="hl-green"><strong>New</strong></span> button to create a new repository.</p></li>
</ol>

<img data-src="img/new_repo.png" class="r-stretch"></section>
<section id="first-repo-1" class="slide level2">
<h2>First repo</h2>
<ul>
<li><p><span class="hl-purple"><strong>Repository name</strong></span>: the <span class="hl-yellow"><strong>repository name</strong></span>. In this case we are going to create a very specific repository: the name must <span class="hl-yellow"><strong>exactly match your username</strong></span></p></li>
<li><p><span class="hl-purple"><strong>Description</strong></span>: description of your repository. In this case it will be a presentation repo. <img data-src="img/repo_init_1.png"></p></li>
</ul>
</section>
<section id="first-repo-2" class="slide level2">
<h2>First repo</h2>
<ul>
<li><p><span class="hl-purple"><strong>Public vs private</strong></span>: with each repository we will have the option to make the repository</p>
<ul>
<li><span class="hl-purple"><strong>public</strong></span>: all users will be able to see the code as well as the traceability of your development (what is added and when). It is for me the most recommended option when you want to give <span class="hl-yellow"><strong>visibility and transparency</strong></span> to your work</li>
<li><span class="hl-purple"><strong>private</strong></span>: only those users you allow will have access to the repository. Nothing can be viewed or installed from it outside of Github.</li>
</ul></li>
</ul>

<img data-src="img/repo_init_2.png" class="r-stretch"><p>In this particular case, since it will be a presentation repository, we will <span class="hl-yellow"><strong>make it public</strong></span>.</p>
</section>
<section id="first-repo-3" class="slide level2">
<h2>First repo</h2>
<ul>
<li><strong>Add a README file</strong>]{.hl-purple}: a README file will be the file where we will include the <span class="hl-yellow"><strong>instructions and usage details</strong></span> to the others (in the case of <code>{peRReo}</code> it was the file containing the installation details).</li>
</ul>

<img data-src="img/repo_init_3.png" class="r-stretch"><p>For the time being <span class="hl-net"><strong>ignore other fields</strong></span> for this first repository.</p>
</section>
<section id="first-repo-4" class="slide level2">
<h2>First repo</h2>

<img data-src="img/repo_init_1.png" class="r-stretch"><p>By default Github assumes that this repository, with the <span class="hl-yellow"><strong>same name as our user</strong></span> will be the repository we want to be presented at startup when someone logs into our profile, and will be the repository where <span class="hl-yellow"><strong>include in the README.md</strong></span> a presentation of us and an index of your work (if you want).</p>
</section>
<section id="first-repo-5" class="slide level2">
<h2>First repo</h2>

<img data-src="img/profile_github_md.png" class="r-stretch"><p>Notice that now in our <span class="hl-yellow"><strong>cover page we have said README.md</strong></span> that we can customize to our liking using <span class="hl-yellow"><strong>html and markdown</strong></span>.Here you can see <a href="https://github.com/matiassingers/awesome-readme"><strong>some examples of README.md</strong></a></p>
</section>
<section id="code-repo" class="slide level2">
<h2>Code repo</h2>
<p>Once we have our presentation README (remember you can <span class="hl-yellow"><strong>customize to your liking with html and markdown</strong></span>) let’s create a <span class="hl-yellow"><strong>code repository</strong></span>.</p>
<div class="fragment">
<p>If it was already important to <span class="hl-yellow"><strong>work with projects</strong></span> in <code>RStudio</code>, when combined with Github it is even more crucial that we create a project before uploading code, so let’s create a test one called <code>repo-github-1</code>.</p>
</div>
<div class="fragment">
<p>In this project we are going to <span class="hl-yellow"><strong>create a script</strong></span> (in my case called <strong>codigo.R</strong>) in which you must do the following steps:</p>
</div>
</section>
<section id="code-repo-1" class="slide level2">
<h2>Code repo</h2>
<ol type="1">
<li><span class="hl-yellow"><strong>Download</strong></span> directly from the <a href="https://cnecovid.isciii.es/covid19/resources">ISCIII</a> page the file named <code>casos_hosp_hosp_uci_def_def_sexo_edad_provres.csv</code>.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1050"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1050-1"><a href="#cb1050-1"></a>datos_covid <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://cnecovid.isciii.es/covid19/resources/casos_hosp_uci_def_sexo_edad_provres.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><span class="hl-yellow"><strong>Filter</strong></span> data for Madrid (<code>“M”</code>), between March 1, 2020 and December 31, 2020, and with sex <code>“H”</code>. After that keep the columns <code>fecha</code>, <code>grupo_edad</code>, <code>num_casos</code> (that order). Finally get the sum of daily cases per date (regardless of age group).</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1051"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1051-1"><a href="#cb1051-1"></a><span class="co"># Depuración</span></span>
<span id="cb1051-2"><a href="#cb1051-2"></a>datos_madrid <span class="ot">&lt;-</span></span>
<span id="cb1051-3"><a href="#cb1051-3"></a>  datos_covid <span class="sc">|&gt;</span></span>
<span id="cb1051-4"><a href="#cb1051-4"></a>  <span class="co"># Filtrado por Madrid y fecha</span></span>
<span id="cb1051-5"><a href="#cb1051-5"></a>  <span class="fu">filter</span>(provincia_iso <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span></span>
<span id="cb1051-6"><a href="#cb1051-6"></a>           <span class="fu">between</span>(fecha, <span class="fu">as_date</span>(<span class="st">"2020-03-01"</span>), <span class="fu">as_date</span>(<span class="st">"2020-12-31"</span>)) <span class="sc">&amp;</span></span>
<span id="cb1051-7"><a href="#cb1051-7"></a>           sexo <span class="sc">==</span> <span class="st">"H"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1051-8"><a href="#cb1051-8"></a>  <span class="fu">select</span>(fecha, grupo_edad, num_casos) <span class="sc">|&gt;</span> </span>
<span id="cb1051-9"><a href="#cb1051-9"></a>  <span class="fu">summarise</span>(<span class="at">num_casos =</span> <span class="fu">sum</span>(num_casos), <span class="at">.by =</span> <span class="fu">c</span>(fecha))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="code-repo-2" class="slide level2">
<h2>Code repo</h2>
<ol start="3" type="1">
<li><span class="hl-yellow"><strong>Export the dataset to a csv</strong></span> in a folder named <code>exported</code>.</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1052"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1052-1"><a href="#cb1052-1"></a><span class="co"># Exportamos datos</span></span>
<span id="cb1052-2"><a href="#cb1052-2"></a><span class="fu">write_csv</span>(datos_madrid, <span class="at">file =</span> <span class="st">"./exportado/datos_madrid.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:40%;">
<ol start="4" type="1">
<li>Create a <span class="hl-yellow"><strong>line graph</strong></span> that has on the x-axis date, on the y-axis cases, with one curve per sex (separate graphs).</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1053"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1053-1"><a href="#cb1053-1"></a><span class="co"># Gráfica</span></span>
<span id="cb1053-2"><a href="#cb1053-2"></a>grafica <span class="ot">&lt;-</span></span>
<span id="cb1053-3"><a href="#cb1053-3"></a>  <span class="fu">ggplot</span>(datos_madrid) <span class="sc">+</span></span>
<span id="cb1053-4"><a href="#cb1053-4"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> fecha, <span class="at">y =</span> num_casos),</span>
<span id="cb1053-5"><a href="#cb1053-5"></a>            <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>)  <span class="sc">+</span></span>
<span id="cb1053-6"><a href="#cb1053-6"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1053-7"><a href="#cb1053-7"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-651-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<ol start="5" type="1">
<li>After that <span class="hl-yellow"><strong>export the graph</strong></span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1054"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1054-1"><a href="#cb1054-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"./exportado/ggplot.png"</span>, <span class="at">plot =</span> grafica,</span>
<span id="cb1054-2"><a href="#cb1054-2"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb1054-3"><a href="#cb1054-3"></a></span>
<span id="cb1054-4"><a href="#cb1054-4"></a><span class="co"># otra opción</span></span>
<span id="cb1054-5"><a href="#cb1054-5"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"./exportado/ggplot.png"</span>, <span class="at">plot =</span> <span class="fu">last_plot</span>(),</span>
<span id="cb1054-6"><a href="#cb1054-6"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="code-repo-3" class="slide level2">
<h2>Code repo</h2>
<p>How do we <span class="hl-yellow"><strong>upload the project</strong></span>? Let’s go back to <span class="hl-yellow"><strong>create a project from scratch</strong></span>. We didn’t talk about two important fields earlier:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/repo-1.png" width="460"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Add .gitignore` will allow us to <span class="hl-yellow"><strong>select the language</strong></span> our project will be in so that Github understands it when syncing (and doesn’t update things it shouldn’t).</p></li>
<li><p><code>Choose a license</code> will allow us to <span class="hl-yellow"><strong>select the license</strong></span> which will determine the conditions under which others will be able to reuse your code.</p></li>
</ul>
</div>
</div>
</section>
<section id="code-repo-4" class="slide level2">
<h2>Code repo</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/repo-1-1.png"></p>
</div><div class="column" style="width:50%;">
<p>If you look at how to create it we have only 3 files: the license file, the .gitignore and the readme.md (where we should write a user guide of what we have uploaded).</p>
</div>
</div>
<p>To upload the files we will click on <span class="hl-purple"><strong>Add file &lt; Upload File</strong></span> and <span class="hl-yellow"><strong>drag ALL files</strong></span> from our project folder.</p>
</section>
<section id="code-repo-5" class="slide level2">
<h2>Code repo</h2>
<p>After uploading files we will have a box called <span class="hl-purple"><strong>Commit changes</strong></span></p>

<img data-src="./img/commit-1.png" class="r-stretch"><p>A <span class="hl-purple"><strong>commit</strong></span> is a <span class="hl-yellow"><strong>modification of the repository</strong></span> with something to be added/removed/modified, and it is advisable to use this box to <span class="hl-yellow"><strong>summarize what the modification</strong></span> is about, so that the change is traced.</p>
</section>
<section id="code-repo-6" class="slide level2">
<h2>Code repo</h2>
<p>By clicking on the clock where it indicates the <span class="hl-yellow"><strong>number of commits</strong></span> we access the <span class="hl-yellow"><strong>history of commits (changes)</strong></span> with time, day, author, comments, etc.</p>

<img data-src="./img/commit-reloj.png" class="r-stretch"></section>
<section id="code-repo-7" class="slide level2">
<h2>Code repo</h2>
<p>Let’s make a <span class="hl-yellow"><strong>change in our code</strong></span>: in your local code (local –&gt; your computer), instead of filtering by Madrid do the <span class="hl-yellow"><strong>filter by Barcelona</strong></span>, save the code and upload the new file in the repository (with the same name, Github will do the overwrite)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1055" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1055-1"><a href="#cb1055-1"></a>datos_bcn <span class="ot">&lt;-</span></span>
<span id="cb1055-2"><a href="#cb1055-2"></a>  datos_covid <span class="sc">|&gt;</span></span>
<span id="cb1055-3"><a href="#cb1055-3"></a>  <span class="fu">filter</span>(provincia_iso <span class="sc">==</span> <span class="st">"B"</span>  <span class="sc">&amp;</span></span>
<span id="cb1055-4"><a href="#cb1055-4"></a>           <span class="fu">between</span>(fecha, <span class="fu">as_date</span>(<span class="st">"2020-03-01"</span>), <span class="fu">as_date</span>(<span class="st">"2020-12-31"</span>)) <span class="sc">&amp;</span></span>
<span id="cb1055-5"><a href="#cb1055-5"></a>           sexo <span class="sc">==</span> <span class="st">"H"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1055-6"><a href="#cb1055-6"></a>  <span class="fu">select</span>(fecha, sexo, grupo_edad, num_casos) <span class="sc">|&gt;</span> </span>
<span id="cb1055-7"><a href="#cb1055-7"></a>  <span class="fu">summarise</span>(<span class="at">num_casos =</span> <span class="fu">sum</span>(num_casos), <span class="at">.by =</span> <span class="fu">c</span>(fecha, sexo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="commits" class="slide level2">
<h2>Commits</h2>
<p><img data-src="./img/barcelona_covid.png" width="550"></p>
<div class="columns">
<div class="column" style="width:40%;">
<p>If we now <span class="hl-yellow"><strong>consult the commit</strong></span>, next to it there is a number that identifies it, and clicking on it summarizes the changes: not only <span class="hl-yellow"><strong>stores all past versions</strong></span> but also <span class="hl-yellow"><strong>shows the differences between the changed files</strong></span></p>
</div><div class="column" style="width:60%;">
<p><img data-src="./img/commit_cambio.png"></p>
</div>
</div>
</section>
<section id="change-traceability" class="slide level2">
<h2>Change traceability</h2>
<div class="columns">
<div class="column" style="width:72%;">
<p><img data-src="./img/commit_split.png"> <img data-src="./img/commit_unified.png"></p>
</div><div class="column" style="width:28%;">
<p>We have <span class="hl-yellow"><strong>two display modes</strong></span> of the changes: the split mode shows us the old and the new, with the inclusions in green and what is no longer there in red; and the unified mode shows us everything in the same document.</p>
</div>
</div>
</section>
<section id="retrieval-of-commits" class="slide level2">
<h2>Retrieval of commits</h2>

<img data-src="./img/browse-repo.png" class="r-stretch"><p>Github even allows us to <span class="hl-yellow"><strong>retrieve a past version</strong></span> from our repository by clicking on the third commit icon.</p>
</section>
<section id="retrieval-of-commits-1" class="slide level2">
<h2>Retrieval of commits</h2>

<img data-src="./img/branch-commit.png" class="r-stretch"><p>If you notice now next to <code>1 branch</code> we have a <span class="hl-yellow"><strong>drop-down menu</strong></span> where before it used to say <code>main</code> and now a commit identifier number. We will talk about the idea of <span class="hl-yellow"><strong>branch (branch)</strong></span> later.</p>
</section>
<section id="repo-with-rmdqmd" class="slide level2">
<h2>Repo with rmd/qmd</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Let’s put what we have learned into practice:</p>
<ol type="1">
<li><p>Create a new repository in Github (called <code>repo-github-2</code>) where you will have hosted your R project.</p></li>
<li><p>Create a project in <code>RStudio</code> called (for example) <code>project-qmd</code></p></li>
<li><p>Once inside the project in <code>RStudio</code> click on <code>File &lt; New File &lt; Quarto Document</code>.</p></li>
</ol>
</div><div class="column" style="width:40%;">
<p><img data-src="./img/primer-qmd.png"></p>
</div>
</div>
<p>You should have a document similar to this: a <span class="hl-yellow"><strong>fourth markdown (.qmd)</strong></span>, a document that will allow us to include <span class="hl-yellow"><strong>markdown + code</strong></span> (it can be <code>R</code> or it can be <code>Observable</code>, <code>D3</code>, etc).</p>
</section>
<section id="repo-with-rmdqmd-1" class="slide level2">
<h2>Repo with rmd/qmd</h2>
<p>This format is ideal for:</p>
<ul>
<li><p><span class="hl-yellow"><strong>Working in a team</strong></span> building a draft of a piece.</p></li>
<li><p>Taking <span class="hl-yellow"><strong>notes or reports</strong></span> for yourself.</p></li>
<li><p><span class="hl-yellow"><strong>Presenting</strong></span> your work to your peers.</p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/prueba-qmd-html.png"></p>
</div><div class="column" style="width:50%;">
<p>If you notice now our repository has a file with <code>.html</code> format…that is to say….</p>
<p><span class="hl-yellow"><strong>It’s a web!</strong></span></p>
</div>
</div>
</section>
<section id="github-pages" class="slide level2">
<h2>Github pages</h2>
<p>How to <span class="hl-yellow"><strong>convert our repository properly into a web</strong></span>?</p>

<img data-src="./img/github-pages.png" class="r-stretch"><ol type="1">
<li><p>Click on <code>Settings</code></p></li>
<li><p>Go to <code>Pages</code></p></li>
<li><p>In the subsection <code>branch</code> select the only branch that we have now (<code>main</code>)</p></li>
<li><p>Select the folder where you have the <code>.html</code> (in complex web it will be as in any web in <code>docs</code>, in something simple it will be in the root path of the repository)</p></li>
<li><p>Click on <code>Save</code>.</p></li>
</ol>
</section>
<section id="github-pages-1" class="slide level2">
<h2>Github pages</h2>
<p>If you look at the <span class="hl-yellow"><strong>top of the repository</strong></span> now we have an orange icon, which indicates that the <span class="hl-orange"><strong>web is in the process of being deployed</strong></span></p>

<img data-src="./img/github-naranja.png" class="r-stretch"></section>
<section id="github-pages-2" class="slide level2">
<h2>Github pages</h2>
<p>After a few seconds (depending on the size of the website and your internet connection) that <span class="hl-green"><strong>icon will change to a green check</strong></span></p>

<img data-src="./img/github-verde.png" class="r-stretch"><p>The <span class="hl-yellow"><strong>default web link</strong></span> will be <code>{username}.github.io/{repo_name}</code>.</p>
</section>
<section id="github-pages-3" class="slide level2">
<h2>Github pages</h2>

<img data-src="./img/github-pages-deploy.png" class="r-stretch"><p>Wait a minute! Right now our website <span class="hl-red"><strong>is not showing us our .qmd</strong></span>, but by default the <span class="hl-yellow"><strong>README.md</strong></span>.</p>
<div class="fragment">
<p>For Github to understand that we want to display that <code>.html</code> that we have generated from the <code>.qmd</code> we go in our local project to <span class="hl-yellow"><strong>delete</strong></span> everything that is not our <code>.Rproj</code> file and our <code>.qmd</code> file, and we go to <span class="hl-yellow"><strong>name</strong></span> the latter calling it <code>index.qmd</code>, and we recompile it to <span class="hl-yellow"><strong>generate an index.html</strong></span></p>
</div>
</section>
<section id="github-pages-4" class="slide level2">
<h2>Github pages</h2>
<p>Let’s <span class="hl-yellow"><strong>upload to Github that new project</strong></span> with the name change (called <code>repo-github-3</code>) to see later the differences between one and the other one.</p>

<img data-src="./img/repo-index-html.png" class="r-stretch"></section>
<section id="github-pages-5" class="slide level2">
<h2>Github pages</h2>
<p>If we <span class="hl-yellow"><strong>repeat the process to make a Page</strong></span> and wait for the green tick…</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/index-html-qmd.png"></p>
</div><div class="column" style="width:50%;">
<p>If your <code>.qmd</code> is already called <code>index.qmd</code>, automatically, when Github detects an <code>index.html</code>, it interprets that <span class="hl-yellow"><strong>index.html file</strong></span> is the one that defines the web (and you can customize by adding a <code>css</code> style file)</p>
<p><span class="hl-green"><strong>We have a web</strong></span> by simply clicking on Pages :)</p>
</div>
</div>
</section>
<section id="repo-with-slides" class="slide level2">
<h2>Repo with slides</h2>
<p>Let’s create the last repository which will be called <code>repo-diapos</code>, and create a project in <code>RStudio</code> of the same name (for example). Once created we will click on <code>File &lt; New File &lt; Quarto Presentation</code>.</p>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/quarto-slides.png"></p>
</div><div class="column" style="width:55%;">
<p>The way to write will be the same as a normal <code>.qmd</code> only now <span class="hl-yellow"><strong>each slide will be separated</strong></span> with a <code>---</code> (using style files we can customize whatever we want)</p>
<p>Call the file directly <code>index.qmd</code>, upload it to Github and with one click in Pages you have a <span class="hl-yellow"><strong>web with your slides</strong></span></p>
</div>
</div>
</section>
<section id="github-desktop" class="slide level2">
<h2>Github Desktop</h2>
<p>pending</p>
</section>
<section class="slide level2">

<div class="footer footer-default">
<p><a href="..."><strong>Javier Álvarez Liébana</strong></a> • Master in Computational Social Sciences (UC3M)</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"normal"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>